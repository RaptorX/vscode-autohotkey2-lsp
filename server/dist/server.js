(()=>{"use strict";var e={6169:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checksamenameerr=t.samenameerr=t.formatMarkdowndetail=t.getincludetable=t.getFuncCallInfo=t.searchNode=t.detectExp=t.detectVariableType=t.detectExpType=t.cleardetectcache=t.getClassMembers=t.parseinclude=t.pathanalyze=t.Lexer=t.allIdentifierChar=t.isIdentifierChar=t.ReferenceInfomation=t.Word=t.FuncNode=t.SymbolNode=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.FuncScope=void 0;const i=n(7147),o=n(1017),r=n(7282),a=n(2374),s=n(6288),c=n(6630),l=n(4780),d=n(7994),u=n(3939);var f,h,p,m,g,y;function b(e){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>127))}!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.GLOBAL=1]="GLOBAL"}(f=t.FuncScope||(t.FuncScope={})),function(e){e[e.class=0]="class",e[e.function=1]="function",e[e.method=2]="method",e[e.parameter=3]="parameter",e[e.variable=4]="variable",e[e.property=5]="property",e[e.keyword=6]="keyword",e[e.string=7]="string",e[e.number=8]="number",e[e.event=9]="event",e[e.modifier=10]="modifier"}(h=t.SemanticTokenTypes||(t.SemanticTokenTypes={})),function(e){e[e.definition=0]="definition",e[e.readonly=1]="readonly",e[e.static=2]="static",e[e.deprecated=3]="deprecated",e[e.modification=4]="modification",e[e.documentation=5]="documentation",e[e.defaultLibrary=6]="defaultLibrary"}(p=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})),function(e){e.create=function(e,t,n,i,o){return{name:e,kind:t,range:n,selectionRange:i,children:o}}}(m=t.SymbolNode||(t.SymbolNode={})),function(e){e.create=function(e,t,n,i,o,r,a){let s="",c=[],l=!1;return o.map((e=>{"*"!==e.name&&c.push(e),s+=", "+(e.ref?(l=!0,"&"):"")+e.name+(e.defaultVal?" := "+e.defaultVal:e.arr?"*":"")})),s=(a?"static ":"")+e+"("+s.substring(2)+")",o=c,{assume:f.DEFAULT,hasref:l,name:e,kind:t,range:n,selectionRange:i,params:o,full:s,children:r,funccall:[],declaration:{},global:{},local:{},labels:{}}}}(g=t.FuncNode||(t.FuncNode={})),(t.Word||(t.Word={})).create=function(e,t){return{name:e,range:t}},function(e){e.create=function(e,t,n,i){return{name:e,kind:t,range:n,selectionRange:i}}}(y||(y={})),(t.ReferenceInfomation||(t.ReferenceInfomation={})).create=function(e,t){return{name:e,line:t}},t.isIdentifierChar=b,t.allIdentifierChar=new RegExp("^[^\0-/:-@[\\]^`{-]+$");const _=new RegExp(/(?<=['"\s])(c|background|#)?((0x)?[\da-f]{6}([\da-f]{2})?|(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua))\b/i),v=JSON.parse('{ "black": "000000", "silver": "c0c0c0", "gray": "808080", "white": "ffffff", "maroon": "800000", "red": "ff0000", "purple": "800080", "fuchsia": "ff00ff", "green": "008000", "lime": "00ff00", "olive": "808000", "yellow": "ffff00", "navy": "000080", "blue": "0000ff", "teal": "008080", "aqua": "00ffff" }'),T="\n\r\t ".split(""),R=("0123456789".split(""),"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split(""),"+ - * / % & ++ -- ** // = += -= *= /= //= .= == := != !== ~= > < >= <= >>> >> << >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: =>".split(" ")),k="try,throw,return,global,local,static,if,switch,case,for,while,loop,continue,break,goto".split(","),S=k.concat(["class","in","is","isset","contains","else","until","catch","finally","and","or","not","as","unset","super"]);let C={},w={};class x{constructor(e){let n,o,r,s,_,v,C,w,x,O,D,K,P,A,L,N,q;this.actived=!1,this.children=[],this.d=0,this.declaration={},this.diagnostics=[],this.diags=0,this.foldingranges=[],this.funccall=[],this.include={},this.includedir=new Map,this.dlldir=new Map,this.dllpaths=[],this.labels={},this.libdirs=[],this.object={method:{},property:{},userdef:{}},this.reflat=!1,this.isparsed=!1,this.scriptdir="",this.tokens={},this.STB=new a.SemanticTokensBuilder,this.strcommpos=[],this.texts={},this.version=0;let F,j,W,$,U,V,B,H,z,G,Y,X,Q,J,Z,ee,te,ne,ie,oe,re=this,ae=u.isahk2_h,se=[],ce=!1,le=!1;function de(e=0,i=new Map,o=""){const r=[],s=re.document,c={content:"",offset:0,type:"",length:0};let u,_,v=i.get("#parent")||re,R={content:"",type:"",offset:0,length:0},S=R,C=!0,w=0,x=!1,E="",O=0,D=-1,K=-1,P=[],A="",L="",N=[];return 0!==e&&P.push(F-1),I(),"TK_EOF"===R.type&&O>(0===e?0:-1)&&re.addDiagnostic(d.diagnostic.missing("}"),P[O-(0===e?1:0)],1),r;function I(t=0){var i,l,f;let b=D;for("TK_START_BLOCK"===R.type&&(ne(),C=!1,R.topofline||R.type.endsWith("COMMENT")||re.addDiagnostic(d.diagnostic.unexpected(S.content),S.offset,S.length));ne();)switch(R.type){case"TK_SHARP":if(R.content.match(/^#(include(again)?|dllload)\s/i))ue(R.content,R,e);else if(u=R.content.match(/^(\s*#dllimport\s+)((\w|[^\x00-\x7f])+)/i)){let e=he(R.offset+u[1].length,u[2].length),t=a.Range.create(0,0,0,0),n={t:"ptr",i:"int",s:"str",a:"astr",w:"wstr",h:"short",c:"char",f:"float",d:"double",i6:"int64"},i=u[2],o=[],s="",c=0;ae=!0,u=R.content.substring(u[0].length).match(/^\s*,[^,]+,([^,]*)/),u&&(u=u[1].replace(/\s/g,"").replace(/^\w*=+/,"").toLowerCase(),u.split("").map((e=>{"u"===e?s="u":(n[e]&&o.push(y.create((++c).toString()+"_"+s+n[e],a.SymbolKind.Variable,t,t)),s="")}))),r.push(g.create(i,a.SymbolKind.Function,e,e,o))}else{let e=n.indexOf("\n",F);F=-1===e?X:e}break;case"TK_LABEL":if(D>-1&&"default:"===R.content.toLowerCase())break;if(2===e){re.addDiagnostic(d.diagnostic.propdeclaraerr(),R.offset,R.length);break}_=m.create(R.content,a.SymbolKind.Field,he(R.offset,R.length),he(R.offset,R.length-1)),r.push(_),v.labels&&(E=R.content.toLowerCase().slice(0,-1),_.def=!0,v.labels[E]?v.labels[E][0].def?(re.addDiagnostic(d.diagnostic.duplabel(),R.offset,R.length-1),v.labels[E].push(_)):v.labels[E].unshift(_):v.labels[E]=[_]),1!==Q||"TK_COMMENT"!==S.type&&"TK_BLOCK_COMMENT"!==S.type||(_.detail=fe(S.content));break;case"TK_HOT":x=!0,0!==e?re.addDiagnostic(d.diagnostic.hotdeferr(),R.offset,R.length):(R.content.match(/\s::$/)||(u=R.content.match(/\S(\s*)&(\s*)\S+::/))&&(""===u[1]||""===u[2]))&&re.addDiagnostic(d.diagnostic.invalidhotdef(),R.offset,R.length),_=m.create(R.content,a.SymbolKind.Event,he(R.offset,R.length),he(R.offset,R.length-2)),1!==Q||"TK_COMMENT"!==S.type&&"TK_BLOCK_COMMENT"!==S.type||(_.detail=fe(S.content)),S=R,R=pe(c);let T,k=S,K=new Map([["#parent",_]]);if(_.params=[T=y.create("ThisHotkey",a.SymbolKind.Variable,he(0,0),he(0,0))],T.detail=d.completionitem.thishotkey(),_.funccall=[],_.declaration={},r.push(_),_.global={},_.local={},"{"===R.content)_.children=[],_.children.push(...de(1,K)),_.range=he(k.offset,F-k.offset),re.addSymbolFolding(_,R.offset),te(_);else if("return"===R.content.toLowerCase()){if(R.topofline){_.children=[],_.range=he(k.offset,R.offset+R.length-k.offset),re.addDiagnostic(d.diagnostic.invalidhotdef(),k.offset,k.length);break}let t=_,n=v,i=e;v=_,e=1,_.children=$(void 0,void 0,["return"]),te(t),v=n,e=i,t.range=he(k.offset,S.offset+S.length-k.offset)}else{let t=_,n=v,i=e;v=_,e=1,R.content.toLowerCase().match(/^(global|local|static)$/)?(t.children=[],q()):(C=!1,t.children=$()),te(t),v=n,e=i,t.range=he(k.offset,S.offset+S.length-k.offset)}break;case"TK_HOTLINE":0!==e&&re.addDiagnostic(d.diagnostic.hotdeferr(),R.offset,R.length),_=m.create(R.content,a.SymbolKind.Event,he(R.offset,R.length),he(R.offset,R.length-2)),1!==Q||"TK_COMMENT"!==S.type&&"TK_BLOCK_COMMENT"!==S.type||(_.detail=fe(S.content)),w=n.indexOf("\n",F),F=w>-1?w+1:X,_.range.end=s.positionAt(F-2),r.push(_);break;case"TK_START_BLOCK":O++,P.push(F-1);break;case"TK_END_BLOCK":if(D===O-1&&(D=b),--O>=0&&P.length&&re.addFoldingRange(P.pop()||0,F-1),O<t){if(0!==e||0!==t)return;re.addDiagnostic(d.diagnostic.unexpected("}"),R.offset,1),O=0,P.length=0}break;case"TK_END_EXPR":re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,1);break;case"TK_START_EXPR":"["===R.content?H("[","]"):H("(",")");break;case"TK_UNKNOWN":re.addDiagnostic(d.diagnostic.unknowntoken(R.content),R.offset,R.length);break;case"TK_EQUALS":r.push(...U());break;case"TK_DOT":x&&"TK_WORD"!==S.type&&(x=!1);break;default:break;case"TK_OPERATOR":"%"===R.content?H("%","%"):"?"===R.content?(r.push(...U(void 0,void 0,2,":")),C=!0,":"===R.content&&r.push(...U())):":"===R.content?re.addDiagnostic(d.diagnostic.unexpected(":"),R.offset,1):2===e&&R.content.match(/^\w+$/)&&(R.type="TK_WORD",C=!1,R.semantic={type:h.variable});break;case"TK_NUMBER":if(!n.charAt(F).match(/\(|\[/))break;R.type="TK_WORD";case"TK_WORD":if("%"===n.charAt(F))break;let M,I,j="",W="."===n.charAt(R.offset-1),B=R.topofline&&"static"===S.content.toLowerCase();if(R.topofline){if(D>-1&&":"===n.charAt(F)&&"default"===R.content.toLowerCase()){R.content+=":",R.length++,R.type="TK_LABEL",F++;break}if(ae&&"macro"===R.content.toLowerCase()){let e=n.indexOf("\n",F);e=-1===e?X:e,n.substring(F,e).match(/^\s*(\w|[^\x00-\x7f])+\(/)&&(e=Q,R.semantic={type:h.keyword,modifier:1<<p.static},R=Fe(),Q=e,R.topofline=!0)}}else if(S.topofline&&"{"===S.content&&":"===n.charAt(F)){let e;if(D>-1&&"default"===R.content.toLowerCase()||(e=re.get_tokon(F+1)).topofline||e.type.endsWith("COMMENT")){R.content+=":",R.length++,R.type="TK_LABEL",F++,C=!e;break}}if(x=W?x:R.topofline||!1,W||"("!==n.charAt(F)){B?""!==c.type&&(j=fe(c.content)):1===Q&&("TK_COMMENT"===S.type||"TK_BLOCK_COMMENT"===S.type?j=fe(S.content):""!==c.type&&(j=fe(c.content)));let t,m=S,b=!1,T=0,k=!1,w=[];if(S=R,R=pe(c),C=!1,2===e&&S.topofline&&R.content.match(/^(\[|=>|\{)$/)){let n=S;if(C=!0,"["===R.content){R.topofline&&re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length);let e,i=!1,o=!1;e:for(;ne();)switch(R.type){case"TK_WORD":let n=Fe();if("TK_WORD"===n.type&&"byref"===R.content.toLowerCase()){re.addDiagnostic(d.diagnostic.deprecated("&","ByRef"),R.offset,5,a.DiagnosticSeverity.Warning),k=!0,R=n,C=!1;continue e}if(","!==S.content&&"["!==S.content||!n.content.match(/^(:=|,|\]|\*)$/))i=!0;else if(R.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(R.content),R.offset,R.length),_=y.create(R.content,a.SymbolKind.Variable,t=he(e=R.offset,R.length),t),R.semantic={type:h.parameter,modifier:1<<p.definition},k&&(_.ref=!0,_.def=!0,k=!1),w.push(_),":="===n.content)if(R=pe(),"-"!==R.content&&"+"!==R.content||(n=Fe(),"TK_NUMBER"===n.type?(R.content=R.content+n.content,R.length=R.content.length,R.type="TK_NUMBER"):R.type="TK_UNKNOWN"),"TK_STRING"===R.type||"TK_NUMBER"===R.type||["unset","true","false"].includes(R.content.toLowerCase()))_.defaultVal=R.content,"unset"===R.content.toLowerCase()&&(R.semantic={type:h.variable,modifier:1<<p.readonly}),o=!0,R=n,n=pe(),"]"===n.content?C=!1:"TK_COMMA"!==n.type&&(i=!0);else{if("]"===R.content){_.arr||re.addDiagnostic(d.diagnostic.defaultvalmissing(_.name),e,_.name.length),C=k=!1;continue}i=!0}else"*"===n.content&&(Ie("]")?_.arr=!0:re.addDiagnostic(d.diagnostic.unexpected("*"),n.offset,1)),o&&!_.arr&&re.addDiagnostic(d.diagnostic.defaultvalmissing(_.name),e,_.name.length),C="]"!==n.content;S=R,R=n,k=!1;break;case"TK_END_EXPR":if("]"===R.content&&--T<0){ne();break e}break;case"TK_START_EXPR":"["===R.content&&T++;default:if("*"===R.content&&(","===S.content||"["===S.content)&&Ie("]")){R.type="TK_WORD",C=!1;break}if("&"===R.content&&(","===S.content||"["===S.content)){if(n=Fe(),C=!1,"TK_WORD"===n.type){k=!0,R=n;break}S=R,R=n}i=!0}i&&re.addDiagnostic(d.diagnostic.invalidparam(),n.offset,S.offset-n.offset+1),0===w.length&&re.addDiagnostic(d.diagnostic.propemptyparams(),n.offset,S.offset-n.offset+1)}let c=a.DocumentSymbol.create(n.content,j,a.SymbolKind.Property,t=he(n.offset,n.length),Object.assign({},t));if(c.parent=v,c.params=w,c.full=`(${o.slice(0,-1)}) ${B?"static ":""}${n.content}`+(w.length?`[${w.map((e=>(e.ref?"&":"")+e.name+(e.defaultVal?" := "+e.defaultVal:""))).join(", ")}]`:""),c.static=B,r.push(c),c.children=[],Z(n),c.funccall=[],n.semantic={type:h.property,modifier:1<<p.definition|(B?1<<p.static:0)},"{"===R.content){let t,n,r,l=e,u=R.offset;for(R=pe(),C=!1,e=1;ne()&&"TK_END_BLOCK"!==R.type;)if(R.topofline&&(R.content=R.content.toLowerCase()).match(/^[gs]et$/)){let l;if(R.semantic={type:h.function,modifier:1<<p.definition|1<<p.readonly},t=R,n=pe(),"=>"===n.content){R=n,e=3;let o,u={},f=v.funccall.length;r=g.create(t.content.toLowerCase(),a.SymbolKind.Function,he(t.offset,F-t.offset),he(t.offset,t.length),[...w]),t.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(t.content),t.offset,t.length),S=R,R=n,r.parent=c,o=$(u,void 0,["return"]),e=2,null===(i=r.funccall)||void 0===i||i.push(...v.funccall.splice(f)),r.range.end=s.positionAt(S.offset+S.length),c.range.end=r.range.end,re.addFoldingRangePos(r.range.start,r.range.end,"line"),r.returntypes=u,r.children=[],"=>"===S.content&&re.addDiagnostic(d.diagnostic.invaliddefinition("function"),t.offset,t.length);for(const e in u)u[e]=r.range.end;"set"===t.content.toLowerCase()&&(r.params.unshift(l=y.create("Value",a.SymbolKind.Variable,a.Range.create(0,0,0,0),a.Range.create(0,0,0,0))),l.detail=d.completionitem.value()),r.children.push(...o),te(r)}else if("{"===n.content){r=g.create(t.content,a.SymbolKind.Function,he(t.offset,F-t.offset),he(t.offset,3),[...w]);let e=new Map([["#parent",r]]);r.parent=c,r.children=de(3,e,o),r.range.end=s.positionAt(F),"set"===t.content.toLowerCase()&&(r.params.unshift(l=y.create("Value",a.SymbolKind.Variable,a.Range.create(0,0,0,0),a.Range.create(0,0,0,0))),l.detail=d.completionitem.value()),te(r),re.addSymbolFolding(r,n.offset),t.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(t.content),t.offset,t.length)}else{if(re.addDiagnostic(d.diagnostic.invalidprop(),n.offset,n.length),"}"===n.content){C=!1;break}{r=void 0;let e=0;for(;"TK_EOF"!==R.type;){if("{"===R.content)e++;else if("}"===R.content&&--e<0)break;ne()}C=!1}}r&&c.children.push(r)}else{re.addDiagnostic(d.diagnostic.invalidprop(),R.offset,R.length);let e=0;for(;"TK_EOF"!==R.type;){if("{"===R.content)e++;else if("}"===R.content&&--e<0)break;ne()}C=!1}c.range.end=s.positionAt(F-1),e=l,re.addSymbolFolding(c,u)}else if("=>"===R.content){let n,i=F,o={},r=v.funccall.length;e=3,n=g.create("get",a.SymbolKind.Function,t=he(i,F-i),Object.assign({},t),w),n.returntypes=o,n.parent=c,n.children=$(o,void 0,["return"]),null===(l=n.funccall)||void 0===l||l.push(...v.funccall.splice(r)),e=2,"=>"===S.content&&re.diagnostics.push({message:d.diagnostic.invaliddefinition("function"),range:n.selectionRange,severity:a.DiagnosticSeverity.Error}),n.range.end=s.positionAt(S.offset+S.length),c.range.end=n.range.end,re.addFoldingRangePos(n.range.start,n.range.end,"line");for(const e in o)o[e]=n.range.end;te(n),c.children.push(n)}1===c.children.length&&"get"===c.children[0].name&&(n.semantic.modifier=(n.semantic.modifier||0)|1<<p.readonly)}else{if(!S.topofline&&("TK_HOT"===m.type||m.topofline&&"{"===m.content||"TK_RESERVED"===m.type&&m.content.match(/^(try|else|finally)$/i))&&(S.topofline=b=x=!0),W||S.topofline&&"TK_EQUALS"!==R.type&&"TK_DOT"!==R.type&&!["=","?"].includes(R.content)&&!n.charAt(S.offset+S.length).match(/[^\s,]/))if(2===e)W&&Z(S),"TK_EQUALS"!==R.type&&"TK_DOT"!==R.type&&re.addDiagnostic(W?d.diagnostic.declarationerr():d.diagnostic.propnotinit(),S.offset,S.length);else if(W&&"TK_DOT"===R.type)Z(S),M=I=z(S);else if((u=n.charAt(S.offset+S.length)).match(/^(\(|\s|,|)$/)){if(S.topofline){","===u&&re.addDiagnostic(d.diagnostic.funccallerr(),R.offset,1);let e=S,t=$();if(b&&(S.topofline=!1),r.push(...t),"%"!==n.charAt(e.offset-1)){let i;if(e.semantic={type:h.function},Y(e))if(v.funccall.push(i=a.DocumentSymbol.create(e.content,void 0,a.SymbolKind.Function,he(e.offset,S.offset+S.length-e.offset),he(e.offset,e.length))),i.paraminfo=t.paraminfo,i.offset=e.offset,e.callinfo=i,S===e){let t=n.indexOf("\n",e.offset);i.range.end=s.positionAt(-1===t?X:t)}else")"===R.content&&(i.range.end=s.positionAt(R.offset+R.length))}break}if(W&&"TK_EQUALS"!==R.type&&"="!==R.content&&"?"!==R.content){if(Z(S),M=I=z(S),"("===R.content||x){","===u&&re.addDiagnostic(d.diagnostic.funccallerr(),R.offset,1);let e,t=S,i={};if("("===R.content?(C=!0,H("(",")",void 0,i)):(e=$(),r.push(...e)),"%"!==n.charAt(t.offset-1)){let n;t.semantic={type:h.method},v.funccall.push(n=a.DocumentSymbol.create(t.content,void 0,a.SymbolKind.Method,he(t.offset,S.offset+S.length-t.offset),he(t.offset,t.length))),n.paraminfo=(e||i).paraminfo,n.offset=t.offset,t.callinfo=n,S===t?n.range.end=s.positionAt("TK_EOF"===R.type?X:s.offsetAt({line:s.positionAt(R.offset).line,character:0})-1):")"===R.content&&(n.range.end=s.positionAt(R.offset+R.length))}break}}else W&&(Z(S),M=I=z(S))}else W&&(Z(S),M=I=z(S));else Y(S,e)&&(I=r[r.length-1],j?I.detail=L=j:L&&","===m.content&&!c.type?I.detail=L:L="","&"===m.content&&n.substring(J+1,m.offset-1).trim().match(/(:=|,|\()$/)&&(I.def=!0)),2===e&&"TK_EQUALS"!==R.type&&"."!==n.charAt(S.offset+S.length)&&re.addDiagnostic(d.diagnostic.propnotinit(),S.offset,S.length);if("TK_EQUALS"===R.type){C=!0;let e={},t=R.content,n=U(void 0,e);if(r.push(...n),I){I.returntypes={[":="===t?(null===(f=Object.keys(e).pop())||void 0===f?void 0:f.toLowerCase())||"#any":".="===t?"#string":"#number"]:!0},I.range={start:I.range.start,end:s.positionAt(S.offset+S.length)},":="===t&&"object"==typeof e[" #object"]&&(I.property=Object.values(e[" #object"])),M||(I.def=!0);let n=I.returntypes;for(const e in n)n[e]=I.range.end}}else if("TK_OPERATOR"===R.type&&I&&(!R.topofline||!["!","~","not"].includes(R.content.toLowerCase()))){I.returntypes={["."===R.content?"#string":R.content.match(/^[a-zA-Z]+$/)?"#any":"#number"]:!0},I.range={start:I.range.start,end:s.positionAt(S.offset+S.length)};let e=I.returntypes;for(const t in e)e[t]=I.range.end;R.content.match(/^(\+\+|--)$/)&&(I.def=!0,R=Object.assign({},R),R.content="")}}break}{let t=R.semantic={type:h.function};B?""!==c.type&&(j=fe(c.content)):1===Q&&(c.type?j=fe(c.content):"TK_COMMENT"!==S.type&&"TK_BLOCK_COMMENT"!==S.type||(j=fe(S.content))),A={},S=R,R=Fe();let i,l=S,u=r.length,f=V(A),m=F,y=pe(c);if("=>"===y.content){f||(f=[],r.splice(u),re.addDiagnostic(d.diagnostic.invalidparam(),l.offset,R.offset-l.offset+1)),re.diagnostics.push(...N);let n=e,c=v;e|=1,i=g.create(l.content,2===n?(t.type=h.method,a.SymbolKind.Method):a.SymbolKind.Function,a.Range.create(l.pos=s.positionAt(l.offset),{line:0,character:0}),he(l.offset,l.length),f,void 0,B),v=i,i.detail=j||i.detail,S=R,R=y;let m={},b=$(m,void 0,["return"]),_=l.content.toLowerCase();r.push(i),v=c,e=n,t.modifier=1<<p.definition|1<<p.readonly|(B?1<<p.static:0),0!==e&&(i.parent=v),l.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(l.content),l.offset,l.length),"=>"===S.content&&re.addDiagnostic(d.diagnostic.invaliddefinition("function"),l.offset,l.length),i.range.end=s.positionAt(S.offset+S.length),i.closure=!!(1&e),re.addFoldingRangePos(i.range.start,i.range.end,"line"),i.returntypes=m,i.static=B,i.children=[...b],te(i);for(const e in m)m[e]=i.range.end;2===e&&(i.full=`(${o.slice(0,-1)}) `+i.full,B||"__new"!==i.name.toLowerCase()||(i.returntypes={[o.replace(/([^.]+)\.?$/,"@$1")]:i.range.end}),re.object.method[_]||(re.object.method[_]=[]),re.object.method[_].push(i))}else if("{"===y.content&&l.topofline){f||(f=[],r.splice(u),re.addDiagnostic(d.diagnostic.invalidparam(),l.offset,R.offset-l.offset+1)),re.diagnostics.push(...N);let n=new Map,c=l.content.toLowerCase();i=g.create(l.content,2===e?(t.type=h.method,a.SymbolKind.Method):a.SymbolKind.Function,a.Range.create(l.pos=s.positionAt(l.offset),{line:0,character:0}),he(l.offset,l.length),f,void 0,B),0!==e&&(i.parent=v),n.set("#parent",i),i.funccall=[],i.detail=j||i.detail,r.push(i),i.children=[],i.children.push(...de(1|e,n,o)),i.closure=!!(1&e),te(i),t.modifier=1<<p.definition|1<<p.readonly|(B?1<<p.static:0),l.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(l.content),l.offset,l.length),i.range.end=s.positionAt(F),i.static=B,re.addSymbolFolding(i,y.offset),0!==e&&2===e&&(i.full=`(${o.slice(0,-1)}) `+i.full,B||"__new"!==i.name.toLowerCase()||(i.returntypes={[o.replace(/([^.]+)\.?$/,"@$1")]:i.range.end}),re.object.method[c]||(re.object.method[c]=[]),re.object.method[c].push(i))}else if(C=!1,S=R,R=y,f)for(const e of f)G(e.name.toLowerCase())||(r.push(e),(e.ref||e.returntypes)&&(e.def=!0));if(!i&&"%"!==n.charAt(l.offset-1)){let e;Y(l),v.funccall.push(e=a.DocumentSymbol.create(l.content,void 0,a.SymbolKind.Function,he(l.offset,m-l.offset),he(l.offset,l.length))),e.paraminfo=A.paraminfo,e.offset=l.offset,l.callinfo=e}}break;case"TK_RESERVED":q()}}function q(){let t,i=R.content.toLowerCase(),l=S,u=F,m=Q;if(2===e){if(t=Fe(),C=!1,F=R.offset+R.length,R.type="TK_WORD",t.content.match(/^(:=|=>|\{)$/)||n.charAt(R.offset+R.length).match(/(\[|\()/))return;if(":="===t.content||"class"!==i&&"static"!==i)return void re.addDiagnostic(d.diagnostic.propdeclaraerr(),R.offset,R.length);t=void 0,C=!0,R.type="TK_RESERVED"}switch(i){case"class":if(!R.topofline||1&e){C=!1,R.type="TK_WORD";break}let b,T,k="",w=new Map,x=R.offset,E="";if(1!==m||"TK_COMMENT"!==c.type&&"TK_BLOCK_COMMENT"!==c.type?c.type="":(E=fe(c.content),x=c.offset),ne(),R.topofline||"TK_RESERVED"!==R.type||(R.type="TK_WORD",2!==e&&re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length)),!R.topofline&&"TK_WORD"===R.type){if(1&e&&re.addDiagnostic(d.diagnostic.classinfuncerr(),R.offset,R.length),b=R,S=R,R=pe(),"extends"===R.content.toLowerCase())if(R=Fe(),"TK_WORD"===R.type){for(k=R.content,r.push(y.create(R.content,a.SymbolKind.Variable,T=he(R.offset,R.length),T));F<X&&"."===n.charAt(F)&&(F++,R=Fe(),"TK_WORD"===R.type);)k+="."+R.content;"TK_WORD"===R.type&&(R=pe())}else re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length);else Ie("{")&&(re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length),S=R,R=Fe());if("TK_START_BLOCK"!==R.type){C=!1;break}b.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(b.content),b.offset,b.length),_=a.DocumentSymbol.create(b.content,void 0,a.SymbolKind.Class,he(0,0),he(b.offset,b.length)),w.set("#parent",_),_.funccall=[],_.full=o+b.content,_.children=[],_.staticdeclaration={},_.declaration={},_.cache=[],_.returntypes={[(o+"@"+b.content).toLowerCase()]:!0},E&&(_.detail=E),k&&(_.extends=k),_.children.push(...de(2,w,o+b.content+".")),_.range=he(x,F-x),te(_),b.semantic={type:h.class,modifier:1<<p.definition|1<<p.readonly},re.addSymbolFolding(_,R.offset);for(const e of _.children)e.children&&e.kind!=a.SymbolKind.Property&&(e.parent=_);return r.push(_),!0}C=!1,S.type="TK_WORD",F=S.offset+S.length,R=S,S=l;break;case"global":case"static":case"local":if(1===Q&&c.type&&(t=c),S=R,R=pe(),2===e&&"TK_OPERATOR"===R.type&&R.content.match(/^\w+$/)&&(R.type="TK_WORD"),R.topofline)2===e&&"static"!==i?re.addDiagnostic(d.diagnostic.propdeclaraerr(),S.offset,S.length):"global"===i&&void 0!==v.assume?v.assume=f.GLOBAL:"local"===i&&re.addDiagnostic(d.diagnostic.declarationerr(),S.offset,S.length);else if("TK_WORD"===R.type||"TK_RESERVED"===R.type){if(0===e){C=!1,"global"!==i&&re.addDiagnostic(d.diagnostic.declarationerr(),S.offset,S.length);break}if(2===e&&"static"!==i){re.addDiagnostic(d.diagnostic.propdeclaraerr(),S.offset,S.length),C=!1;break}if(t&&Object.assign(c,t),t=pe(),F=R.offset+R.length,t.content.match(/^(\(|\[|\{|=>)/))R.topofline=!0;else{let t;if(C=!1,t=function(t){var i;let o,l=[],u="";e:for(;ne();){if(R.topofline&&!me(S,R)){C=!1;break}switch(R.type){case"TK_WORD":if(o=S,S=R,R=pe(),"TK_EQUALS"===R.type){let n,a={},f=R.content;if("TK_DOT"===o.type?Z(S):Y(S,e,l)?(n=l[l.length-1],c.type?(n.detail=u=fe(c.content),c.type=""):u&&","===o.content&&!c.type?n.detail=u:u=""):t&&re.addDiagnostic(d.diagnostic.conflictserr(t,"built-in variable",S.content),S.offset,S.length),r.push(...U(void 0,a)),n){n.returntypes={[":="===f?(null===(i=Object.keys(a).pop())||void 0===i?void 0:i.toLowerCase())||"#any":".="===f?"#string":"#number"]:!0},n.range={start:n.range.start,end:s.positionAt(S.offset+S.length)},n.def=!0,":="===f&&"object"==typeof a[" #object"]&&(n.property=Object.values(a[" #object"]));let e=n.returntypes;for(const t in e)e[t]=n.range.end}}else{if(2===e&&"."!==n.charAt(S.offset+S.length)){if("TK_COMMA"===o.type){if(S.ignore=!0,re.addDiagnostic(d.diagnostic.propnotinit(),S.offset,S.length,a.DiagnosticSeverity.Warning),R.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(R.type)||R.content.match(/^(!|~|not)$/i)))break e;continue}re.addDiagnostic(d.diagnostic.propnotinit(),S.offset,S.length)}if("TK_COMMA"===R.type||R.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(R.type)||R.content.match(/^(!|~|not)$/i))){if(Y(S,e,l)){let e=l[l.length-1];c.type?(e.detail=u=fe(c.content),c.type=""):u&&","===o.content&&!c.type?e.detail=u:u=""}else t&&re.addDiagnostic(d.diagnostic.conflictserr(t,"built-in variable",S.content),S.offset,S.length);if("TK_COMMA"!==R.type)break e}}break;case"TK_COMMENT":case"TK_BLOCK_COMMENT":case"TK_INLINE_COMMENT":case"TK_COMMA":continue;case"TK_UNKNOWN":re.addDiagnostic(d.diagnostic.unknowntoken(R.content),R.offset,R.length);break;case"TK_RESERVED":if(2!==e){if(R.content.match(/\b(and|or|not)\b/i)){let e=F,t=pe();if("TK_EQUALS"!==t.type&&!t.content.match(/^([<>]=?|~=|&&|\|\||[,.&|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/)){S=R,R=t,C=!1;break}F=e}re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length)}C=!1,R.type="TK_WORD";break;case"TK_END_BLOCK":case"TK_END_EXPR":re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,1);break;default:break e}}return l}("global"===i?"":i),"global"===i)t.map((e=>{v.global[e.name.toLowerCase()]=e}));else if(2===e)for(const e of t)e.kind===a.SymbolKind.Property&&(e.static=!0);else t.map((e=>{v.local[e.name.toLowerCase()]=e}));r.push(...t)}}else"TK_EQUALS"===R.type&&(F=S.offset+S.length,S.type="TK_WORD",R=S,S=l,2!==e&&re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length));C=!1;break;case"loop":if(2===e){t=pe(),C=!1,F=R.offset+R.length,R.type="TK_WORD",":="!==t.content&&re.addDiagnostic(d.diagnostic.propdeclaraerr(),R.offset,R.length);break}if(S=R,R=Fe(),"TK_EQUALS"===R.type)F=S.offset+S.length,S.type="TK_WORD",R=S,S=l,C=!1,2!==e&&re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length);else{if(2===e){re.addDiagnostic(d.diagnostic.propdeclaraerr(),S.offset,S.length);break}(C="TK_WORD"===R.type&&["parse","files","read","reg"].includes(R.content.toLowerCase()))&&(R.type="TK_RESERVED")}if(R.topofline||"TK_START_BLOCK"===R.type||r.push(...$(void 0,"{")),W())return;"TK_RESERVED"===R.type&&"until"===R.content.toLowerCase()&&(C=!0,r.push(...U()));break;case"for":for(Ie("(")&&(t=Fe());ne();)switch(R.type){case"TK_COMMA":break;case"TK_RESERVED":if(!("class"===R.content.toLowerCase()&&1&e)){re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length);break}R.type="TK_WORD";case"TK_WORD":Y(R,0)&&(r[r.length-1].def=!0);break;case"TK_OPERATOR":return"in"===R.content.toLowerCase()?(r.push(...U()),t&&(")"!==R.content?re.addDiagnostic(d.diagnostic.missing(")"),t.offset,t.length):(C=!0,ne())),void(W()||"TK_RESERVED"!==R.type||"until"!==R.content.toLowerCase()||(C=!0,r.push(...U())))):(re.addDiagnostic(d.diagnostic.unknownoperatoruse(),R.offset,R.length),void(C=!1));default:C=!1;case"TK_END_EXPR":return void re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length);case"TK_EQUALS":return void re.addDiagnostic(d.diagnostic.reservedworderr(S.content),S.offset,S.length)}break;case"continue":case"break":case"goto":if(2===e){t=pe(),C=!1,F=R.offset+R.length,R.type="TK_WORD",":="!==t.content&&re.addDiagnostic(d.diagnostic.propdeclaraerr(),R.offset,R.length);break}if(S=R,R=Fe(),C=!1,!R.topofline)if("TK_WORD"===R.type||"TK_RESERVED"===R.type||"TK_NUMBER"===R.type)R.ignore=!0,g(R);else if(R.type.endsWith("COMMENT"));else if("("!==R.content||"("!==n.charAt(S.offset+S.length))F=S.offset+S.length,S.type="TK_WORD",R=S,S=l,C=!1,re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length);else{let e=[];C=!0,H("(",")",void 0,{},e),e.map((e=>{-1===e.content.indexOf("\n")&&g({content:e.content.slice(1,-1),offset:e.offset+1,length:e.length-2,type:""})}))}break;case"as":case"catch":case"else":case"finally":case"until":re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length);break;case"super":3&e?R.ignore=!0:re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length),R.type="TK_WORD",C=!1;break;case"case":-1!==D&&(R.topofline||S.topofline&&"{"===S.content)?(S=R,R=pe(),C=!1,":"===R.content||R.topofline?re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length):(K=S.offset,r.push(...$(void 0,":",["case",20])),K=-1,":"!==R.content?(re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length),C=!1):C=!0)):(R.type="TK_WORD",re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length));break;case"try":if(ne(),C=!1,W(!0),"TK_RESERVED"===R.type&&"else"!==R.content.toLowerCase()){for(;"catch"===R.content.toLowerCase();)C=!0,j();"else"===R.content.toLowerCase()&&(C=!0,ne(),C=!1,W(!0)),"finally"===R.content.toLowerCase()&&(C=!0,ne(),C=!1,W(!0))}break;case"isset":"("===n.charAt(R.offset+5)?(R.type="TK_WORD",C=!1):re.addDiagnostic(d.diagnostic.missing("("),R.offset,5);break;default:if(t=pe(),"TK_EQUALS"===t.type||t.content.match(/^([<>]=?|~=|&&|\|\||[.&|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/))R.type="TK_WORD",F=u,re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length);else{let n={};if(S=R,R=t,C=!1,"return"===i){if(r.push(...$(n,void 0,[i])),1&e){let e=s.positionAt(S.offset+S.length);v.returntypes||(v.returntypes={});for(const t in n)v.returntypes[t]=e}}else"switch"===i?(D=O,r.push(...$(void 0,"{",[i,2])),"{"===R.content?W(null):re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length)):"if"!==i&&"while"!==i||(r.push(...$(void 0,"{",[i])),W())}}function g(e){if(v.labels){i=e.content.toLowerCase(),v.labels[i]||(v.labels[i]=[]);let t=he(e.offset,e.length);v.labels[i].push(a.DocumentSymbol.create(e.content,void 0,a.SymbolKind.Field,t,t))}}}function j(){let e,n;if(Ie("(")&&(e=pe()),S=n=R,R=pe(),R.topofline||"TK_WORD"!==R.type&&!t.allIdentifierChar.test(R.content))e?(F=e.offset-1,re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length)):(C=!1,R.topofline||"{"===R.content?W(null):re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length));else{if(C=!0,"as"!==R.content.toLowerCase()){for(;"TK_WORD"!==R.type?re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length):Y(R),S=R,R=pe(),","===R.content&&(S=R,R=pe(),t.allIdentifierChar.test(R.content)););if(e){if("{"===R.content)return re.addDiagnostic(d.diagnostic.missing(")"),e.offset,1),W(null);if(")"===R.content)return ne(),C=!1,W(null)}else if("{"===R.content||R.topofline)return C=!1,W(null)}if("as"===R.content.toLowerCase())if(S=R,R=pe(),C=!1,"TK_WORD"===R.type||t.allIdentifierChar.test(R.content))if("TK_WORD"!==R.type)re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length),R.type="TK_WORD";else{let t=pe();F=R.offset+R.length,t.topofline||"{"===t.content||e&&")"===t.content?(Y(R)&&(C=!0,r[r.length-1].def=!0),e&&(")"===t.content?(F=t.offset+1,C=!0):re.addDiagnostic(d.diagnostic.missing(")"),e.offset,1)),C&&(ne(),C=!1,W(null))):(re.addDiagnostic(d.diagnostic.unexpected(n.content),n.offset,n.length),C=!1)}else re.addDiagnostic(d.diagnostic.unexpected(n.content),n.offset,n.length);else e&&(")"===R.content?(S=R,R=pe()):re.addDiagnostic(d.diagnostic.missing(")"),e.offset,1)),R.topofline?(C=!1,W(null)):re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length)}}function W(e=!1){if("TK_START_BLOCK"===R.type)C=!0,P.push(F-1),I(++O),ne(),C="TK_RESERVED"===R.type&&"else"===R.content.toLowerCase();else{if("TK_RESERVED"===R.type&&k.includes(R.content.toLowerCase())){let t=R;if(C=!0,q())return e;t!==R&&(t!==S||C||R.topofline)||r.push(...$())}else{let e="",t=S;if(C=!0,ne(),C=!1,"TK_WORD"===S.type&&("TK_DOT"===R.type||"TK_EQUALS"!==R.type&&(e=n.charAt(S.offset+S.length)).match(/^[,\s]?$/))&&(S.topofline||"TK_RESERVED"===t.type&&t.content.match(/^(try|else|finally)$/i)))if("TK_DOT"===R.type)for(Y(S),t=R,C=!0;ne();){if("TK_WORD"===R.type){if(Z(R),ne(),"TK_DOT"===R.type)continue;if(C=!1,"TK_EQUALS"!==R.type&&n.charAt(S.offset+S.length).match(/^[,\s]?$/)){let e,t=S,i=$();if(r.push(...i),t.semantic={type:h.method},v.funccall.push(e=a.DocumentSymbol.create(t.content,void 0,a.SymbolKind.Method,he(t.offset,S.offset+S.length-t.offset),he(t.offset,t.length))),e.paraminfo=i.paraminfo,e.offset=t.offset,t.callinfo=e,S===t){let i=n.indexOf("\n",t.offset);e.range.end=s.positionAt(-1===i?X:i)}else")"===R.content&&(e.range.end=s.positionAt(R.offset+R.length))}else r.push(...$())}else C=!1,r.push(...$());break}else{","===e&&re.addDiagnostic(d.diagnostic.funccallerr(),R.offset+R.length,1),Y(S);let t,i=S,o=$();if(r.push(...o),i.semantic={type:h.function},v.funccall.push(t=a.DocumentSymbol.create(i.content,void 0,a.SymbolKind.Function,he(i.offset,S.offset+S.length-i.offset),he(i.offset,i.length))),t.paraminfo=o.paraminfo,t.offset=i.offset,i.callinfo=t,S===i){let e=n.indexOf("\n",i.offset);t.range.end=s.positionAt(-1===e?X:e)}else")"===R.content&&(t.range.end=s.positionAt(R.offset+R.length))}else R=S,S=t,F=R.offset+R.length,R.topofline&&(R.topofline=1),r.push(...$())}C="TK_RESERVED"===R.type&&"else"===R.content.toLowerCase()}if("boolean"==typeof e)if(e)C=!1;else if(C)return ne(),C=!1,W(!0),!0;return!1}function $(e,t,n){var i,o;let r,a=[],s=0,c=0,l={count:0,comma:[],miss:[],unknown:!1};for(C?re.get_tokon(r=F,!0).topofline||++l.count:(r=R.offset,R.topofline||R.type.endsWith("COMMET")||++l.count);;){let n={};if(a.push(...U(void 0,n,0,t)),"TK_COMMA"===R.type)C=!0,++s,++l.count,"TK_COMMA"===S.type||"("===S.content?l.miss.push(l.comma.length):"TK_OPERATOR"!==S.type||S.content.match(/(--|\+\+|%)/)||re.addDiagnostic(d.diagnostic.unexpected(","),R.offset,1),l.comma.push(R.offset);else{if(R.topofline){C=!1,e&&(n=null===(i=Object.keys(n).pop())||void 0===i?void 0:i.toLowerCase())&&(e[n]=!0);break}if(t===R.content)break;c!==F&&(re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,R.length),C=!1)}if(c===F)break;c=F}return n&&s>=(n[1]=null!==(o=n[1])&&void 0!==o?o:1)&&re.addDiagnostic(d.diagnostic.acceptparams(n[0],n[1]),r,S.offset>0?S.offset+S.length-r:0),"*"===S.content&&(l.unknown=!0),Object.defineProperty(a,"paraminfo",{value:l}),a}function U(t,i={},o=1,l){var u,f;let m,y,b=r.length,T="",k=!1,w=[];for(;ne();){if(!0===R.topofline&&!t&&!me(S,R)){"TK_WORD"===S.type&&"."===n.charAt(S.offset-1)&&(Z(S),z(S)),C=!1;break}switch(R.type){case"TK_WORD":let E="."===n.charAt(R.offset-1);if("("===n.charAt(F))break;if(S=R,R=pe(c),"TK_COMMA"===R.type){if(E)Z(S),z(S),T+="."+S.content;else if("%"!==n.charAt(S.offset-1)){if(Y(S)&&k){let e=r[r.length-1];e.ref=e.def=!0}T+=" "+S.content}return i[T]=!0,C=!1,r.splice(b)}if(!("TK_OPERATOR"!==R.type||R.topofline&&R.content.match(/^(!|~|not|\+\+|--)$/i))){"%"!==n.charAt(S.offset-1)&&"%"!==n.charAt(S.offset+S.length)?E?(T+="."+S.content,Z(S),z(S)):(Y(S)&&(r[r.length-1].returntypes={"#number":!0}),T+=" "+S.content):T="#any",C=!1;continue}if(R.topofline&&"TK_EQUALS"!==R.type&&"TK_DOT"!==R.type){if(C=!1,E)"%"!==n.charAt(S.offset-1)?(Z(S),z(S),i[T+"."+S.content]=!0):i["#any"]=!0;else{if("%"!==n.charAt(S.offset-1))if(Y(S)&&k){let e=r[r.length-1];e.ref=e.def=!0,T=T.slice(0,-1)+"#varref"}else T+=" "+S.content;i[T]=!0}return x(),r.splice(b)}if(E)"TK_EQUALS"===R.type?(T=T.replace(/\s*\S+$/,""),Z(S),C=!0):(T+=(E?".":" ")+S.content,Z(S),C=!1);else if("%"!==n.charAt(S.offset-1)&&Y(S)){let e=r[r.length-1];if(k&&(e.ref=e.def=!0,k=!1),"TK_EQUALS"===R.type){let n={},i=R.content;C=!0,r.push(...U(t,n,o||1,null!=l?l:w.length?":":void 0)),e.range={start:e.range.start,end:s.positionAt(S.offset+S.length)},e.returntypes={[n=":="===i?(null===(u=Object.keys(n).pop())||void 0===u?void 0:u.toLowerCase())||"#any":".="===i?"#string":"#number"]:e.range.end},e.ref?T=T.slice(0,-1)+"#varref":(T+=n,e.def=!0),":="===i&&"object"==typeof n[" #object"]&&(e.property=Object.values(n[" #object"]))}else C=!1,e.ref?T=T.slice(0,-1)+"#varref":T+=" "+S.content}else T+=" "+S.content,C=!1;break;case"TK_START_EXPR":if("["===R.content){let e=!!n.charAt(R.offset-1).match(/^(\w|\)|%|[^\x00-\x7f])$/);H("[","]"),e?T=T.replace(/\S+$/,"")+"#any":T+=" #array"}else{let s,u,m,y,b={},k=R.offset,x="("===n.charAt(S.offset+S.length);if("TK_WORD"===S.type&&x){if("."===n.charAt(S.offset-1)){let e=S,t={};if(H("(",")",void 0,t),"%"!==n.charAt(e.offset-1)){let n;e.semantic={type:h.method},v.funccall.push(n=a.DocumentSymbol.create(e.content,void 0,a.SymbolKind.Method,he(e.offset,F-e.offset),he(e.offset,e.length))),n.paraminfo=t.paraminfo,n.offset=e.offset,e.callinfo=n,T+="."+e.content+"()"}continue}s=S}if(c.type="",u=V(b),y=F,m=C?pe(c):R,"=>"===m.content&&u){re.diagnostics.push(...N);let n={},c=v.funccall.length,m=U(t,n,(null==s?void 0:s.topofline)?2:o||1,null!=l?l:w.length?":":void 0);s?(s.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(s.content),s.offset,s.length),s.semantic={type:h.function,modifier:1<<p.definition|1<<p.readonly}):s={content:"",offset:k,length:0,type:""},r.push(_=g.create(s.content,a.SymbolKind.Function,he(s.offset,F-s.offset),he(s.offset,s.length),u,m)),_.returntypes=n,re.addFoldingRangePos(_.range.start,_.range.end,"line"),_.closure=!!(1&e),te(_),null===(f=_.funccall)||void 0===f||f.push(...v.funccall.splice(c));for(const e in n)n[e]=_.range.end;0!==e&&(_.parent=v),T+=" #func",i[T]=!0}else{if(Q>1&&(c.type=""),C=!1,S=R,R=m,s){if("%"!==n.charAt(s.offset-1)){let e;T+=" "+s.content+"()",Y(s),s.semantic={type:h.function},v.funccall.push(e=a.DocumentSymbol.create(s.content,void 0,a.SymbolKind.Function,he(s.offset,y-s.offset),he(s.offset,s.length))),e.paraminfo=b.paraminfo,e.offset=s.offset,s.callinfo=e}}else{let e=Object.keys(b).pop()||"";if("("===n.charAt(y)){let t=e.trim().match(/^\(\s*(([\w.]|[^\x00-\x7f])+)\s*\)$/);t&&(e=t[1])}T+=x?""===T||T.substr(-1).match(/\s/)?e:"()":" "+e}if(u)for(const e of u)G(e.name.toLowerCase())||(r.push(e),(e.ref||e.returntypes)&&(e.def=!0))}}break;case"TK_START_BLOCK":if(T&&("TK_OPERATOR"!==S.type||S.content.match(/^(\+\+|--)$/))&&"TK_EQUALS"!==S.type)return i[T]=" #object"!==T||!y||y,C=!1,x(),r.splice(b);{let e=re.diagnostics.length,t=!1;if("TK_RESERVED"===S.type&&"switch"===S.content.toLowerCase()){let e;if(C=!1,R.topofline||(e=re.get_tokon(F)).topofline||e.type.endsWith("COMMENT"))return x(),r.splice(b);C=t=!0}else"TK_EQUALS"===S.type?":="!==S.content&&re.addDiagnostic(d.diagnostic.unknownoperatoruse(S.content),S.offset,S.length):1===o&&("TK_WORD"===S.type||"TK_OPERATOR"===S.type||S.type.startsWith("TK_END"))&&(o=0);if(B(o>0||t,m={},y={})){T+=" "+(Object.keys(m).pop()||"#object");break}return i[T]=!0,re.diagnostics.splice(e)," #object"===T&&y&&(i[T]=y),x(),C=!1,r.splice(b)}case"TK_NUMBER":T+=" #number";break;case"TK_STRING":T+=" #string";break;case"TK_END_BLOCK":case"TK_END_EXPR":case"TK_COMMA":return C=!1,i[T]=!0," #object"===T&&y&&(i[T]=y),x(),r.splice(b);case"TK_UNKNOWN":re.addDiagnostic(d.diagnostic.unknowntoken(R.content),R.offset,R.length);break;case"TK_RESERVED":if(R.content.match(/\b(and|or|not)\b/i)){let e=F,t=pe();if("TK_EQUALS"!==t.type&&!t.content.match(/^([<>]=?|~=|&&|\|\||[,.&|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/)){S=R,R=t,C=!1;break}F=e}else if(R.content.match(/^(class|super|isset)$/i)){"isset"===R.content.toLowerCase()&&(R.ignore=!0,"("!==n.charAt(R.offset+R.length)&&re.addDiagnostic(d.diagnostic.missing("("),R.offset,R.length)),C=!1,R.type="TK_WORD";continue}re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length);break;case"TK_OPERATOR":if("%"===R.content){if(n.charAt(R.offset-1).match(/\w|[^\x00-\x7f]/)?T=T.replace(/\S+$/,"#any"):T+=("TK_DOT"===S.type?".":" ")+"#any","%"===t)return C=!1,i[T]=!0," #object"===T&&y&&(i[T]=y),x(),r.splice(b);H("%","%")}else if("=>"===R.content&&"TK_WORD"===S.type){let e=S.content.toLowerCase();r.length&&r[r.length-1].name===S.content&&r.pop();let n=U(t,{},1,null!=l?l:w.length?":":void 0);for(let t=n.length-1;t>=0;t--)n[t].name.toLowerCase()===e?n.splice(t,1):n[t].def=!1;r.push(...n),T=T.replace(/\S+$/,"#func")}else{if(T+=" "+R.content,"TK_OPERATOR"!==S.type||S.content.match(/^([:?%]|\+\+|--)$/)||R.content.match(/[+\-%!~]/)||re.addDiagnostic(d.diagnostic.unknownoperatoruse(),R.offset,R.length),"&"===R.content&&["TK_EQUALS","TK_COMMA","TK_START_EXPR"].includes(S.type)){k=!0;continue}if("?"===R.content)w.push(R.offset);else if(":"===R.content&&void 0===w.pop()){if(":"===l||K>-1)return C=!1,T=T.slice(0,-2),i[T]=!0," #object"===T&&y&&(i[T]=y),r.splice(b);re.addDiagnostic(d.diagnostic.unexpected(":"),R.offset,1)}}break;case"TK_EQUALS":T+=" :="}k=!1}return i[T]=!0," #object"===T&&y&&(i[T]=y),x(),r.splice(b);function x(){let e;for(;void 0!==(e=w.pop());)re.addDiagnostic(d.diagnostic.missing(":"),e,1)}}function V(e={}){let t,i=!0,o=F-1,s=[],l=re.diagnostics.length,u=!1,f=R,m="",g={count:0,comma:[],miss:[],unknown:!1};if(!R.topofline&&("TK_OPERATOR"===S.type&&!S.content.match(/(:=|\?|:)/)||!Me(S.type,["TK_START_EXPR","TK_WORD","TK_EQUALS","TK_OPERATOR","TK_COMMA"])||"TK_WORD"===S.type&&Me(n.charAt(R.offset-1),T))&&(i=!1),i)for(N.length=0;ne();){if(")"===R.content){if("TK_COMMA"===S.type)return e["#void"]=!0,g.miss.push(g.count++),Object.defineProperty(e,"paraminfo",{value:g}),void r.push(...s);break}if("TK_WORD"!==R.type){if([",","("].includes(S.content)){if("*"===R.content){if(S=R,R=Fe(),")"===R.content){s.push(y.create("*",a.SymbolKind.Null,t=he(0,0),t));break}}else if("&"===R.content&&(R=Fe(),"TK_WORD"===R.type)){u=!0,C=!1;continue}i=!1;break}i=!1;break}if(g.count++,!Me(S.content,[",","("])){i=!1;break}if("byref"===R.content.toLowerCase()){if(ne(),"TK_WORD"!==R.type){Y(S),C=!1;break}u=!0,re.addDiagnostic(d.diagnostic.deprecated("&","ByRef"),S.offset,5,a.DiagnosticSeverity.Warning,N)}if(S=R,R=pe(c),","!==R.content&&")"!==R.content){if(":="===R.content){if(R=pe(c),"-"===R.content||"+"===R.content){let e=Fe();if("TK_NUMBER"!==e.type){i=!1;break}R.content=R.content+e.content,R.length=R.content.length,R.type="TK_NUMBER"}if("TK_STRING"===R.type||"TK_NUMBER"===R.type||["unset","true","false"].includes(R.content.toLowerCase())){if(S.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(S.content),S.offset,S.length),_=y.create(S.content,a.SymbolKind.Variable,t=he(S.offset,S.length),t),_.def=!0,_.defaultVal=R.content,s.push(_),"TK_STRING"===R.type?(_.returntypes={"#string":!0},m="#string"):"unset"===R.content.toLowerCase()?R.semantic={type:h.variable,modifier:1<<p.readonly}:(_.returntypes={"#number":!0},m="#number"),u&&(u=!1,_.ref=!0,m="#varref"),S=R,R=pe(c),"TK_COMMA"===R.type){g.comma.push(R.offset);continue}i=")"===R.content;break}i=!1;break}if("TK_OPERATOR"===R.type){if("*"!==R.content){i=!1;break}{let e=Fe();if(")"!==e.content){i=!1,S=R,R=e;break}_=y.create(S.content,a.SymbolKind.Variable,t=he(S.offset,S.length),t),s.push(_),S=R,R=e,C=!1,_.arr=!0,g.unknown=!0}continue}if("("===R.content){i=!1,F=S.offset+S.length,R=S;break}i=!1;break}if(S.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(S.content),S.offset,S.length),_=y.create(S.content,a.SymbolKind.Variable,t=he(S.offset,S.length),t),u?(u=!1,_.ref=_.def=!0,m="#varref"):m=_.name,s.push(_),")"===R.content){i=!G(_.name.toLowerCase());break}if(g.comma.push(R.offset),G(_.name.toLowerCase())){i=!1;break}}return i?(e[m.toLowerCase()]=!0,Object.defineProperty(e,"paraminfo",{value:g}),s):(F=o+1,R=f,C=!0,N.length=0,re.diagnostics.splice(l),void H("(",")",o,e))}function B(e=!1,i={},o={}){let a,s,c=S,l=R,u=r.length,f=!0,p={};for(C||"TK_START_BLOCK"!==R.type||(C=!0);m()&&!g(););if(!f){let t=R;return S=c,R=l,r.splice(u),F=R.offset+R.length,e?(function(){let e=0;for(C||"TK_START_BLOCK"!==R.type||(C=!0);ne();)switch(R.type){case"TK_START_BLOCK":e++;break;case"TK_END_BLOCK":if(--e<0)return}}(),re.addDiagnostic(d.diagnostic.objectliteralerr(),t.offset,F-t.offset),!0):C=!1}return":"===S.content&&re.addDiagnostic(d.diagnostic.objectliteralerr(),S.offset,F-S.offset),"TK_END_BLOCK"===R.type?re.addFoldingRange(l.offset,R.offset):re.addDiagnostic(d.diagnostic.missing("}"),l.offset,1),!0;function m(){for(;ne();)switch(a=void 0,R.type){case"TK_RESERVED":case"TK_WORD":if("%"===n.charAt(F))break;return s=pe(),":"===s.content?(R.semantic={type:h.property},o[R.content.toLowerCase()]=R.content,S=R,R=s,a=S,!0):f=!1;case"TK_STRING":return s=pe(),":"===s.content?(S=R,R=s,re.addDiagnostic(d.diagnostic.invalidpropname(),S.offset,S.length),!0):f=!1;case"TK_START_EXPR":return f=!1;case"TK_OPERATOR":if("%"===R.content){if(H("%","%"),b(n.charCodeAt(F)))break;if(s=pe(),":"===s.content)return S=R,R=s,!0}else if(t.allIdentifierChar.test(R.content)&&(s=pe(),":"===s.content))return R.semantic={type:h.property},S=R,R=s,a=S,!0;return f=!1;case"TK_LABEL":if(R.content.match(/^(\w|[^\x00-\x7f])+:$/)){let e;return ee({content:e=R.content.replace(":",""),type:"",offset:0,length:0}),o[e.toLowerCase()]=e,!0}return f=!1;case"TK_COMMENT":case"TK_BLOCK_COMMENT":case"TK_INLINE_COMMENT":R=S;break;case"TK_END_BLOCK":if("TK_START_BLOCK"===S.type||"TK_COMMA"===S.type)return!1;case"TK_NUMBER":if(R.content.match(/^\d+$|^0[xX]/)&&(s=pe(),":"===s.content))return R.semantic={type:h.property},o[R.content.toLowerCase()]=R.content,S=R,R=s,!0;default:return f=!1}return!1}function g(){let e=U(",",p={});if(r.push(...e),a)if("base"===a.content.toLowerCase()){let e=Object.keys(p).pop();e&&e.match(/\.prototype$/i)&&(i[e.slice(0,-10).trim().toLowerCase().replace(/([^.]+)$/,"@$1")]=!0)}else Z(a);return"TK_COMMA"===R.type?!(C=!0):"TK_END_BLOCK"===R.type?C=!0:"TK_EOF"===R.type||!(f=!1)}}function H(t,i,o,c={},l){var u;let f,m=0,b=r.length,T=F,k=S,w=0,x="",E=!1,O=[],D={count:0,comma:[],miss:[],unknown:!1};for(f=void 0===o?[F-1]:[o];ne();){if("%"===t&&R.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(R.type)||R.content.match(/^(!|~|not)$/i))){re.addDiagnostic(d.diagnostic.missing("%"),f[0],1),C=!1,x="#any";break}if("("!==t&&"("===R.content)b=r.length,T=F,w=1,k=S,H("(",")");else if(R.content===i){if(--m<0)break;")"===i&&(x+=")",w++)}else if(R.content===t)m++,f.push(F-1),k=S,"("===t&&(b=r.length,T=F,w=0,x+="(");else if("=>"===R.content){let e,t,o=r.splice(b),s=R,c=-1;if(")"===S.content){if(1!==w){re.addDiagnostic(d.diagnostic.unknownoperatoruse(),R.offset,2),C=!0;continue}S=k,F=T-1,R=Fe(),c=R.offset,e=V(),t=pe()}else{if("TK_WORD"!==S.type||"."===n.charAt(S.offset-1)){re.addDiagnostic(d.diagnostic.unknownoperatoruse(),R.offset,2),C=!0;continue}{let n;t=R,c=S.offset,e=[y.create(S.content,a.SymbolKind.Variable,n=he(S.offset,S.length),n)]}}if(!e||"=>"!==t.content){R=s,F=s.offset+s.length,C=!0,x="",r.push(...o),re.addDiagnostic(d.diagnostic.unknownoperatoruse(),R.offset,2);continue}let l=v.funccall.length,u=U(i,void 0,1,O.length?":":void 0);r.push(_=g.create("",a.SymbolKind.Function,he(c,S.offset+S.length-c),he(c,0),e,u)),te(_),_.funccall=v.funccall.splice(l),v.kind!==a.SymbolKind.Function&&v.kind!==a.SymbolKind.Method||(_.parent=v),x=x.replace(/\([^()]*\)$/,"")+" #func"}else if("TK_WORD"===R.type)if("."!==n.charAt(R.offset-1))if("("!==n.charAt(F)){if("%"===t||"%"!==n.charAt(R.offset-1)&&"%"!==n.charAt(R.offset+R.length))if(Y(R)){let e=r[r.length-1];if(C=!1,S=R,R=pe(),E&&(e.ref=e.def=!0,E=!1),"TK_EQUALS"===R.type){let t={},n=R.content;C=!0,r.push(...U(i,t,2,O.length?":":void 0)),e.range={start:e.range.start,end:s.positionAt(S.offset+S.length)},e.returntypes={[t=":="===n?(null===(u=Object.keys(t).pop())||void 0===u?void 0:u.toLowerCase())||"#any":".="===n?"#string":"#number"]:e.range.end},e.ref?x=x.slice(0,-1)+"#varref":(x+=t,e.def=!0),":="===n&&"object"==typeof t[" #object"]&&(e.property=Object.values(t[" #object"]))}else e.ref?x=x.slice(0,-1)+"#varref":x+=" "+S.content}else x+=" "+R.content}else{S=R,R=Fe(),S.semantic={type:h.function};let t=S,o={},c=V(o),l=F,u=pe();if("=>"===u.content){re.diagnostics.push(...N);let n={},o=v;_=g.create(t.content,a.SymbolKind.Function,he(t.offset,F-t.offset),he(t.offset,t.length),c||[]),t.content.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(t.content),t.offset,t.length),v=_,_.children=U(i,n,2,O.length?":":void 0),v=o,_.range.end=s.positionAt(S.offset+S.length),_.closure=!!(1&e),_.returntypes=n,te(_),t.semantic.modifier=1<<p.definition|1<<p.readonly;for(const e in n)n[e]=_.range.end;0!==e&&(_.parent=v),r.push(_),re.addFoldingRangePos(_.range.start,_.range.end,"line"),x+=" #func"}else{if("%"!==n.charAt(t.offset-1)){let e;Y(t),v.funccall.push(e=a.DocumentSymbol.create(t.content,void 0,a.SymbolKind.Function,he(t.offset,l-t.offset),he(t.offset,t.length))),e.paraminfo=o.paraminfo,e.offset=t.offset,t.callinfo=e,x+=" "+t.content+"()"}if(C=!1,S=R,R=u,c)for(const e of c)G(e.name.toLowerCase())||(r.push(e),(e.ref||e.returntypes)&&(e.def=!0))}}else if("("===n.charAt(F)){let e=R,t={};if(R=Fe(),e.semantic={type:h.method},H("(",")",void 0,t),"%"!==n.charAt(e.offset-1)){let n;x+="."+e.content+"()",e.semantic={type:h.method},v.funccall.push(n=a.DocumentSymbol.create(e.content,void 0,a.SymbolKind.Method,he(e.offset,F-e.offset),he(e.offset,e.length))),n.paraminfo=t.paraminfo,n.offset=e.offset,e.callinfo=n}}else Z(R),z(R);else if("TK_START_BLOCK"===R.type){let e={};["TK_WORD","TK_STRING","TK_NUMBER"].includes(S.type)&&re.addDiagnostic(d.diagnostic.unexpected("{"),R.offset,R.length),B(!0,e),x+=" "+(Object.keys(e).pop()||"#object")}else if("TK_STRING"===R.type)x+=" #string",null==l||l.push(R),"["===t&&Ie("]")&&!R.content.match(/\n|`n/)&&ee({type:"",content:R.content.substring(1,R.content.length-1),offset:0,length:0});else if("["===R.content){let e=!!n.charAt(R.offset-1).match(/^(\w|\)|%|[^\x00-\x7f])$/);H("[","]"),e?x=x.replace(/\S+$/,"")+"#any":x+=" #array"}else if("%"===R.content)n.charAt(R.offset-1).match(/\w|[^\x00-\x7f]/)?x=x.replace(/\S+$/,"#any"):x+=" #any",H("%","%");else{if(R.content.match(/^[)}]$/))return re.addDiagnostic(d.diagnostic.missing(i),f[m],1),C=!1,c[-1===x.indexOf("#any")?"("+x+")":"#any"]=!0,void K();if("TK_RESERVED"===R.type){if(R.content.match(/\b(and|or|not)\b/i)){let e=F,t=pe();if("TK_EQUALS"!==t.type&&!t.content.match(/^([<>]=?|~=|&&|\|\||[,.&|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/)){S=R,R=t,C=!1,x+=" "+{and:"&&",or:"||",not:"!"}[R.content.toLowerCase()];continue}F=e,x+=" "+R.content}else if(R.content.match(/^(class|super|isset)$/i)){"isset"===R.content.toLowerCase()&&(R.ignore=!0,"("!==n.charAt(R.offset+R.length)&&re.addDiagnostic(d.diagnostic.missing("("),R.offset,R.length)),C=!1,R.type="TK_WORD";continue}re.addDiagnostic(d.diagnostic.reservedworderr(R.content),R.offset,R.length)}else if("TK_END_BLOCK"===R.type||"TK_END_EXPR"===R.type)re.addDiagnostic(d.diagnostic.unexpected(R.content),R.offset,1);else if("TK_COMMA"===R.type)if("("!==t)x+=" ,";else if(0===m)x="",++D.count,"TK_COMMA"===S.type||"("===S.content?D.miss.push(D.comma.length):"TK_OPERATOR"!==S.type||S.content.match(/(--|\+\+|%)/)||re.addDiagnostic(d.diagnostic.unexpected(","),R.offset,1),D.comma.push(R.offset);else{let e=x.lastIndexOf("(");x=-1===e?"":x.substring(0,e+1)}else if("TK_NUMBER"===R.type)x+=" #number";else if("TK_OPERATOR"===R.type){if(x+=" "+R.content,"&"===R.content){E=!0;continue}"?"===R.content?O.push(R.offset):":"===R.content&&void 0===O.pop()&&re.addDiagnostic(d.diagnostic.unexpected(":"),R.offset,1)}}E=!1}function K(){let e;for(;void 0!==(e=O.pop());)re.addDiagnostic(d.diagnostic.missing(":"),e,1)}c["("+x+")"]=!0,"TK_EOF"===R.type&&m>-1?re.addDiagnostic(d.diagnostic.missing(i),f[m],1):(","===S.content?D.miss.push(D.count++):"("!==S.content&&(D.count++,"*"===S.content&&(D.unknown=!0)),Object.defineProperty(c,"paraminfo",{value:D})),K()}function z(e){if(""===o)return;let t,i=e.offset-1;for(;Me(n.charAt(i-1),T);)i--;if(n.substring(i-5,i).match(/[^.]this/i)){let n=v,i=!1;if(n.kind===a.SymbolKind.Method||n.kind===a.SymbolKind.Function||n.kind===a.SymbolKind.Class){for(;n&&n.kind!==a.SymbolKind.Class;)n.kind===a.SymbolKind.Method&&n.staic&&(i=!0),n=n.parent;if(n&&n.kind===a.SymbolKind.Class){let o=y.create(e.content,a.SymbolKind.Property,t=he(e.offset,e.length),t);return o.static=i,n.cache.push(o),o}}}}function G(t){return 2!==e&&!!(l.builtin_variable.includes(t)||ae&&l.builtin_variable_h.includes(t))}function Y(e,t=0,n){let i=e.content.toLowerCase();if(e.ignore||G(i))return e.semantic&&delete e.semantic,!1;i.charAt(0).match(/[\d$]/)&&re.addDiagnostic(d.diagnostic.invalidsymbolname(e.content),e.offset,e.length);let s=he(e.offset,e.length),c=y.create(e.content,a.SymbolKind.Variable,s,s);return 2===t&&(c.kind=a.SymbolKind.Property,Z(e),o&&(c.full=`(${o.slice(0,-1)}) ${c.name}`)),n?n.push(c):r.push(c),!0}function Z(e){let t,n=e.content.toLowerCase();e.semantic={type:h.property},re.object.property[n]||(re.object.property[n]=y.create(e.content,a.SymbolKind.Property,t=he(e.offset,e.length),t))}function ee(e){re.texts[e.content.toLowerCase()]=e.content}function te(e){var t,n,i,o,r,s,c,l;let u=e.declaration,h=re.diagnostics,p=!1,m={},g={};if(u)if(e.kind===a.SymbolKind.Class){let o=e.staticdeclaration;null===(t=e.children)||void 0===t||t.map((t=>{if([a.SymbolKind.Property,a.SymbolKind.Method,a.SymbolKind.Class].includes(t.kind)){if(u=t.static||t.kind===a.SymbolKind.Class?o:e.declaration,!u)return;u[E=t.name.toLowerCase()]?(t.kind!==a.SymbolKind.Property||t.def)&&h.push({message:M(u[E],t),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}):(t.kind!==a.SymbolKind.Variable||t.def)&&(u[E]=t)}})),null===(n=e.cache)||void 0===n||n.map((t=>{var n;u=t.static?o:e.declaration,u[E=t.name.toLowerCase()]||(u[E]=t,null===(n=e.children)||void 0===n||n.push(t))})),null===(i=e.cache)||void 0===i||i.splice(0)}else{if(e.assume===f.GLOBAL){null===(o=e.children)||void 0===o||o.map((e=>{if(e.kind===a.SymbolKind.Function){if(!(E=e.name.toLowerCase()))return;u[E]?h.push({message:M(u[E],e),range:e.selectionRange,severity:a.DiagnosticSeverity.Error}):u[E]=e,g[E]=e}})),null===(r=e.params)||void 0===r||r.map((t=>{var n;null===(n=e.children)||void 0===n||n.unshift(t),t.def=!0,t.kind=a.SymbolKind.TypeParameter,u[E=t.name.toLowerCase()]&&u[E].kind===a.SymbolKind.Function?h.push({message:M(t,u[E]),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}):u[E]=t,t.defaultVal||t.arr?p=!0:p&&h.push({message:d.diagnostic.defaultvalmissing(t.name),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}),m[E]?h.push({message:d.diagnostic.conflictserr("parameter","parameter",t.name),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}):m[E]=t}));for(const t in e.local)u[t]?m[t]&&h.push({message:d.diagnostic.conflictserr("local","parameter",m[t].name),range:e.local[t].selectionRange,severity:a.DiagnosticSeverity.Error}):u[t]=e.local[t];for(const t in e.global)m[t]?h.push({message:d.diagnostic.conflictserr("global","parameter",m[t].name),range:e.local[t].selectionRange,severity:a.DiagnosticSeverity.Error}):(u[t]?(re.declaration[t]=u[t],delete u[t]):re.declaration[t]=e.global[t],re.declaration[t].infunc=!0);let t=re.declaration;null===(s=e.children)||void 0===s||s.map((e=>{e.kind===a.SymbolKind.Variable&&(u[E=e.name.toLowerCase()]||(t[E]?t[E].kind!==a.SymbolKind.Variable&&h.push({message:M(t[E],e),range:e.selectionRange,severity:a.DiagnosticSeverity.Error}):(t[E]=e,e.infunc=!0)))}))}else{null===(c=e.children)||void 0===c||c.map((e=>{if(e.kind===a.SymbolKind.Function||e.def){if(!(E=e.name.toLowerCase()))return;u[E]?e.kind===a.SymbolKind.Variable&&u[E].kind===a.SymbolKind.Variable||(u[E].kind===a.SymbolKind.Variable?(h.push({message:M(e,u[E]),range:u[E].selectionRange,severity:a.DiagnosticSeverity.Error}),u[E]=e):h.push({message:M(u[E],e),range:e.selectionRange,severity:a.DiagnosticSeverity.Error})):u[E]=e,e.kind===a.SymbolKind.Function&&(g[E]=e)}})),null===(l=e.params)||void 0===l||l.map((t=>{var n;null===(n=e.children)||void 0===n||n.unshift(t),t.def=!0,t.kind=a.SymbolKind.TypeParameter,u[E=t.name.toLowerCase()]&&u[E].kind===a.SymbolKind.Function?h.push({message:M(t,u[E]),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}):u[E]=t,t.defaultVal||t.arr?p=!0:p&&h.push({message:d.diagnostic.defaultvalmissing(t.name),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}),m[E]?h.push({message:d.diagnostic.conflictserr("parameter","parameter",t.name),range:t.selectionRange,severity:a.DiagnosticSeverity.Error}):m[E]=t}));for(const t in e.local)u[t]?m[t]&&h.push({message:d.diagnostic.conflictserr("local","parameter",m[t].name),range:e.local[t].selectionRange,severity:a.DiagnosticSeverity.Error}):u[t]=e.local[t];for(const t in e.global)m[t]?h.push({message:d.diagnostic.conflictserr("global","parameter",m[t].name),range:e.local[t].selectionRange,severity:a.DiagnosticSeverity.Error}):(u[t]?(re.declaration[t]=u[t],u[t].kind!==a.SymbolKind.Variable&&(e.global[t]=u[t]),delete u[t]):re.declaration[t]=e.global[t],re.declaration[t].infunc=!0)}for(const t in m)e.local[t]=m[t];for(const t in g)e.local[t]=g[t];e.kind===a.SymbolKind.Method&&m.this&&h.push({message:d.diagnostic.conflictserr("parameter","parameter","this"),range:m.this.selectionRange,severity:a.DiagnosticSeverity.Error})}}function ne(){if(!C)return C=!0;S=R,R=Fe(),c.type="";do{switch(R.type){case"TK_BLOCK_COMMENT":re.addFoldingRange(R.offset,R.offset+R.length,"comment");case"TK_COMMENT":Object.assign(c,R);case"TK_INLINE_COMMENT":R=Fe();break;case"TK_STRING":return-1!==R.content.indexOf("\n")&&re.addFoldingRange(R.offset,R.offset+R.length,"line"),!0;case"TK_EOF":return!1;default:return!0}}while("TK_EOF"!==R.type);return!1}}function ue(e,t,n=0){let o,r,s;if(o=e.match(/^\s*#(include(again)?|dllload)\s+((\*i\s+)?<.+>|(['"]?)(\s*\*i\s+)?.+?\4)?\s*(\s;.*)?$/i)){let e="dllload"===o[1].toLowerCase();s=(o[3]||"").trim(),r=o[4]||o[6],o=s.replace(/%(a_scriptdir|a_workingdir)%/i,re.scriptdir).replace(/%a_linefile%/i,j).replace(/\s*\*i\s+/i,"").replace(/['"]/g,""),t&&re[e?"dlldir":"includedir"].set(re.document.positionAt(t.offset).line,e?q:N),""===o?e?q="":t&&re.addDiagnostic(d.diagnostic.pathinvalid(),t.offset,t.length):u.inBrowser||(e?(0,i.existsSync)(o)&&(0,i.statSync)(o).isDirectory()?q=o.endsWith("/")||o.endsWith("\\")?o:o+"\\":(o.match(/\.\w+$/)||(o+=".dll"),o.includes(":")?re.dllpaths.push(o.replace(/\\/g,"/").toLowerCase()):re.dllpaths.push((q&&(0,i.existsSync)(q+o)?q+o:o).replace(/\\/g,"/").toLowerCase())):t?(o.startsWith("*")?re.addDiagnostic(d.diagnostic.unsupportresinclude(),t.offset,t.length,a.DiagnosticSeverity.Warning):(o=E(o.toLowerCase(),re.libdirs,N))&&(0,i.existsSync)(o.path)?(0,i.statSync)(o.path).isDirectory()?N=o.path:w[o.uri]={path:o.path,raw:s}:r||re.addDiagnostic(o?d.diagnostic.filenotexist(o.path):d.diagnostic.pathinvalid(),t.offset,t.length),0!==n&&re.addDiagnostic(d.diagnostic.unsupportinclude(),t.offset,t.length,a.DiagnosticSeverity.Warning)):(o=E(o.toLowerCase().replace(/(\.d)?>$/,".d>"),re.libdirs,re.scriptpath))&&(0,i.existsSync)(o.path)&&!(0,i.statSync)(o.path).isDirectory()&&(w[o.uri]={path:o.path,raw:s}))}}function fe(e){";"===e.charAt(0)&&(e="\n"+e.replace(/(?<=^[ \t]*);\s*/gm,"")+"\n");let t=e.split(/\r?\n/),n="";return t.slice(1,t.length-1).map((e=>{n+="\n"+e.replace(/^\s*\*/,"").trim()})),n.substring(1)}function he(e,t){return a.Range.create(re.document.positionAt(e),re.document.positionAt(e+t))}function pe(e){let t;for(e&&(e.type="");;){switch(t=Fe(),t.type){case"TK_BLOCK_COMMENT":re.addFoldingRange(t.offset,t.offset+t.length,"comment");case"TK_COMMENT":e&&Object.assign(e,t);case"TK_INLINE_COMMENT":continue;case"TK_STRING":-1!==t.content.indexOf("\n")&&re.addFoldingRange(t.offset,t.offset+t.length,"line")}break}return t}function me(e,t){switch(t.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":return!0;case"TK_OPERATOR":return""===e.type||!t.content.match(/^(!|~|not|in|is|contains|%|\+\+|--)$/i);case"TK_END_BLOCK":case"TK_END_EXPR":return!1;default:switch(e.type){case"TK_COMMA":case"TK_EQUALS":case"":return!0;case"TK_OPERATOR":return!e.content.match(/^(\+\+|--|%)$/);default:return!1}}}function ge(e,t,n,i,o){let r={content:e,type:t,offset:n,length:i,topofline:o};return re.tokens[n]=r,r}function ye(e,t){let n=0;return e&&(n=e.indentation_level,!ve()&&e.line_indent_level>n&&(n=e.line_indent_level)),{mode:t,parent:e,last_text:e?e.last_text:"",last_word:e?e.last_word:"",declaration_statement:!1,multiline_frame:!1,if_block:!1,else_block:!1,try_block:!1,catch_block:!1,finally_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,class_body:!1,indentation_level:n,line_indent_level:e?e.line_indent_level:n,start_line_index:o.length,had_comment:!1,ternary_depth:0}}function be(e=!1){if(o.length)for(_e(o[o.length-1]);e&&o.length>1&&0===o[o.length-1].text.length;)o.pop(),_e(o[o.length-1])}function _e(e,t){for(;e.text.length&&(" "===e.text[e.text.length-1]||e.text[e.text.length-1]===L||e.text[e.text.length-1]===te);)e.text.pop()}function ve(){return 0===o[o.length-1].text.length}function Te(e=!1){if(s.wrap_line_length&&!e){let t=o[o.length-1],n=0;t.text.length>0&&(n=t.text.join("").length+x.length+(U?1:0),n>=s.wrap_line_length&&(e=!0))}(s.preserve_newlines&&$||e)&&!ve()&&Re(!1,!0)}function Re(e=!1,t=!1){if(U=!1,!t&&","!==r.last_text&&"="!==r.last_text&&("TK_OPERATOR"!==K||Me(r.last_text,["++","--","%"])))if("else"===O)for(;r.mode===oe.Statement&&!r.if_block&&!r.do_block&&!r.catch_block;)Pe();else if("finally"===O)for(;!(r.mode!==oe.Statement||r.catch_block||r.try_block||r.else_block&&r.catch_block);)Pe();else for(;r.mode===oe.Statement&&!r.if_block&&!r.do_block&&!r.try_block;)Pe();1===o.length&&ve()||!e&&ve()||(r.multiline_frame=!0,o.push({text:[]}))}function ke(){if(ve()){let e=o[o.length-1];s.keep_array_indentation&&De(r.mode)&&$?(te&&e.text.push(te),Ke(r.parent.mode)?Se(r.parent.indentation_level):Se(r.indentation_level)):(te&&e.text.push(te),Se(r.indentation_level))}}function Se(e){if(o.length>1){let t=o[o.length-1];r.line_indent_level=e;for(let n=0;n<e;n+=1)t.text.push(L)}}function Ce(e=""){e=e||x,ke(),function(){let e=o[o.length-1];if(U&&e.text.length){let t=e.text[e.text.length-1];" "!==t&&t!==L&&e.text.push(" ")}}(),U=!1,o[o.length-1].text.push(e)}function we(){r.indentation_level+=1}function xe(){r.indentation_level>0&&(!r.parent||r.indentation_level>r.parent.indentation_level)&&(r.indentation_level-=1)}function Ee(e){if(e.multiline_frame)return;let t,n=e.start_line_index,i=0;for(;n<o.length;)t=o[n],n++,0!==t.text.length&&(i=te&&t.text[0]===te?1:0,t.text[i]===L&&t.text.splice(i,1))}function Oe(e){r?(C.push(r),_=r):_=ye(null,e),r=ye(_,e)}function De(e){return e===oe.ArrayLiteral}function Ke(e){return Me(e,[oe.Expression,oe.ForInitializer,oe.Conditional])}function Pe(){C.length>0&&(_=r,r=C.pop(),_.mode===oe.Statement&&Ee(_))}function Ae(){return r.parent.mode===oe.ObjectLiteral&&r.mode===oe.Statement&&":"===r.last_text&&0===r.ternary_depth}function Le(){return"TK_RESERVED"===K&&!$&&Me(r.last_text,["local","static","global"])&&"TK_WORD"===D||"TK_RESERVED"===K&&r.last_text.match(/^loop|try|catch|finally$/i)||"TK_RESERVED"===K&&r.last_text.match(/^return$/i)&&!$||"TK_RESERVED"===K&&r.last_text.match(/^(else|until)$/i)&&("TK_RESERVED"!==D||"if"!==O)||"TK_END_EXPR"===K&&(_.mode===oe.ForInitializer||_.mode===oe.Conditional)||"TK_WORD"===K&&r.mode===oe.BlockStatement&&!r.in_case&&!Me(D,["TK_WORD","TK_RESERVED","TK_START_EXPR"])&&!Me(x,["--","++","%","::"])||r.mode===oe.ObjectLiteral&&":"===r.last_text&&0===r.ternary_depth?(Oe(oe.Statement),we(),"TK_RESERVED"===K&&Me(r.last_text,["local","static","global"])&&"TK_WORD"===D&&(r.declaration_statement=!0),Ae()||Te("TK_RESERVED"===D&&"try"!==r.last_text&&Me(O,["loop","for","if","while"])),!0):("=>"===x&&(Oe(oe.Statement),we(),r.declaration_statement=!0),!1)}function Ne(e){return Me(e.toLowerCase(),["return","loop","if","throw","else"])}function Me(e,t){for(let n=0;n<t.length;n+=1)if(t[n]===e)return!0;return!1}function Ie(e){let t=F,i=e.length,o=n.substr(t,i),r=o.charAt(0);for(;Me(r,T)&&o!==e;){if(t++,t>=X)return!1;o=n.substr(t,i),r=o.charAt(0)}return o===e}function qe(e){let t=n.indexOf("\n",e);-1===t&&(t=X);let i=n.substring(F,t).trim();De(r.mode)||0===i.length||Z>0||i.match(/^([;#]|\/\*|(and|or|is|in)\b)/i)||!i.match(/^(\+\+|--|!|~|%)/)&&Me(i.charAt(0),R)||(V=!1,Pe(),Ee(_),K="TK_END_EXPR",r.last_text=")")}function Fe(){let e,t=0===F;if(Q=0,F>=X)return{content:"",type:"TK_EOF",offset:X,length:0,topofline:!0};let i=n.charAt(F);for($=!1,ee=[],F+=1;Me(i,T);){if("\n"===i?(J=F-1,V&&qe(F),Q+=1,H=!0,ee=[]):Q&&(i===L?ee.push(L):"\r"!==i&&ee.push(" ")),F>=X)return ne=ge("","TK_EOF",X-1,0,!0);i=n.charAt(F),F+=1}let o,r=F-1,s=1,c=re.tokens[r];if(c&&c.length)return F=r+c.length,H=!1,c;if(H){H=!1,t=!0;let e=n.indexOf("\n",F);-1===e&&(e=X);let i=n.substring(J+1,e).trim();if(-1===i.indexOf("::")){if((o=i.match(/^(([^\x00-\x7f]|\w)+):\s*(\s;.*)?$/))&&(!ne.type.match(/(TK_OPERATOR|TK_COMMA|TK_START_EXPR)/)||ne.content.match(/^(\+\+|--)$/)))return F+=o[1].length+1,ne=ge(o[1]+":","TK_LABEL",r,o[1].length+1,!0)}else{if(o=i.match(/^(:(\s|\*|\?0?|c[01]?|[pk]\d+|s[ipe]|[brto]0?|x|z)*:[\x09\x20-\x7E]+?::)(.*)$/i))return o[2]&&o[2].match(/[xX]/)||void 0!==o[3]&&o[3].trim().match(/^\{?\s*(\s;.*)?$/)?(F+=o[1].length-1,ne=ge(o[1],"TK_HOT",r,o[1].length,!0)):(J=e,F+=o[1].length-1,H=!0,ne=ge(o[1],"TK_HOTLINE",r,o[1].length,!0));if(o=i.match(/^(((([<>$~*!+#^]*?)(`;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))|(`;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f])\s*&\s*~?(`;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))(\s+up)?\s*::)(.*)$/i))return o[9].trim().match(/^([<>~*!+#^])(`{|[\x21-\x7A\x7C-\x7E]|[a-z]\w+|[^\x00-\x7f])\s*(\s;.*)?$/i)?(J=e,H=!0,F=n.indexOf("::",F)+o[9].length-o[9].trimLeft().length+2,ne=ge(o[1].replace(/\s+/g," "),"TK_HOTLINE",r,o[1].length,!0)):(F=n.indexOf("::",F)+2,ne=ge(o[1].replace(/\s+/g," "),"TK_HOT",r,o[1].length,!0));if(o=i.match(/^(\S+):\s*(\s;.*)$/))return F+=o[1].length+1,ne=ge(o[1]+":","TK_LABEL",r,o[1].length+1,!0)}}if(b(n.charCodeAt(F-1))){for(;F<X&&b(n.charCodeAt(F));)i+=n.charAt(F),F+=1;if("."!==n.charAt(r-1)){if(o=i.match(/^(\d+[Ee](\d+)?|(0[Xx][\da-fA-F]+)|(\d+))$/)){if(o[2]||o[3])return ne=ge(i,"TK_NUMBER",r,i.length,t),ne.semantic={type:h.number},ne;if(o[4]){if(F<X&&"."===n.charAt(F)){let e="",o="",a=F+1;for(;a<X&&b(n.charCodeAt(a));)e+=n.charAt(a),a+=1;if(e.match(/^\d*([Ee]\d+)?$/))return i+="."+e,F=a,ne=ge(i,"TK_NUMBER",r,i.length,t),ne.semantic={type:h.number},ne;if(e.match(/^\d*[Ee]$/)&&a<X&&n.charAt(a).match(/[+\-]/)){for(e+=n.charAt(a),a+=1;a<X&&b(n.charCodeAt(a));)o+=n.charAt(a),a+=1;o.match(/^\d+$/)&&(i+="."+e+o,F=a)}}return ne=ge(i,"TK_NUMBER",r,i.length,t),ne.semantic={type:h.number},ne}if(F<X&&n.charAt(F).match(/[+\-]/)){let e,o=n.charAt(F),a=F;if(F+=1,e=Fe(),"TK_NUMBER"===e.type&&e.content.match(/^\d+$/))return i+=o+e.content,ne=ge(i,"TK_NUMBER",r,i.length,t),ne.semantic={type:h.number},ne;F=a}}if(Me(i.toLowerCase(),S)){if(i.match(/^(and|or|not|in|is|contains)$/i))return ne=ge(i,"TK_OPERATOR",r,i.length,t);if(t||"class"!==i.toLowerCase())return ne=ge(i,"TK_RESERVED",r,i.length,t)}}return ne=ge(i,"TK_WORD",r,i.length,t)}if("("===i||"["===i){if("("===i)if(V&&Z++,G)G++;else if(t){let e=F,i="";for(;e<X;){if(i=n.charAt(e),e++,"\n"===i){t=!1,F=e-1,G=1;break}if(")"===i)break}}return ne=ge(i,"TK_START_EXPR",r,1,t)}if(")"===i||"]"===i)return")"===i&&(V&&Z--,G>0&&G--),ne=ge(i,"TK_END_EXPR",r,1,t);if("{"===i)return ne=ge(i,"TK_START_BLOCK",r,1,t);if("}"===i)return ne=ge(i,"TK_END_BLOCK",r,1,t);if(";"===i){V&&qe(n.indexOf("\n",F));let e,o="",s=t?"TK_COMMENT":"TK_INLINE_COMMENT";for(;F<=X&&("\n"!=i||t&&Ie(";")&&!Ie("\n"));)o+=i,i=n.charAt(F),F+=1;if("\n"===i&&(F--,J=F),o=o.trimRight(),re.blocks){let n;if(t&&(e=o.match(/^;(;|\s*#)((end)?region\b)?/i)))e[3]?void 0!==(e=W.region.pop())&&re.addFoldingRange(e,r,"line"):(e[2]&&W.region.push(r),re.blocks.push(a.DocumentSymbol.create(o.replace(/^;(;|\s*#)((end)?region\b)?\s*/i,"")||o,void 0,a.SymbolKind.Module,n=he(r,o.length),n))),s="";else if(e=o.match(/^;+\s*([{}])/))"}"===e[1]?void 0!==(e=W.bracket.pop())&&re.addFoldingRange(e,r,"line"):W.bracket.push(r),s="";else if(e=o.match(/^;(\s*~?\s*)todo(:?\s*)(.*)/i))re.blocks.push(a.DocumentSymbol.create("TODO: "+e[3].trim(),void 0,a.SymbolKind.Module,n=he(r,o.length),n));else if(o.match(/^;@include\s/i)&&(e=o.match(/^[ \t]*;@include[ \t]+(<.+>|(['"]?).+?\2)[ \t]*([ \t];.*)?$/gim)))for(i of e)ue("#"+i.trim().substring(2))}return re.strcommpos.push({start:r,end:F,type:1}),ge(o,s,r,o.length,t)}if("'"===i||'"'===i){let o=i,a=!1,c=0,l=0,u="",f="",h="";if(e=i,F<X)for(;h=i,(i=n.charAt(F))!==o||a;){if(e+=i,G);else{if("\n"===i){for(J=n.indexOf("\n",l=F+1),u=n.substring(l,-1===J?F=X:(F=J)+1),c=F;""===(f=u.trim())||f.startsWith(";")||f.startsWith("/*");){if(f&&(f.startsWith(";")?e+=u:(F=l,H=!0,e+=u.substring(0,u.indexOf("/*")),e+=Fe().content+("\r\n"===u.slice(-2)?"\r\n":"\n"))),l=F+1,F=n.indexOf("\n",l),-1===F)return e+=n.substring(l,F=X),re.strcommpos.push({start:r,end:c,type:2}),s=e.trimRight().length,re.blocks&&re.addDiagnostic(d.diagnostic.missing(o),r,s),ne=ge(e,"TK_STRING",r,s,t);J=F,u=n.substring(l,F+1)}let i,a=u.match(/^(\s*)\(/);if(!a)return F=-1,s=e.trimRight().length,re.blocks&&re.addDiagnostic(d.diagnostic.missing(o),r,s),re.strcommpos.push({start:r,end:-1===c?X:c-1,type:2}),F=r+s,ne=ge(e=e.trimRight(),"TK_STRING",r,s,t);for(a=a[1];0!==u.trim().indexOf(")");){if(e+=u,l=F+1,F=n.indexOf("\n",l),-1===F)return u=n.substring(l,X),i=new RegExp("^\\s*\\)([^`"+o+"]|`.)*"+o).exec(u),i?(F=l+i[0].length,e+=i[0]):(e+=n.substring(l,F=X),re.blocks&&re.addDiagnostic(d.diagnostic.missing(o),r,1)),re.strcommpos.push({start:r,end:F-1,type:3}),ne=ge(e,"TK_STRING",r,F-r,t);J=F,u=n.substring(l,F+1)}return i=new RegExp("^\\s*\\)([^`"+o+"]|`.)*"+o).exec(u),i?F=l+i[0].length:(F=X+1,re.blocks&&re.addDiagnostic(d.diagnostic.missing(o),r,1)),e+=a+n.substring(l,F).trim(),re.strcommpos.push({start:r,end:F-1,type:3}),ne=ge(e,"TK_STRING",r,F-r,t)}if(";"===i&&(" "===h||"\t"===h)){for(F+=1;F<X&&"\n"!==(i=n.charAt(F));)e+=i,F++;F-=1}}if(a=!a&&"`"===i,F+=1,F>=X)return re.blocks&&re.addDiagnostic(d.diagnostic.missing(o),r,1),re.strcommpos.push({start:r,end:X,type:2}),ne=ge(e,"TK_STRING",r,F-r,t)}else re.blocks&&re.addDiagnostic(d.diagnostic.missing(o),r,1);if(F+=1,e+=o,re.strcommpos.push({start:r,end:F-1,type:2}),G&&re.blocks){let t=0,n=0;for(;-1!==(n=e.substring(t).search(/(?<=^[ \t]*)\)/m));)re.addDiagnostic(d.diagnostic.unexpected(")"),r+t+n,1),t=t+n+1}return ne=ge(e,"TK_STRING",r,F-r,t)}if("#"===i){let e="#";if(i=n.charAt(F),F<X&&!Me(i,T)){for(;F<X&&!Me(i=n.charAt(F),T);)e+=i,F+=1;if((" "===i||"\t"===i)&&e.match(/#(dllload|dllimport|definedefault|hotstring|include|requires|errorstdout|WarnContinuableException|WindowClass)/i)){let t=n.indexOf("\n",F);-1===t&&(t=X),e+=" "+n.substring(F,t).trim(),J=F=t}return ne=t?ge(e,"TK_SHARP",r,F-r,!0):ge(e,"TK_UNKNOWN",r,F-r,!1)}}if("."===i){let e=n.charAt(F);if("="===e)return F++,ne=ge(".=","TK_EQUALS",r,2,t);if(Me(n.charAt(F-2),T)&&Me(e,T))return ne=ge(i,"TK_OPERATOR",r,1,t);if(e.match(/\d/)&&("TK_EQUALS"===ne.type||"TK_OPERATOR"===ne.type)){let o=F+1,a="";for(;o<X&&b(n.charCodeAt(o));)e+=n.charAt(o),o+=1;if(e.match(/^\d+([Ee]\d+)?$/))return F=o,i+=e,ne=ge("0"+i,"TK_NUMBER",r,i.length,t),ne.semantic={type:h.number},ne;if(o<X&&e.match(/^\d+[Ee]$/)&&n.charAt(o).match(/[+\-]/)){for(e+=n.charAt(o),o+=1;o<X&&b(n.charCodeAt(o));)a+=n.charAt(o),o+=1;if(a.match(/^\d+$/))return F=o,i+=e+a,ne=ge("0"+i,"TK_NUMBER",r,i.length,t),ne.semantic={type:h.number},ne}}return ne=ge(i,""===e||Me(e,T)?"TK_UNKNOWN":"TK_DOT",r,1,t)}if("/"===i&&t&&"*"===n.charAt(F)){F+=1;let e=n.indexOf("\n",F),i=0,o="TK_COMMENT",a=null;for(;-1!==e&&!(a=n.substring(F,e).match(/(^\s*\*\/)|(\*\/\s*$)/));)J=e,e=n.indexOf("\n",F=e+1),i++;return i&&(o="TK_BLOCK_COMMENT",a&&a[1])?(F=n.indexOf("*/",J)+2,re.strcommpos.push({start:r,end:F,type:1}),ge(n.substring(r,F),o,r,F-r,t)):-1===e?(F=X,re.strcommpos.push({start:r,end:X,type:1}),ge(n.substring(r,X),o,r,X-r,t)):(F=e,re.strcommpos.push({start:r,end:e-1,type:1}),ge(n.substring(r,e).trimRight(),o,r,e-r,t))}if(Me(i,R)){for(;F<X&&Me(i+n.charAt(F),R)&&(i+=n.charAt(F),F+=1,!(F>=X)););return ne=","===i?ge(i,"TK_COMMA",r,1,t):ge(i,i.match(/([:.+\-*/|&^]|\/\/|>>|<<)=/)?"TK_EQUALS":"TK_OPERATOR",r,i.length,t)}return"`"===i?(F<X&&(i+=n.charAt(F),F++),ne=ge(i,"TK_WORD",r,2,t)):ne=ge(i,"TK_UNKNOWN",r,i.length,t)}function je(){let e=!0;if(Le())switch(r.last_word){case"try":!$&&Me(O,["if","while","loop","for"])&&Pe();case"if":case"catch":case"finally":case"else":case"while":case"loop":case"for":r.declaration_statement=!0}else!$||Ke(r.mode)||"TK_OPERATOR"===K&&!Me(r.last_text,["--","++","%"])||"TK_EQUALS"===K||!s.preserve_newlines&&"TK_RESERVED"===K&&Me(r.last_text,["local","static","global","set","get"])||(Re(),e=!1);if(r.do_block&&!r.do_while){if("TK_RESERVED"===K&&r.last_text.match(/^until$/i))return U=!0,Ce(),U=!0,void(r.do_while=!0);r.do_block=!1,r.else_block||"TK_RESERVED"!==D||"else"!==O||(r.else_block=!0)}if(r.if_block)if(r.else_block||"TK_RESERVED"!==D||"else"!==O){if("if"!==O||"else"!==P)for(;r.mode===oe.Statement;)Pe();r.if_block=r.else_block=!1}else r.else_block=!0,r.if_block=!1;else if(r.try_block)if(r.catch_block||"TK_RESERVED"!==D||"catch"!==O)if(r.finally_block||"TK_RESERVED"!==D||"finally"!==O){for(;r.mode===oe.Statement;)Pe();r.try_block=r.catch_block=!1}else r.finally_block=!0,r.try_block=!1;else r.catch_block=!0,r.try_block=!1;else r.catch_block&&"TK_RESERVED"===D&&("else"===O?r.else_block=!0:"finally"===O&&(r.finally_block=!0,r.catch_block=!1));if((r.in_case_statement||"BlockStatement"===r.mode&&"switch"===r.last_word)&&("case"===O&&"TK_RESERVED"===D||"default"===O))return Re(),r.case_body&&(xe(),r.case_body=!1),Ce(),r.in_case=!0,void(r.in_case_statement=!0);if("TK_COMMA"!==K&&"TK_START_EXPR"!==K&&"::"!==r.last_text||Ae()||Te(),v="NONE","TK_END_BLOCK"===K?z||r.had_comment||"TK_RESERVED"!==D||!Me(O,["else","until","catch","finally"])||"expand"===s.brace_style||"end-expand"===s.brace_style?v="NEWLINE":(v="SPACE",U=!0,"else"!==O||"switch"!==r.last_word||ve()||Re()):"TK_STRING"===K?v="SPACE":"TK_RESERVED"===K||"TK_WORD"===K?P.match(/^:[^:xX]*[xX]/)||(v="SPACE"):"TK_START_BLOCK"===K?v="NEWLINE":"TK_END_EXPR"===K?(U=!0,v="NEWLINE"):Q&&(v="NEWLINE"),"TK_RESERVED"===D&&Me(O,k)&&")"!==r.last_text&&("if"===O&&"else"===P&&ve()&&o.pop(),r.last_text.match(/^else$/i)||"try"===r.last_text&&Me(O,["if","while","loop","for","return"])?v="SPACE":Q&&"::"!==r.last_text&&(v="NEWLINE")),"TK_RESERVED"===D&&Me(O,["else","until","catch","finally"]))if(z||"TK_END_BLOCK"!==K||"expand"===s.brace_style||"end-expand"===s.brace_style)e&&Re();else if("else"===O&&r.last_word.match(/^(if|loop|for|while|catch)$/)||"until"===O&&"loop"===r.last_word||"catch"===O&&"try"===r.last_word||"finally"===O&&r.last_word.match(/^(catch|try)$/i)){if(ve())"}"!==r.last_text||r.had_comment||be(!0);else{let e=o[o.length-1];"}"!==e.text[e.text.length-1]&&Re()}U=!0}else Pe();else"NEWLINE"===v?r.had_comment?Re():"TK_RESERVED"===K&&Ne(r.last_text)?U=!0:"TK_END_EXPR"!==K?"TK_START_EXPR"===K&&"TK_RESERVED"===D&&Me(O,["local","static","global"])||!(":"!==r.last_text||r.case_body&&0===r.ternary_depth)||("TK_RESERVED"===D&&"if"===O&&r.last_word.match(/^else$/i)&&"{"!==r.last_text?U=!0:Re()):"TK_RESERVED"===D&&Me(O,k)&&")"!==r.last_text&&Re():"SPACE"===v?U=!0:De(r.mode)&&ve()&&ke();if("NONE"===v&&!ve()&&r.had_comment&&Re(),Ce(),r.last_word=x.toLowerCase(),"TK_RESERVED"===D)switch(O){case"loop":r.do_block=!0;break;case"if":r.if_block=!0;break;case"try":r.try_block=!0;break;case"else":U=!0}}function We(){D="TK_WORD",je()}function $e(){!$||"TK_HOTLINE"!==K&&ve()||Re(1===Q),Ce(),"TK_HOTLINE"===D&&(o[o.length-1].text.push(n.substring(F,J=J>-1?J:X).trimRight()),F=J+1),Re()}this.document=e,this.scriptpath=(j=c.URI.parse(this.uri=e.uri.toLowerCase()).fsPath).replace(/\\[^\\]+$/,""),this.initlibdirs(),oe={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},ie={TK_START_EXPR:function(){if(Le())switch(r.last_word){case"try":!$&&Me(O,["if","while","loop","for"])&&Pe();case"if":case"catch":case"finally":case"else":case"while":case"loop":case"for":r.declaration_statement=!0}let e=oe.Expression;if("["===x){if("TK_WORD"===K||")"===r.last_text)return"TK_RESERVED"===K&&Me(r.last_text,k)&&(U=!0),Oe(e),Ce(),we(),void(s.space_in_paren&&(U=!0));e=oe.ArrayLiteral,De(r.mode)&&("["!==r.last_text&&(","!==r.last_text||"]"!==A&&"}"!==A)||s.keep_array_indentation||Re())}else"TK_RESERVED"===K&&Me(r.last_text,["for","loop"])?e=oe.ForInitializer:"TK_RESERVED"===K&&Me(r.last_text,["if","while"])&&(e=oe.Conditional);"TK_START_BLOCK"===K?Re():"TK_END_EXPR"===K||"TK_START_EXPR"===K||"TK_END_BLOCK"===K||"."===r.last_text?Te($):"TK_RESERVED"===K&&"("===x||"TK_WORD"===K&&!r.last_text.match(/^#[a-z]+/i)||"TK_OPERATOR"===K?"TK_RESERVED"===K&&(Me(r.last_text,k)||r.last_text.match(/^catch$/i))&&s.space_before_conditional&&(U=!0):U=!0,"("===x&&("TK_EQUALS"===K||"TK_OPERATOR"===K?Ae()||Te():"TK_END_EXPR"===K?U=Me(n.charAt(F-2),[" ","\t"]):"TK_WORD"===K?F>1&&Me(n.charAt(F-2),[" ","\t"])&&(U=!0):"until"===r.last_text?U=!0:"TK_RESERVED"===K&&r.last_text.match(/^(break|continue)$/i)&&(U=!1),F!==Y.offset+1&&(x+=n.substring(Y.offset+1,F).trimRight())),$&&Re(),Oe(e),Ce(),s.space_in_paren&&(U=!0),we()},TK_END_EXPR:function(){for(;r.mode===oe.Statement;)Pe();r.multiline_frame&&Te("]"===x&&De(r.mode)&&!s.keep_array_indentation),s.space_in_paren&&("TK_START_EXPR"!==K||s.space_in_empty_paren?U=!0:(be(),U=!1)),Pe(),Ce(),Ee(_),r.do_while&&_.mode===oe.Conditional&&(_.mode=oe.Expression,r.do_block=!1,r.do_while=!1)},TK_START_BLOCK:function(){V&&(V=!1,Pe(),Ee(_),K="TK_END_EXPR",r.last_text=")"),Oe(oe.BlockStatement),_.in_case_statement&&":"===_.last_text&&(r.indentation_level-=1),"expand"===s.brace_style?"TK_OPERATOR"!==K&&("TK_EQUALS"===K||"TK_RESERVED"===K&&Ne(r.last_text)&&"else"!==r.last_text)?U=!0:Re(!1,!0):"TK_UNKNOWN"===K||"TK_HOTLINE"===K||("TK_OPERATOR"!==K&&"TK_START_EXPR"!==K?$||"TK_START_BLOCK"===K?Re():U=!0:De(_.mode)&&","===r.last_text&&("}"===A?U=!0:Re())),Ce(),we()},TK_END_BLOCK:function(){for(;r.mode===oe.Statement;)Pe();let e=!1;if("TK_START_BLOCK"===K){let t=o[o.length-1].text,n=t.length-2;for(z=!1;n>0;){if(" "!==t[n]&&"\t"!==t[n]){[":=",",",":","[","("].includes(t[n])&&(e=!0,z=!0);break}n--}}else z=r.mode===oe.ObjectLiteral;"expand"===s.brace_style?e||Re():e||(De(r.mode)&&s.keep_array_indentation?(s.keep_array_indentation=!1,Re(),s.keep_array_indentation=!0):$||r.mode!==oe.ObjectLiteral||!B?Re():Ce(" ")),Pe(),Ce(),r.in_case_statement&&":"===r.last_text&&o[o.length-1].text.shift()},TK_WORD:je,TK_RESERVED:je,TK_STRING:function(){Le()?U=!0:"TK_RESERVED"===K||"TK_WORD"===K?($&&Re(),U=!0):"TK_COMMA"===K||"TK_START_EXPR"===K||"TK_EQUALS"===K||"TK_OPERATOR"===K?Ae()||Te():(($||"{"===r.last_text)&&Re(),U=!0),Ce()},TK_EQUALS:function(){Le(),U=!0,Ce(),U=!0},TK_OPERATOR:function(){if(":"===x&&0===r.ternary_depth&&!r.in_case&&r.mode===oe.BlockStatement&&"{"===A){r.mode=oe.ObjectLiteral,B=!0;let e=F-1,t="";for(;e>=0&&"{"!==(t=n.charAt(e));){if("\n"===t){B=!1;break}e--}if(B&&o.length>1){let e=o.pop();o[o.length-1].text.push(" ",null==e?void 0:e.text.join("").trim())}}if(Le()&&"%"===x)switch(r.last_word){case"try":!$&&Me(O,["if","while","loop","for"])&&Pe();case"if":case"catch":case"finally":case"else":case"while":case"loop":case"for":r.declaration_statement=!0}let e=!0,i=!0;if("TK_RESERVED"===K&&Ne(r.last_text))return U=!0,void Ce();if(":"===x&&r.in_case){r.case_body=!0,we(),Ce();let e=F,t="";for(;e<X&&Me(t=n.charAt(e),[" ","\t"]);)e++;return F=e,"\r"==t||"\n"==t?Re():";"==t||(U=!0),void(r.in_case=!1)}if("::"!==x){if(!$||"--"!==x&&"++"!==x||Re(!1,!0),"TK_OPERATOR"===K&&Te(),Me(x,["--","++","!","%"])||Me(x,["-","+"])&&(Me(K,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||Me(r.last_text,k)||","===r.last_text)){if(e="!"===x&&Me(K,["TK_WORD","TK_RESERVED"]),i=!1,"TK_RESERVED"===K&&(e=!0),"%"===x)return Me(n.charAt(F-2),[" ","\t"])&&(e=!0),Me(n.charAt(F),[" ","\t"])&&(i=!0),$?(U=!1,Re(!1,r.declaration_statement)):U=U||e,Ce(),void(U=i);U||"++"!==x&&"--"!==x||(i=!0),r.mode!==oe.BlockStatement&&r.mode!==oe.Statement||"{"!==r.last_text||Re()}else if(":"===x)0===r.ternary_depth?(r.mode===oe.BlockStatement&&(r.mode=oe.ObjectLiteral),e=!1):r.ternary_depth-=1;else if("?"===x)if(r.ternary_depth+=1,r.indentation_level){if(o.length){let e=o[o.length-1].text;e[r.indentation_level-(e[0]===te?0:1)]===L&&we()}}else we();else"&"===x?("TK_WORD"!==K&&"TK_END_EXPR"!==K&&(i=!1),"TK_COMMA"!==K&&"TK_START_EXPR"!==K||(e=!1)):"*"===x?"("===r.last_text||"TK_WORD"===K&&(Ie(")")||Ie("]"))?e=i=!1:","===r.last_text&&(i=!1):"{"===r.last_text&&t.allIdentifierChar.test(x)?e=!1:("~"===x||le&&r.mode===oe.Statement&&"TK_WORD"===K&&("-"===x||"+"===x))&&(i=!1);$?(U=!1,Re(!1,!0)):U=U||e,Ce(),U=i}else Ce()},TK_COMMA:function(){if(r.declaration_statement)return $&&Re(!1,!0),ce&&(U=!0),Ce(),U=!0,ce=!1,void xe();if("TK_END_BLOCK"===K&&r.mode!==oe.Expression)Ce(),r.mode===oe.ObjectLiteral&&"}"===r.last_text?Re():U=!0;else if(r.mode===oe.ObjectLiteral||r.mode===oe.Statement&&r.parent.mode===oe.ObjectLiteral){let e=r.had_comment;if(r.mode===oe.Statement&&Pe(),e){let e=o[o.length-1].text,t=[];if(e.length&&";"===e[e.length-1].charAt(0)){for(t.push(e.pop());e.length>0&&Me(e[e.length-1],["\t"," "]);)t.unshift(e.pop());U=!1}Ce(),e.push(...t),t.length?Re():U=!0}else Ce(),Ie(";")?(Ce("\t"),Ce(Fe().content),Re()):B?U=!0:Re()}else $&&Re(),ce&&(U=!0),Ce(),U=!0;ce=!1},TK_BLOCK_COMMENT:function(){let e,t,n=function(e){let t=[],n=(e=e.replace(/\x0d/g,"")).indexOf("\n");for(;-1!==n;)t.push(e.substring(0,n)),n=(e=e.substring(n+1)).indexOf("\n");return e.length&&t.push(e),t}(x),i=!n[0].match(/^\/\*(@ahk2exe-keep|[^*]|$)/i),r="";for(!i&&(e=n[n.length-1].match(/^(\s)\1*/))&&" "!==e[0]&&(r=new RegExp(`^${e[1]}{1,${e[0].length}}`)),Re(),Ce(n[0]),t=1;t<n.length-1;t++)if(Re(!1,!0),i)Ce(" * "+n[t].replace(/^[\s\*]+|\s+$/g,""));else{let e=n[t].trimRight().replace(r,"");e?Ce(e):(ke(),o[o.length-1].text.push(""))}n.length>1&&(Re(!1,!0),Ce(" "+n[n.length-1].replace(/^\s+|\s+$/g,""))),Re(!1,!0)},TK_INLINE_COMMENT:function(){U=!1,o[o.length-1].text.push("\t"),Ce(),Re(!1,!0),U=!0},TK_COMMENT:function(){var e;if($&&Re(),"TK_COMMENT"===D&&x.includes("\n")){let t=x.split("\n");Ce((null===(e=t.shift())||void 0===e?void 0:e.trim())||""),t.map((e=>{Re(!1,!0),Ce(e.trim())}))}else Ce()},TK_DOT:function(){Le(),"TK_RESERVED"===K&&Ne(r.last_text)?U=!0:Te(")"===r.last_text&&s.break_chained_methods),Ce()},TK_HOT:We,TK_SHARP:We,TK_NUMBER:We,TK_LABEL:function(){if("default:"===O&&(r.in_case_statement||"BlockStatement"===r.mode&&"switch"===r.last_word))return r.case_body&&(xe(),r.case_body=!1),O="default",x=x.substr(0,x.length-1),D="TK_WORD",F=Y.offset+7,Re(),Ce(),r.in_case=!0,void(r.in_case_statement=!0);Re(),Ce();let e=o[o.length-1].text;""===e[0].trim()?o[o.length-1].text=e.slice(1):we(),x="::"},TK_HOTLINE:$e,TK_UNKNOWN:$e},this.get_tokon=function(e,t=!1){let n,i=F;if(void 0!==e){F=e;do{n=Fe()}while(t&&n.type.endsWith("COMMENT"));F=i}else do{n=Fe()}while(t&&n.type.endsWith("COMMENT"));return n},this.beautify=function(e){let t,i,a,c=!1;for(re.isparsed||re.parseScript(),s={},ne={type:"",content:"",offset:0,length:0},void 0!==(e=e||{}).braces_on_own_line&&(s.brace_style=e.braces_on_own_line?"expand":"collapse"),s.brace_style=e.brace_style?e.brace_style:s.brace_style?s.brace_style:"collapse","expand-strict"===s.brace_style&&(s.brace_style="expand"),s.indent_size=e.indent_size?parseInt(e.indent_size,10):4,s.indent_char=e.indent_char?e.indent_char:" ",s.preserve_newlines=void 0===e.preserve_newlines||e.preserve_newlines,s.break_chained_methods=void 0!==e.break_chained_methods&&e.break_chained_methods,s.max_preserve_newlines=void 0===e.max_preserve_newlines?0:parseInt(e.max_preserve_newlines,10),s.space_in_paren=void 0!==e.space_in_paren&&e.space_in_paren,s.space_in_empty_paren=void 0!==e.space_in_empty_paren&&e.space_in_empty_paren,s.keep_array_indentation=void 0!==e.keep_array_indentation&&e.keep_array_indentation,s.space_before_conditional=void 0===e.space_before_conditional||e.space_before_conditional,s.wrap_line_length=void 0===e.wrap_line_length?0:parseInt(e.wrap_line_length,10),e.indent_with_tabs&&(s.indent_char="\t",s.indent_size=1),L="";s.indent_size>0;)L+=s.indent_char,s.indent_size-=1;K="TK_START_BLOCK",A="",o=[{text:[]}],U=!1,C=[],r=null,Oe(oe.BlockStatement),te="";let l=this.document.getText();for(;l&&(" "===l.charAt(0)||"\t"===l.charAt(0));)te+=l.charAt(0),l=l.substring(1);for(n=l,X=n.length,ee=[],V=!1,H=!0,Z=0,F=0,J=-1;;){if(Y=Fe(),x=Y.content,O=x.toLowerCase(),(D=Y.type)||(D="/"===x.charAt(0)?"TK_BLOCK_COMMENT":Y.topofline?"TK_COMMENT":"TK_INLINE_COMMENT"),"TK_EOF"===D){for(;r.mode===oe.Statement;)Pe();break}if(i=s.keep_array_indentation&&De(r.mode),$=Q>0,i)for(t=0;t<Q;t+=1)Re(t>0);else if(s.max_preserve_newlines&&Q>s.max_preserve_newlines&&(Q=s.max_preserve_newlines),s.preserve_newlines&&Q>1)for(Re(!1,!0),t=1;t<Q;t+=1)Re(!0,!0);if(le=c,c){if(c=!1,Me(r.mode,[oe.BlockStatement,oe.Statement]))if("TK_DOT"===D&&"TK_WORD"===K)c=!0;else if("TK_WORD"===D)if(Y.topofline)c=!0;else switch(K){case"TK_START_BLOCK":c=!0;break;case"TK_WORD":"::"===r.last_text.slice(-2)&&(c=!0);break;case"TK_RESERVED":r.last_text.match(/^(try|else|finally)$/i)&&(c=!0)}else"TK_COMMA"===D&&(ce=!0)}else(Y.topofline&&Me(r.mode,[oe.Statement,oe.BlockStatement])&&Me(D,["TK_WORD","TK_START_BLOCK","TK_HOT","TK_SHARP"])||"TK_RESERVED"===D&&x.match(/^(try|else|finally)$/i))&&(c=!0);if(ie[D](),"TK_INLINE_COMMENT"!==D&&"TK_COMMENT"!==D&&"TK_BLOCK_COMMENT"!==D){if(!V&&"TK_RESERVED"===D&&Me(O,["if","for","while","loop","catch","switch"])){if(U=!0,V=!0,Z=0,A=x,r.last_text="(",K="TK_START_EXPR","switch"===O){Oe(oe.Conditional),r.had_comment=!1;continue}Me(O,["if","while"])?Oe(oe.Conditional):Oe(oe.ForInitializer),we()}else A=r.last_text,K=D,r.last_text=x.toLowerCase();r.had_comment=!1,P=O}else r.had_comment=D.endsWith("_COMMENT")}a=o[0].text.join("");for(let e=1;e<o.length;e++)a+="\n"+o[e].text.join("");return a=a.replace(/[\r\n ]+$/,""),a},e.uri.match(/\.d\.(ahk2?|ah2)(?=(\?|$))/i)?(this.d=1,this.parseScript=function(t=!1){var i,o,r,s,c,l,d,f;n=this.document.getText(),X=n.length,N=this.scriptpath,se.length=0,ee=[],ne={type:"",content:"",offset:0,length:0},V=!1,H=!0,Z=0,F=0,J=-1;let m,b,_="",v=0,T=0,R=0,k=!1;this.tokens={},this.children.length=this.foldingranges.length=this.diagnostics.length=0,this.reflat=!0,this.declaration={},this.blocks=[],this.strcommpos.length=0,W={region:[],bracket:[]};let S,C=0,w=[],x=[],E=[a.DocumentSymbol.create("",void 0,a.SymbolKind.Namespace,S=he(0,0),S,this.children)];for(E[0].declaration=this.declaration;Fe().length;)continue;w=Object.values(this.tokens),R=w.length;e:for(;v<R;)switch((m=w[v]).type){case"TK_COMMENT":case"TK_BLOCK_COMMENT":v++;continue e;case"TK_WORD":if(T=v+1,T<R)if(C&&((b=w[T]).topofline||"=>"===b.content||"["===b.content)){let t=y.create(m.content,a.SymbolKind.Property,S=he(m.offset,m.length),S);m.semantic={type:h.property,modifier:1<<p.definition|1<<p.readonly|(k?1<<p.static:0)},null===(i=E[C].children)||void 0===i||i.push(t),t.static=k,t.full=`(${x.join(".")}) `+t.name,k&&C?E[C].staticdeclaration[t.name.toLowerCase()]=t:E[C].declaration[t.name.toLowerCase()]=t,w[v-(k?2:1)].type.endsWith("COMMENT")&&(t.detail=fe(w[v-(k?2:1)].content));let n=[];if("["===b.content){for(;"]"!==(b=w[++T]).content;)"TK_WORD"===b.type&&n.push(y.create(b.content,a.SymbolKind.Variable,S=he(b.offset,b.length),S));b=w[++T]}if(t.full=`(${x.join(".")}) `+t.name,"{"===b.content)for(t.children=[];"}"!==(m=w[++T]).content;)if("=>"===m.content){let i,s=g.create(b.content,a.SymbolKind.Function,S=he(b.offset,b.length),S,n,void 0,k);for(b=w[++T],i=["#"+b.content.toLowerCase()];"|"===w[T+1].content;)i.push("#"+(b=w[T+=2]).content),b.semantic={type:h.class};s.range.end=e.positionAt(b.offset+b.length),s.returntypes={[i.length>1?`[${i.join(",")}]`:null!==(o=i.pop())&&void 0!==o?o:"#any"]:!0},null===(r=t.children)||void 0===r||r.push(s)}else b=m;else{let e=[];if("=>"===b.content)for(b=w[++T],e=["#"+b.content.toLowerCase()];"|"===(null===(s=w[T+1])||void 0===s?void 0:s.content);)e.push("#"+(b=w[T+=2]).content),b.semantic={type:h.class};t.returntypes={[e.length>1?`[${e.join(",")}]`:null!==(c=e.pop())&&void 0!==c?c:"#any"]:!0}}}else if("("===w[T].content){let e=[],t=!1,n=!1;for(;")"!==(b=w[++T]).content;){let i;switch(b.type){case"TK_WORD":i=y.create(b.content,a.SymbolKind.Variable,S=he(b.offset,b.length),S),i.ref=t,t=!1,e.push(i),b.semantic={type:h.parameter,modifier:1<<p.definition},":="===(b=w[T+1]).content?(T+=2,"+"===(b=w[T]).content||"-"===b.content?i.defaultVal=b.content+w[++T].content:i.defaultVal=b.content):"*"===b.content?(i.arr=!0,T++):"["===b.content?n=!0:(n&&(i.defaultVal=null),"]"===b.content&&(n=!1));break;case"TK_STRING":e.push(i=y.create(b.content,a.SymbolKind.String,S=he(b.offset,b.length),S)),n&&(i.defaultVal=null);break;default:t=!1,"&"===b.content?t=!0:"*"===b.content?(e.push(y.create(b.content,a.SymbolKind.Variable,S=he(b.offset,b.length),S)),b.semantic={type:h.parameter,modifier:1<<p.definition}):"["===b.content&&(n=!0),"]"===b.content&&(n=!1)}}let i,o="",r="";if(b=w[T],T<R-2&&"=>"===w[T+1].content){i=[];do{for(T+=1,o="",r="";(b=w[T+1])&&("TK_WORD"===b.type||"TK_DOT"===b.type)&&!b.topofline&&r!==b.type;)o+=b.content,T++,r=b.type,b.semantic={type:h.class};i.push(o.replace(/([^\x00-\x2f\x3a-\x40\x5b\x5c\x5d\x5e\x60\x7b-\x7f]+)$/,"@$1"))}while(T+1<w.length&&"|"===w[T+1].content);b=w[T]}let s=g.create(m.content,C?a.SymbolKind.Method:a.SymbolKind.Function,he(m.offset,b.offset+b.length-m.offset),he(m.offset,m.length),e,[],k);if(s.full=this.document.getText(s.range),s.static=k,s.declaration={},m.semantic={type:C?h.method:h.function,modifier:1<<p.definition|1<<p.readonly|(k?1<<p.static:0)},C&&(s.full=`(${x.join(".")}) `+s.full),i){let e={};i.map((t=>e[t.toLowerCase()]=!0)),s.returntypes=e}(v-=k?2:1)>=0&&w[v].type.endsWith("COMMENT")&&(s.detail=fe(w[v].content)),null===(l=E[C].children)||void 0===l||l.push(s),k&&C?E[C].staticdeclaration[s.name.toLowerCase()]=s:E[C].declaration[s.name.toLowerCase()]=s}v=T+1,k=!1;break;case"TK_RESERVED":if(k=!1,"static"===(_=m.content.toLowerCase()))k=!0,v++;else if(v<R-1&&"class"===_){let e="",t=a.DocumentSymbol.create((m=w[++v]).content.replace("_","#"),w[v-2].type.endsWith("COMMENT")?fe(w[v-2].content):void 0,a.SymbolKind.Class,he(w[v-1].offset,0),he(m.offset,m.length),[]),n=t;if(n.declaration={},n.staticdeclaration={},T=v+1,x.push(t.name),n.full=x.join("."),n.returntypes={[n.full.replace(/([^.]+)$/,"@$1").toLowerCase()]:!0},m.semantic={type:h.class,modifier:1<<p.definition|1<<p.readonly},n.funccall=[],n.extends="",n.declaration={},n.staticdeclaration={},null===(d=E[C].children)||void 0===d||d.push(t),0===C?E[0].declaration[t.name.toLowerCase()]=t:E[C].staticdeclaration[t.name.toLowerCase()]=t,"extends"===(null===(f=b=w[T])||void 0===f?void 0:f.content.toLowerCase())){for(;++T<R&&"{"!==(b=w[T]).content;)e+=b.content;n.extends=e}C++,E.push(t),v=T+1}else m.type="TK_WORD";break;case"TK_END_BLOCK":if(C){C--,x.pop();let e=E.pop();e.range.end=this.document.positionAt(m.offset+m.length),this.addFoldingRangePos(e.range.start,e.range.end)}default:v++,k=!1}if(2&this.d||t&&!this.uri.includes("?")){this.d=3,this.children.map((e=>{switch(e.kind){case a.SymbolKind.Function:case a.SymbolKind.Class:e.uri=this.uri,u.ahkvars[e.name.toLowerCase()]=e}}));let e=this.declaration.struct;e&&e.kind===a.SymbolKind.Class&&(e.def=!1)}I({},this.children,this.diagnostics),this.children.push(...this.blocks),this.diags=this.diagnostics.length,this.blocks=void 0,this.isparsed=!0,W.region.map((e=>this.addFoldingRange(e,F-1,"line")))}):this.parseScript=function(e){n=this.document.getText(),X=n.length,N=this.scriptpath,q="",se.length=0,ee=[],V=!1,H=!0,Z=0,F=0,J=-1,W={region:[],bracket:[]},G=0,ae=u.isahk2_h,this.funccall.length=this.diagnostics.length=0,this.foldingranges.length=this.children.length=this.dllpaths.length=0,this.labels={},this.object={method:{},property:{},userdef:{}},this.includedir=new Map,this.dlldir=new Map,this.blocks=[],this.texts={},this.reflat=!0,this.declaration={},this.strcommpos.length=0,this.include=w={},this.tokens={},ne={type:"",content:"",offset:0,length:0},this.children.push(...de()),this.children.push(...this.blocks),this.blocks=void 0,I(this.declaration,this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,W.region.map((e=>this.addFoldingRange(e,F-1,"line")))}}getWordAtPosition(e,t=!1){let n,i=e.character,o=e.line,r=this.document.getText(a.Range.create(a.Position.create(o,0),a.Position.create(o+1,0))),s=r.length,c=i,l=!1;for(;c<s&&b(r.charCodeAt(c));)c++;for(i=e.character-1;i>=0;i--)if(n=r.charCodeAt(i),46===n){if(!t)break;l=!0}else{if(l){if(9===n||32===n)continue;l=!1}if(!b(n))break}return i+1<c?{text:r.substring(i+1,c).replace(/\s/g,""),range:a.Range.create(a.Position.create(o,i+1),a.Position.create(o,c))}:{text:"",range:a.Range.create(e,e)}}searchNode(e,t,n,i){let o,r=this.uri;if(n===a.SymbolKind.Variable||n===a.SymbolKind.Class||n===a.SymbolKind.Function){let n,i,s=!0;if(e=e.toLowerCase(),t&&(n=this.searchScopedNode(t),n)){if(n.kind===a.SymbolKind.Class&&n.extends){let e=this.document.offsetAt(n.selectionRange.end)+1,i=this.get_tokon(e);for(;"extends"!==i.content.toLowerCase();)e=i.offset+i.length,i=this.get_tokon(e);(i.pos||(i.pos=this.document.positionAt(i.offset))).line===t.line&&(n=void 0)}i=n}if(n){for(;n;){let t=n.declaration,i=n.local,s=n.global;if(i&&i[e])return i[e].selectionRange.start.character!==i[e].selectionRange.end.character&&{node:i[e],uri:r};if(s&&s[e])return{node:this.declaration[e]||s[e],uri:r};if(n.assume===f.GLOBAL)return(o=this.declaration[e])?{node:o,uri:r}:void 0;if(t&&n.kind!==a.SymbolKind.Class&&t[e]){if(n.kind===a.SymbolKind.Method||!n.parent)return{node:t[e],uri:r};o=t[e]}n=n.parent}if(o)return{node:o,uri:r};if(e.match(/^(this|super)$/i)){for(n=i;n&&n.kind!==a.SymbolKind.Class;)n.kind===a.SymbolKind.Method&&n.static&&(s=!1),n=n.parent;if(n){if("this"===e)return{node:n,uri:r,ref:s};if(n.extends){let e=A(this,n.extends.toLowerCase(),a.Position.create(0,0),a.SymbolKind.Class);if(e)return{node:e[0].node,uri:e[0].uri,ref:s}}return}}if(!n&&this.declaration[e])return{node:this.declaration[e],uri:r}}else if(o=this.declaration[e])return{node:o,uri:r}}else if(n===a.SymbolKind.Field){let n=t?this.searchScopedNode(t):void 0,i=(n||this).labels;if(i){":"===e.substr(-1)&&(e=e.slice(0,-1));let t=i[e.toLowerCase()];if(t&&t[0].def)return{node:t[0],uri:r}}if(n)return null}}buildContext(e,t=!0){var n,i;let o=this.getWordAtPosition(e,t),r="",s="",c="",l="",d=!1,u=a.SymbolKind.Variable,f=0,h=0,p=0,m=0,g="",y=this.document;if(r=y.getText(a.Range.create(o.range.start.line,0,o.range.end.line+1,0)).replace(/\r?\n/,""),t&&(r.match(/^\./)||o.text.match(/^\./)))for(f=o.range.start.character,m=o.range.start.line,g=o.text;m>=0;){if(f>0)h=f,f--,s=r,p=s.charCodeAt(f);else{if(0===m)break;m--,s=this.document.getText(a.Range.create(m,0,m+1,0));let e=s.replace(/('|").*?(?<!`)\1/,"").match(/(^|\s+)(;.*|\/\*.*\*\/\s*)?[\r\n]*$/);h=s.length-(e?e[0].length:0),f=h-1,p=s.charCodeAt(f)}for(;f>0;){if(46===p)d=!0;else if(d&&(9===p||32===p?(f--,p=s.charCodeAt(f)):d=!1),39===p||34===p)v();else if(37===p)T(37);else if(41===p)T(40);else if(93===p)T(91);else if(125===p)T(123);else if(!b(p)){f++;break}f--,p=s.charCodeAt(f)}if(g=s.substring(f,h).replace(/\s+(?=\.\S)/g,"")+g,46!==p){o.range.start={line:m,character:f},o.text=g,r=this.document.getText(a.Range.create(o.range.start.line,0,o.range.end.line+1,0));break}m--}o.range.start.character>0&&(c=this.document.getText(a.Range.create(o.range.start.line,0,o.range.start.line,o.range.start.character)).trim()),l=this.document.getText(a.Range.create(o.range.end.line,o.range.end.character,o.range.end.line+1,0));let _=this.tokens[y.offsetAt(o.range.start)];if(_&&"TK_RESERVED"===_.type?u=a.SymbolKind.Null:-1===o.text.indexOf(".")?(l.match(/^\(/)||c.match(/^(try|else|finally|)$/i)&&l.match(/^\s*(([\w,]|[^\x00-\x7f])|$)/))&&(u=a.SymbolKind.Function):u=l.match(/^\(/)||c.match(/^(try|else|finally|)$/i)&&l.match(/^\s*(([\w,]|[^\x00-\x7f])|$)/)?a.SymbolKind.Method:a.SymbolKind.Property,l=l.trimRight(),o.text&&u!==a.SymbolKind.Null)if(u===a.SymbolKind.Function&&c.match(/^(static|)$/i)){let t=this.searchScopedNode(e);if(t&&t.kind===a.SymbolKind.Class){let i,r=o.text.toLowerCase();if((i=t.declaration[r])&&i.selectionRange.start.line===e.line&&i.selectionRange.end.character>=e.character||(i=t.staticdeclaration[r])&&i.selectionRange.start.line===e.line&&i.selectionRange.end.character>=e.character){u=a.SymbolKind.Method;let e=null===(n=i.full)||void 0===n?void 0:n.match(/^\(([^)]+)\)/);e&&o.text===i.name&&(o.text=(i.static?e[1]:e[1].replace(/([^.]+)$/,"@$1"))+"."+o.text)}}}else if(u===a.SymbolKind.Variable)if(""===c.trim()&&l.match(/^:($|\s)/)||c.match(/(?<!\.)\b(goto|break|continue)(\(\s*['"]|\s*)$/i))u=a.SymbolKind.Field;else if(""===c.trim()&&l.match(/^:\s*(\s;.+)?$/)){let t=this.searchScopedNode(e),n=o+":";for(const e of t?t.children||[]:this.children)if(e.kind===a.SymbolKind.Field&&e.name.toLowerCase()===n){u=a.SymbolKind.Field;break}}else{let t=this.searchScopedNode(e);if(t&&t.kind===a.SymbolKind.Class){let n,r=o.text.toLowerCase();if((n=t.declaration[r])&&n.selectionRange.start.line===e.line&&n.selectionRange.end.character>=e.character&&n.selectionRange.start.character<=e.character||(n=t.staticdeclaration[r])&&n.selectionRange.start.line===e.line&&n.selectionRange.end.character>=e.character&&n.selectionRange.start.character<=e.character)if(n.kind===a.SymbolKind.Class)u=a.SymbolKind.Class,o.text=n.full;else{u=a.SymbolKind.Property;let e=null===(i=n.full)||void 0===i?void 0:i.match(/^\(([^)]+)\)/);e&&o.text===n.name&&(o.text=(n.static?e[1]:e[1].replace(/([^.]+)$/,"@$1"))+"."+o.text)}}}return{text:o.text,range:o.range,kind:u,pre:c,suf:l,linetext:r};function v(){if(s.substring(0,f).match(/^\s*\)['"]$/));else{let e=p;for(;f>0&&(f--,p=s.charCodeAt(f),p!==e||0!==f&&96===s.charCodeAt(f-1)););}}function T(e){let t=40===e?41:123===e?125:91===e?93:37,n=0;for(;m>=0;){for(;f>0;){if(p===e){if(--n<=0)return}else if(p===t)n++;else switch(p){case 34:case 39:v();break;case 37:T(37);break;case 41:T(40);break;case 93:T(91);break;case 125:T(123)}f--,p=s.charCodeAt(f)}if(p===e&&--n<=0)return;g=" "+s.substring(f,h).replace(/\s+(?=\.\S)/g,"")+g,m--,s=y.getText(a.Range.create(m,0,m+1,0));let i=s.replace(/('|").*?(?<!`)\1/,"").match(/(^|\s+)(;.*)?[\r\n]*$/);h=s.length-(i?i[0].length:0),f=h-1,p=s.charCodeAt(f)}}}getNodeAtPosition(e){let t,n=this.buildContext(e);if(n){let e=this.searchNode(n.text.toLowerCase(),n.range.end,n.kind);e&&(t=e.node)}return t}searchScopedNode(e,t){let n,i,{line:o,character:r}=e;t||(t=this.children);for(const s of t)if(!(o>s.range.end.line||o<s.selectionRange.start.line||o===s.selectionRange.start.line&&r<s.selectionRange.start.character||o===s.range.end.line&&r>s.range.end.character)){if(s.kind!==a.SymbolKind.Variable&&(n=s.children)){if(i=this.searchScopedNode(e,n))return i;if(e.line>s.selectionRange.start.line||e.character>s.selectionRange.end.character)return s}return}}getScopeChildren(e){let t,n=[],i={},o="";if(e){let r=e;for(const e in r.local)i[e]=r.local[e];for(const e in r.global)i[e]=null;for(const e in r.declaration)void 0===i[e]&&(i[e]=r.declaration[e]);if(t=r.parent,t&&t.kind===a.SymbolKind.Class&&r.kind===a.SymbolKind.Function)e=t;else{for(;t&&t.children&&(t.kind===a.SymbolKind.Function||t.kind===a.SymbolKind.Method||t.kind===a.SymbolKind.Property);){for(const e in t.local)void 0===i[e]&&(i[e]=t.local[e]);for(const e in t.global)void 0===i[e]&&(i[e]=null);for(const e in t.declaration)void 0===i[e]&&(i[e]=t.declaration[e]);e=t,t=t.parent}void 0===i[o=e.name.toLowerCase()]&&e.kind!==a.SymbolKind.Method&&e.kind!==a.SymbolKind.Property&&(i[o]=e)}return(e.kind===a.SymbolKind.Method||e.kind===a.SymbolKind.Property&&e.children)&&(e.parent?e=e.parent:n.push(a.DocumentSymbol.create("this",d.completionitem._this(),a.SymbolKind.Variable,a.Range.create(0,0,0,0),a.Range.create(0,0,0,0)))),(null==e?void 0:e.kind)===a.SymbolKind.Class&&(n.push(a.DocumentSymbol.create("this",d.completionitem._this(),a.SymbolKind.Variable,a.Range.create(0,0,0,0),a.Range.create(0,0,0,0))),e.extends&&n.push(a.DocumentSymbol.create("super",d.completionitem._super(),a.SymbolKind.Variable,a.Range.create(0,0,0,0),a.Range.create(0,0,0,0)))),n.concat(Object.values(i).filter((e=>!!e)))}for(const e of this.children)if(e.kind!==a.SymbolKind.Event){if(e.kind===a.SymbolKind.Variable||e.kind===a.SymbolKind.Class){if(i[o=e.name.toLowerCase()])continue;i[o]=!0}n.push(e)}return n}initlibdirs(){if(u.inBrowser)return;const e=(0,o.resolve)().toLowerCase();e!==this.scriptpath&&e!==r.argv0.toLowerCase()&&this.scriptpath.startsWith(e)&&!this.scriptpath.endsWith("\\lib")?(0,i.existsSync)(this.scriptpath+"\\lib")&&(0,i.statSync)(this.scriptpath+"\\lib").isDirectory()?this.scriptdir=this.scriptpath:this.scriptdir=e.replace(/\\lib$/,""):this.scriptdir=this.scriptpath.replace(/\\lib$/,""),this.libdirs=[this.scriptdir+"\\lib"];for(const e of u.libdirs)this.libdirs[0]!==e&&this.libdirs.push(e)}instrorcomm(e){var t;let n=this.document.offsetAt(e);return null===(t=this.strcommpos.find((e=>n>=e.start&&e.end>=n)))||void 0===t?void 0:t.type}colors(){let e=this.strcommpos,t=this.document,n=t.getText(),i=[];for(let o of e)if(2===o.type){let e,r=o.start,s=o.end,c=_.exec(n.substring(r,s)),l="";if(!c||!c[1]&&s-r+1!==c[2].length+2)continue;e=a.Range.create(t.positionAt(r+=c.index+(c[1]?c[1].length:0)),t.positionAt(r+c[2].length)),l=c[5]?v[c[5].toLowerCase()]:void 0===c[3]?c[2]:c[2].substring(2);let d={red:0,green:0,blue:0,alpha:1},u=["red","green","blue"];void 0!==c[4]&&u.unshift("alpha");for(const e of u)d[e]=parseInt("0x"+l.substr(0,2))/255,l=l.slice(2);i.push({range:e,color:d})}return i}addDiagnostic(e,t,n,i=a.DiagnosticSeverity.Error,o){let r=this.document.positionAt(t),s=r;void 0!==n&&(s=this.document.positionAt(t+n)),(o||this.diagnostics).push({range:a.Range.create(r,s),message:e,severity:i})}addFoldingRange(e,t,n="block"){let i=this.document.positionAt(e).line,o=this.document.positionAt(t).line-("block"===n?1:0);i<o&&this.foldingranges.push(a.FoldingRange.create(i,o,void 0,void 0,n))}addFoldingRangePos(e,t,n="block"){let i=e.line,o=t.line-("block"===n?1:0);i<o&&this.foldingranges.push(a.FoldingRange.create(i,o,void 0,void 0,n))}addSymbolFolding(e,t){let n=u.extsettings.SymbolFoldingFromOpenBrace?this.document.positionAt(t).line:e.range.start.line,i=e.range.end.line-1;n<i&&this.foldingranges.push(a.FoldingRange.create(n,i,void 0,void 0,"block"))}}function E(e,t,n=""){let r,a="";if("<"!==e[0]){for(;r=e.match(/%a_(\w+)%/i);){let t=r[1];if(!u.pathenv[t])return;e=e.replace(r[0],u.pathenv[t])}return-1===e.indexOf(":")&&(e=(0,o.resolve)(n,e)),a=c.URI.file(e).toString().toLowerCase(),{uri:a,path:e}}{if(!(e=e.replace("<","").replace(">","")))return;let n=[e+".ahk"];(r=e.match(/^((\w|[^\x00-\x7f])+)_.*/))&&n.push(r[1]+".ahk");for(const o of t)for(const t of n)if((0,i.existsSync)(e=o+"\\"+t))return a=c.URI.file(e).toString().toLowerCase(),{uri:a,path:e}}}function O(e,t,n=!0){if(t.kind!==a.SymbolKind.Class)return{};let i,o,r={},s=t.name.toLowerCase(),c="object"===s||"comobjarray"===s||!t.extends&&"any"!==s;if(function e(t,n,i){var o,l;let d=n.uri,f="";if(i){if(!r.__new){let e=n.declaration.__new;e&&(r.__new=e,e.uri=d)}for(let e of Object.values(n.staticdeclaration))r[s=e.name.toLowerCase()]&&e.kind!==a.SymbolKind.Class?"call"===s&&!1===r.call.def&&(r[s]=e,e.uri=d):(r[s]=e,e.uri=d);(null===(o=r.__new)||void 0===o?void 0:o.static)&&delete r.__new}else for(let e of Object.values(n.declaration))r[s=e.name.toLowerCase()]||(r[s]=e,e.uri=d);if((s=null===(l=n.extends)||void 0===l?void 0:l.toLowerCase())&&s!==(f=n.full.toLowerCase())){let n,o,l,d=s.split("."),h=f.split("."),p=-1;for(c||"object"!==s&&"comobjarray"!==s||(c=!0);d[p+1]===h[p+1];)p++;if(d.length>h.length&&p===h.length-1?p+1<d.length&&r[d[++p]]&&(n=[{node:r[d[p]],uri:r[d[p]].uri}],d.splice(0,p)):n=A(t,d[0],a.Position.create(0,0),a.SymbolKind.Class),n&&n.length&&(o=n[0].node).kind===a.SymbolKind.Class)for(l=u.lexers[n[0].uri]||t,n[0].uri&&void 0===o.uri&&(o.uri=n[0].uri);o;){if(1===d.length){e(l,o,i);break}{let t=r;r={},e(l,o,!0),d.splice(0,1),(o=r[d[0]])&&o.kind!==a.SymbolKind.Class&&(o=void 0),r=t}}}else s||c||"any"===n.name.toLowerCase()||(c=!0)}(e,t,n),!c)return r;if(n&&(!r.call&&r.__new&&(o=Object.assign({},r.__new),o.name="Call",o.def=!1,r.call=o),(i=u.ahkvars.class)&&i!==t))for(s in i.staticdeclaration)r[s]||(r[s]=i.staticdeclaration[s],r[s].uri=i.uri);if(i=u.ahkvars.object)for(s in i.declaration)r[s]||(r[s]=i.declaration[s],r[s].uri=i.uri);return r}function D(e,t,n,i){let o=new x(s.TextDocument.create("","ahk2",-10,"$ := "+t));C={},o.parseScript();for(const t of o.children)if(t.kind===a.SymbolKind.Variable&&"$"===t.name){let r=Object.keys(t.returntypes||{}).pop();return r&&P(e,r,n,o.document.getText(a.Range.create(t.selectionRange.end,t.range.end))).map((e=>i[e]=C[e]||!1)),o.document.getText(t.range).substring(5)}}function K(e,t,n){var i,o,r,s,c,l;if(t.match(/^[@#]([\w.]|[^\x00-\x7f])+$/))return[t];if("a_args"===t)return["#array"];if("a_"===t.substring(0,2))return["#string"];let d,f,h,p,m=n?e.searchScopedNode(n):void 0,g={},y=e.uri,b=e.relevance;for(;m;)if(m.kind===a.SymbolKind.Class)m=m.parent;else{if(f=m.declaration,f&&f[t]){if(f[t].kind!==a.SymbolKind.Variable)return C[t]=f[t],[t];break}m=m.parent}if(!m){let n=e.uri;f=e.declaration,f[t]&&(h=f[t]);for(const e in b)f=u.lexers[e].declaration,f[t]&&(h?h.kind===a.SymbolKind.Variable&&f[t].kind!==a.SymbolKind.Variable&&(h=f[t],n=e):(h=f[t],n=e));if(!h)return u.ahkvars[t]?[t]:[];if(h.kind!==a.SymbolKind.Variable)return C[h.name.toLowerCase()]=h,[h.name.toLowerCase()];if(null===(r=p=null===(o=null===(i=h.detail)||void 0===i?void 0:i.match(/^\s*@types?:?\s*(.*)/im))||void 0===o?void 0:o[1].split(/[,|]/).map((e=>e.trim().toLowerCase().replace(/([^.]+)$/,"@$1"))))||void 0===r?void 0:r.length)return p;if(n!==e.uri)return["#any"];m=e,(h.returntypes||h.ref)&&(d=h,y=n)}if(null==m?void 0:m.children)for(const e of m.children)if(t===e.name.toLowerCase()){if(e.kind!==a.SymbolKind.Variable&&e.kind!==a.SymbolKind.Property)return[t];if(n&&(e.selectionRange.end.line>n.line||e.selectionRange.end.line===n.line&&e.selectionRange.start.character>n.character))break;if(null===(l=p=null===(c=null===(s=e.detail)||void 0===s?void 0:s.match(/^\s*@types?:?\s*(.*)/im))||void 0===c?void 0:c[1].split(/[,|]/).map((e=>e.trim().toLowerCase().replace(/([^.]+)$/,"@$1"))))||void 0===l?void 0:l.length)return p;(e.ref||e.returntypes)&&(d=e)}if(d){if(d.ref){let t=L(e,d.selectionRange.start);if(t){let n=A(e,t.name,d.selectionRange.end,a.SymbolKind.Variable);if(n){let e=n[0].node;if(e===u.ahkvars.regexmatch){if(t.index=2)return["#regexmatchinfo"]}else if(u.ahkvars[t.name]===e)return["#number"]}}return[]}{let t=e.document.getText(a.Range.create(d.selectionRange.end,d.range.end));P(e,(Object.keys(d.returntypes||{}).pop()||"").toLowerCase(),d.range.end,t).map((e=>g[e]=!0)),g["#func"]&&(C["#return"]={exp:t,pos:d.range.end,doc:e})}}return g["#any"]?[]:Object.keys(g)}function P(e,t,n,i){let o=`${t.trim()},${e.uri},${n.line},${n.character}`;return void 0!==w[o]?w[o]||[]:(w[o]=!1,w[o]=function e(t,n,i,o=0,r){let s,c=[];for(n=n.replace(/#any(\(\)|\.(\w|[^\x00-\x7f])+)+/g,"#any").replace(/\b(true|false)\b/gi,"#number");(s=n.replace(/\(((\(\)|[^\(\)])+)\)/g,((...n)=>{let r=e(t,n[1],i,o+1);return r.length>1?`[${r.join(",")}]`:r.pop()||"#any"})))!==n;)n=s;for(;(s=n.replace(/\s(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*([+\-*/&|^]|\/\/|<<|>>|\*\*)\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*/g," #number "))!==n;)n=s;for(;(s=n.replace(/\s[+-]?(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s+(\.\s+)?[+-]?(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*/g," #string "))!==n;)n=s;for(;(s=n.replace(/\s(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*(~=|<|>|[<>]=|!?=?=|\b(is|in|contains)\b)\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*/g," #number "))!==n;)n=s;for(;(s=n.replace(/(not|!|~|\+|-)\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/g," #number "))!==n;)n=s;for(;(s=n.replace(/(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*(\band\b|&&)\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/g," #number "))!==n;)n=s;for(;(s=n.replace(/(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*(\bor\b|\|\|)\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/g,((...e)=>{let t,n={};for(let i=1;i<5;i+=3)(t=e[i].match(/^\[([^\[\]]+)\]$/))?t[1].split(",").map((e=>n[e]=!0)):n[e[i]]=!0;return n=Object.keys(n),n.length>1?`[${n.join(",")}]`:n.pop()||"#void"})))!==n;)n=s;for(;(s=n.replace(/(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*\?\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*:\s*(([@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/,((...e)=>{let t,n={};for(let i=3;i<6;i+=2)(t=e[i].match(/^\[([^\[\]]+)\]$/))?t[1].split(",").map((e=>n[e]=!0)):n[e[i]]=!0;return n=Object.keys(n),n.length>1?`[${n.join(",")}]`:n.pop()||"#void"})))!==n;)n=s;if(0===o)for(;n!==(s=n.replace(/((\w|[@#.]|[^\x00-\x7f])+)\(\)/,((...o)=>{let s,c=A(t,o[1],n.trim()===o[0]?{line:i.line,character:i.character-n.length}:i,a.SymbolKind.Variable),l="",d={};return c?(c.map((n=>{let o=n.node,c=n.uri;e:switch(o.kind){case a.SymbolKind.Method:if(s=o.full.toLowerCase().match(/\(([^()]+)\)\s*([^()]+)/),s&&"gui"===s[1]){if("add"===s[2]){let e={dropdownlist:"ddl",tab2:"tab",tab3:"tab",picture:"pic"};(s=null==r?void 0:r.toLowerCase().match(/\.add\(\s*(('|")(\w+)\2)?/))&&(s[3]?d["gui.@"+(e[s[3]]||s[3])]=!0:d["gui.@tab"]=d["gui.@listview"]=d["gui.@treeview"]=d["gui.@statusbar"]=!0)}else for(const e in o.returntypes)d[e]=!0;break}case a.SymbolKind.Function:if(o===u.ahkvars.objbindmethod&&(s=null==r?void 0:r.toLowerCase().match(/objbindmethod\(\s*(([\w.]|[^\x00-\x7f])+)\s*,\s*('|")([^'"]+)\3\s*[,)]/)))d[s[1]+"."+s[4]]=!0;else if((c=o.uri||c)&&u.lexers[c])for(const e in o.returntypes)P(u.lexers[c],e.toLowerCase(),a.Position.is(o.returntypes[e])?o.returntypes[e]:i).map((e=>{d[e]=!0}));break;case a.SymbolKind.Variable:c&&u.lexers[c]&&K(u.lexers[c],o.name.toLowerCase(),c===t.uri?i:void 0).map((t=>{if(C[t]&&(o=C[t].node,o.kind===a.SymbolKind.Class||o.kind===a.SymbolKind.Function||o.kind===a.SymbolKind.Method))for(const t in o.returntypes)e(u.lexers[c],t.toLowerCase(),a.Position.is(o.returntypes[t])?o.returntypes[t]:i).map((e=>{d[e]=!0}))}));break;case a.SymbolKind.Property:if(c&&u.lexers[c]&&(l=Object.keys(o.returntypes||{}).pop()||"")){let t={};if(D(u.lexers[c],l,o.range.end,t),t["#any"])return"#any";for(const n in t){if(!C[n])return"#any";if(o=C[n].node,o.kind===a.SymbolKind.Class||o.kind===a.SymbolKind.Function||o.kind===a.SymbolKind.Method)for(const t in o.returntypes)e(u.lexers[c],t.toLowerCase(),a.Position.is(o.returntypes[t])?o.returntypes[t]:i).map((e=>{d[e]=!0}))}}break;case a.SymbolKind.Class:if((c=o.uri||c)&&u.lexers[c])for(const t of Object.values(O(u.lexers[c],o,!0)))if(!1!==t.def&&"call"===t.name.toLowerCase()){let n=t;for(const t in n.returntypes)e(u.lexers[c],t.toLowerCase(),a.Position.is(n.returntypes[t])?n.returntypes[t]:i).map((e=>{d[e]=!0}));if(n.returntypes)break e;break}(l=Object.keys(o.returntypes||{}).pop()||"")&&(d[l]=!0)}})),d["gui.@control"]?"[gui.@tab,gui.@listview,gui.@treeview,gui.@statusbar]":(d=Object.keys(d),d.length>1?`[${d.join(",")}]`:d.pop()||"#void")):"#void"})));)n=s;let l=n.trim(),d=[],f={};if(s=l.match(/^\[([^\[\]]+)\]$/)){let e={};s[1].split(",").map((t=>e[t]=!0)),c.map((t=>e[t]=!0)),d=Object.keys(e)}else d=[l];if(o)return d;n=n.trim();for(let o of d)if(s=o.match(/^([@#]?)(\w|[^\x00-\x7f])+(\.[@#]?(\w|[^\x00-\x7f])+)*$/)){let r,c="";if(s[1]&&!s[3]||C[o])f[o]=!0;else for(const s of A(t,o,o===n?{line:i.line,character:i.character-o.length}:i,a.SymbolKind.Variable)||[])switch(s.node.kind){case a.SymbolKind.Variable:K(t,s.node.name.toLowerCase(),s.uri===t.uri?i:s.node.selectionRange.end).map((e=>f[e]=!0));break;case a.SymbolKind.Property:if(s.node.returntypes){let n=Object.keys(s.node.returntypes||{}).pop();n&&e(u.lexers[s.uri]||t,n,s.node.range.end).map((e=>f[e]=!0))}else if(s.node.children)for(const n of s.node.children){let o=n.returntypes;if("get"===n.name.toLowerCase()&&n.kind===a.SymbolKind.Function){for(const n in o)e(u.lexers[s.uri]||t,n.toLowerCase(),a.Position.is(o[n])?o[n]:i).map((e=>f[e]=!0));break}}break;case a.SymbolKind.Object:o.endsWith(".prototype")?f["@"+o.slice(0,-10)]=!0:(f["#object"]=!0,C[o]=s);break;case a.SymbolKind.Function:f[c=s.node.name.toLowerCase()]=!0,C[c]=s;break;case a.SymbolKind.Method:r=s.node.full.match(/^\(([^()]+)\)/),c=((r?r[1]+".":"")+s.node.name).toLowerCase(),f[c]=!0,C[c]=s;break;case a.SymbolKind.Class:f[o=(s.ref?"@":"")+o]=!0,C[o]=s}}return f=Object.keys(f),f.length?f:["#any"]}(e,t,n,0,i))}function A(e,t,n,o,r=!0){var s,l,d;let f,h,p,m=e.uri;if(o===a.SymbolKind.Method||o===a.SymbolKind.Property||-1!==t.indexOf(".")){let i=t.split("."),c=A(e,i[0],n,a.SymbolKind.Class),h=0,y=0;if(!c)return;let{node:b,uri:_}=c[0];if(c[0].ref&&i[0].match(/^[^@#]/)&&(i[0]="@"+i[0]),b.kind===a.SymbolKind.Variable){let e=K(u.lexers[m],i[0].replace(/^[@#]/,""),c[0].node.selectionRange.end||n),r=[];if(0===e.length);else for(const a of e)null===(s=A(u.lexers[m],t.replace(new RegExp("^"+i[0]),a),a.match(/^[#@]/)?void 0:n,o))||void 0===s||s.map((e=>{r.map((e=>e.node)).includes(e.node)||r.push(e)}));return r.length?r:void 0}if(y=i.length-1){let t,n;for(;h<y;){if(f=void 0,h++,b.kind===a.SymbolKind.Function||b.kind===a.SymbolKind.Method){if(n=b,h<=i.length&&"call"===i[h]){f=b;continue}u.ahkvars.func&&(b=u.ahkvars.func,i[h-1]="@"+i[h-1].replace(/^[@#]/,""))}else if(b.kind===a.SymbolKind.Property||b.kind===a.SymbolKind.Variable){if(p=b.returntypes){let e={},t=Object.keys(p).pop(),n=[];if(t){D(u.lexers[b.uri||m],t,a.Position.is(p[t])?p[t]:b.selectionRange.end,e);let r=i.slice(h).join(".");for(const t in e)null===(l=A(u.lexers[m],t+"."+r,void 0,o))||void 0===l||l.map((e=>{n.map((e=>e.node)).includes(e.node)||n.push(e)}));return n.length?n:void 0}}}else b.kind===a.SymbolKind.Object&&b.static&&"prototype"===b.name.toLowerCase()&&(i[h-1]="@prototype",t&&(b=t));if(b.kind===a.SymbolKind.Class){t=b,_&&!b.uri&&(b.uri=_);let o,s=r&&h>0&&!i[h-1].match(/^[@#]/),c=i[h].replace(/[@#]/,""),l=O(e,b,s);if(h===y?((o=l[c])&&(f=o,m=o.uri||"","prototype"===c&&(f=Object.assign({},o),f.kind=a.SymbolKind.Object)),!f&&"clone"!==c&&(o=l.__call)&&(f=o,m=o.uri||"")):(o=l[c])&&(f=o,m=o.uri||""),"clone"===c){let e=null===(d=f)||void 0===d?void 0:d.full.toLowerCase().match(/^\(([^()]+)\)\s+/),t=b.full.toLowerCase();if(!e||e[1]!==t&&u.ahkvars[e[1]]){let e=a.Range.create(0,0,0,0);m="",f=g.create("Clone",a.SymbolKind.Method,e,e,[],[],!0),f.returntypes={[s?t:t.replace(/([^.]+)$/,"@$1")]:!0}}}else if(f&&"bind"===c&&n&&f.full.match(/\(func\)\s+bind\(/i)){let e=Object.assign({},f),t=n.full.match(/^\s*\(([^()]+)\)/);e.returntypes={[((t?t[1]+".":"")+n.name).toLowerCase()]:!0},f=e}n=void 0}if(!f)break;b=f}}return f?[{node:f,uri:m}]:void 0}if(!(h=e.searchNode(t=t.replace(/^@/,""),n,o))){if(null===h)return;if(!1===h)return null;h=function(e,t){let n,o=u.lexers[e].relevance;for(const e in o){let o=u.lexers[e];if(!o){let t=c.URI.parse(e).fsPath;if(!(0,i.existsSync)(t))continue;{let n=(0,u.openFile)(t);if(!n)continue;o=u.lexers[e]=new x(n),o.parseScript()}}if(n=o.declaration[t])return{node:n,uri:e}}}(e.uri,t)}if(h&&h.node.kind===a.SymbolKind.Variable&&h.node===e.declaration[t])for(const n in e.relevance)if((p=u.lexers[n].declaration[t])&&p.kind!==a.SymbolKind.Variable)return[{node:p,uri:n}];return o===a.SymbolKind.Field||h&&(h.node.kind!==a.SymbolKind.Variable||h.node.def)||!(p=u.ahkvars[t])&&!(p=u.ahkvars[t.replace(/^[@#]/,"")])?h?[h]:void 0:[{uri:p.uri,node:p}]}function L(e,t){var n;let i,o,r,s=e.document.offsetAt(t),c={start:0,end:0},l={line:0,character:0},d=e.searchScopedNode(t),u="",f="",h="",p=-1,m=0,g=s,y=0;if(d){for(;d&&!d.funccall;)d=d.parent;o=(null===(n=d)||void 0===n?void 0:n.funccall)||e.funccall}else o=e.funccall;for(const n of o){const o=e.document.offsetAt(n.range.start),r=e.document.offsetAt(n.range.end);if(o+n.name.length<s){if(s>r){if(n.range.end.line!==t.line||e.document.getText({start:n.range.end,end:t}).trim())continue}else if(s===r&&")"===e.document.getText(a.Range.create({line:t.line,character:t.character-1},t)))continue;(!i||c.start<=o&&r<=c.end)&&(i=n,c={start:o,end:r},l=n.range.start)}}if(i&&i.paraminfo){if(p=s>c.start+i.name.length?0:-1,-1!==p)for(let e of i.paraminfo.comma){if(!(s>e))break;++p}return{name:i.name.toLowerCase(),pos:l,index:p,full:u}}if(!i||-1!==e.document.getText(i.range).indexOf(")(")){let n=e.document.getText(a.Range.create(t.line,0,t.line+1,0));for(;r=n.match(/('|").*?(?<!`)\1/);)n=n.replace(r[0],"".repeat(r[0].length));let i=n.match(/^(.*\(\s*(([\w.]|[^\x00-\x7f])+)\s*\))\((.*)\)/);if(i&&(s=t.character-i[1].length)>0){let e=0,n=0,o=0,r=0;e:for(const t of i[4].split(""))switch(r++,t){case"(":e++;break;case")":if(--e<0)break e;break;case"[":n++;break;case"]":n--;break;case"{":o++;break;case"}":o--}0===n&&0===o&&e<=0&&t.character<i[1].length+r+(0===e?2:1)&&(l.line=t.line,l.character=s,f=i[2]+"("+i[4].substring(0,r)+(0===e?")":""),h=u=i[2].toLowerCase(),m=f.length-h.length,s+=h.length,h=h.split(".").pop()||"",h===u&&(u=""))}}if(h);else{if(!i)return;f=e.document.getText(i.range),h=i.name.toLowerCase(),u="",s=g-c.start,p=-1,m=c.end-c.start-h.length,y=e.document.offsetAt(i.range.start)}for(;-1!==(r=f.search(/['"]/));){let t;if(!(t=e.tokens[y+r])||"TK_STRING"!==t.type)break;f=f.substring(0,r)+"_".repeat(t.length)+f.substring(r+t.length)}for(const e of[["\\{","\\}"],["\\[","\\]"],["\\(","\\)"]]){const t=new RegExp(e[0]+"[^"+e[0]+"]*?"+e[1]);for(;(r=t.exec(f))&&!(r[0].length>=m);)f=f.replace(r[0],"_".repeat(r[0].length))}s>h.length&&(p+=1);for(let e=h.length+1;e<s;e++)if(","===f.charAt(e))p++;else if(")"===f.charAt(e)&&e>=f.length-1){p=-1;break}return{name:h,pos:l,index:p,full:u}}function N(e){let t,n={},i=0,o=!1,r={list:n,count:i,main:""};for(const t in u.lexers)n={},i=0,o=t===e,a(u.lexers[t].include,t),o&&i>r.count&&(r={list:n,count:i,main:t});return r.count&&(delete r.list[e],r.main&&r.main!==e&&(r.list[r.main]=r.list[r.main]||{raw:r.main.replace(/^.*\/([^/]+)$/,"$1"),path:c.URI.parse(r.main).fsPath})),r;function a(r,s){for(const l in r)e===l&&(o=!0,n[s]||(n[s]=r[s]||{path:c.URI.parse(s).fsPath,raw:""},i++)),!n[l]&&(t=u.lexers[l])&&(n[l]=r[l],i++,s!==l&&a(t.include,l))}}function M(e,t){if(e.kind===t.kind)return e.kind===a.SymbolKind.Class?d.diagnostic.conflictserr("class","Class",e.name):e.kind===a.SymbolKind.Function?d.diagnostic.conflictserr("function","Func",e.name):d.diagnostic.dupdeclaration();switch(t.kind){case a.SymbolKind.Variable:return d.diagnostic.assignerr(e.kind===a.SymbolKind.Function?"Func":"Class",e.name);case a.SymbolKind.Function:return e.kind===a.SymbolKind.Variable?d.diagnostic.funcassignerr():d.diagnostic.conflictserr("function","Class",e.name);case a.SymbolKind.Class:if(e.kind===a.SymbolKind.Function)return d.diagnostic.conflictserr("class","Func",e.name);if(e.kind===a.SymbolKind.Property||e.kind===a.SymbolKind.Method)return d.diagnostic.dupdeclaration();case a.SymbolKind.Property:case a.SymbolKind.Method:return d.diagnostic.dupdeclaration()}return""}function I(e,t,n){let i="";for(const o of t)if(o.name)switch(o.kind){case a.SymbolKind.Class:case a.SymbolKind.Function:case a.SymbolKind.Variable:if(e[i=o.name.toLowerCase()])if(e[i].infunc){if(o.kind===a.SymbolKind.Variable){if(o.def&&e[i].kind!==a.SymbolKind.Variable){n.push({message:d.diagnostic.assignerr(e[i].kind===a.SymbolKind.Function?"Func":"Class",o.name),range:o.selectionRange,severity:a.DiagnosticSeverity.Error});continue}}else if(e[i].def)n.push({message:d.diagnostic.assignerr(o.kind===a.SymbolKind.Function?"Func":"Class",o.name),range:e[i].selectionRange,severity:a.DiagnosticSeverity.Error});else if(e[i].kind===a.SymbolKind.Function){n.push({message:M(e[i],o),range:o.selectionRange,severity:a.DiagnosticSeverity.Error});continue}e[i]=o}else o.kind===a.SymbolKind.Variable?e[i].kind===a.SymbolKind.Variable?o.def&&!e[i].def&&(e[i]=o):o.def&&n.push({message:M(e[i],o),range:o.selectionRange,severity:a.DiagnosticSeverity.Error}):e[i].kind===a.SymbolKind.Variable?(e[i].def&&n.push({message:M(o,e[i]),range:e[i].selectionRange,severity:a.DiagnosticSeverity.Error}),e[i]=o):!1!==e[i].def&&n.push({message:M(e[i],o),range:o.selectionRange,severity:a.DiagnosticSeverity.Error});else e[i]=o}}t.Lexer=x,t.pathanalyze=E,t.parseinclude=function e(t){for(const n in t){let o=t[n].path;if(!u.lexers[n]&&(0,i.existsSync)(o)){let t=(0,u.openFile)(o);if(!t)continue;let i=new x(t);u.lexers[n]=i,i.parseScript(),e(i.include),i.relevance=N(n).list}}},t.getClassMembers=O,t.cleardetectcache=function(){w={}},t.detectExpType=D,t.detectVariableType=K,t.detectExp=P,t.searchNode=A,t.getFuncCallInfo=L,t.getincludetable=N,t.formatMarkdowndetail=function(e,t){let n,i={},o=[],r="";return void 0===t?e.replace(/^@((param|参数)\s+(\S+)|\S+):?/gm,((...e)=>e[3]?`\n*@param* \`${e[3]}\` — `:`\n*@${e[1]}* — `)):(e.split("\n").map((e=>{(n=e.match(/^@(param|参数)\s+(\S+)([\s|:]\s*(.*))?$/i))?i[r=n[2].toLowerCase()]=[n[4]]:r&&"@"!==e.charAt(0)?i[r].push(e):(r="",o.push(e.replace(/^(@\S+):?/,"\n*$1* — ")))})),(i[t=t.toLowerCase()]?i[t].join("\n")+"\n\n":"")+o.join("\n"))},t.samenameerr=M,t.checksamenameerr=I},701:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchAndOpenPEFile=t.getFileVersion=t.PEFile=t.RESOURCE_TYPE=t.DIRECTORY_ENTRY=void 0;const i=n(7147);var o,r;!function(e){e[e.IMAGE_DIRECTORY_ENTRY_EXPORT=0]="IMAGE_DIRECTORY_ENTRY_EXPORT",e[e.IMAGE_DIRECTORY_ENTRY_IMPORT=1]="IMAGE_DIRECTORY_ENTRY_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_RESOURCE=2]="IMAGE_DIRECTORY_ENTRY_RESOURCE",e[e.IMAGE_DIRECTORY_ENTRY_EXCEPTION=3]="IMAGE_DIRECTORY_ENTRY_EXCEPTION",e[e.IMAGE_DIRECTORY_ENTRY_SECURITY=4]="IMAGE_DIRECTORY_ENTRY_SECURITY",e[e.IMAGE_DIRECTORY_ENTRY_BASERELOC=5]="IMAGE_DIRECTORY_ENTRY_BASERELOC",e[e.IMAGE_DIRECTORY_ENTRY_DEBUG=6]="IMAGE_DIRECTORY_ENTRY_DEBUG",e[e.IMAGE_DIRECTORY_ENTRY_COPYRIGHT=7]="IMAGE_DIRECTORY_ENTRY_COPYRIGHT",e[e.IMAGE_DIRECTORY_ENTRY_GLOBALPTR=8]="IMAGE_DIRECTORY_ENTRY_GLOBALPTR",e[e.IMAGE_DIRECTORY_ENTRY_TLS=9]="IMAGE_DIRECTORY_ENTRY_TLS",e[e.IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG=10]="IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG",e[e.IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT=11]="IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_IAT=12]="IMAGE_DIRECTORY_ENTRY_IAT",e[e.IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT=13]="IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR=14]="IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR",e[e.IMAGE_DIRECTORY_ENTRY_RESERVED=15]="IMAGE_DIRECTORY_ENTRY_RESERVED"}(o=t.DIRECTORY_ENTRY||(t.DIRECTORY_ENTRY={})),function(e){e[e.CURSOR=1]="CURSOR",e[e.BITMAP=2]="BITMAP",e[e.ICON=3]="ICON",e[e.MENU=4]="MENU",e[e.DIALOG=5]="DIALOG",e[e.STRING=6]="STRING",e[e.FONTDIR=7]="FONTDIR",e[e.FONT=8]="FONT",e[e.ACCELERATOR=9]="ACCELERATOR",e[e.RCDATA=10]="RCDATA",e[e.MESSAGETABLE=11]="MESSAGETABLE",e[e.GROUP_CURSOR=12]="GROUP_CURSOR",e[e.GROUP_ICON=14]="GROUP_ICON",e[e.VERSION=16]="VERSION",e[e.DLGINCLUDE=17]="DLGINCLUDE",e[e.PLUGPLAY=19]="PLUGPLAY",e[e.VXD=20]="VXD",e[e.ANICURSOR=21]="ANICURSOR",e[e.ANIICON=22]="ANIICON",e[e.HTML=23]="HTML",e[e.MANIFEST=24]="MANIFEST"}(r=t.RESOURCE_TYPE||(t.RESOURCE_TYPE={}));class a{constructor(e){this.isBit64=!1,this.resource={},this.directoryEntry=[];let t=Buffer.alloc(8),n=(0,i.openSync)(e,"r"),o=p(60);if(23117!==h())throw(0,i.closeSync)(n),Error("no MS-DOS stub");if(17744!==p(o))throw(0,i.closeSync)(n),Error("no PE file");let r=h(o+20),a=o+24;this.isBit64=523===function(e=0){return(0,i.readSync)(n,t,0,2,e),t.readInt16LE(0)}(a);let s=p(a+(this.isBit64?108:92)),c=h(o+6),l=p(a+56),d=a+(this.isBit64?112:96),u=0,f=Buffer.alloc(40*c);(0,i.readSync)(n,f,0,f.length,a+r),this.imageData=Buffer.alloc(l);for(let e=0;e<c;e++){let e=f.readUInt32LE(u+12),t=f.readUInt32LE(u+16),o=f.readUInt32LE(u+20);(0,i.readSync)(n,this.imageData,e,t,o),u+=40}for(let e=0;e<s;e++)(0,i.readSync)(n,t,0,8,d+8*e),this.directoryEntry.push({addr:t.readUInt32LE(0),size:t.readUInt32LE(4)});function h(e=0){return(0,i.readSync)(n,t,0,2,e),t.readUInt16LE(0)}function p(e=0){return(0,i.readSync)(n,t,0,4,e),t.readUInt32LE(0)}(0,i.closeSync)(n)}getAscii(e){return this.imageData.slice(e,this.imageData.indexOf(Buffer.alloc(1),e)).toString("ascii")}getExport(){const e=this.imageData,t=this.directoryEntry[o.IMAGE_DIRECTORY_ENTRY_EXPORT];if(!(null==t?void 0:t.addr))return;if(t.data)return t.data;const n=t.addr,i=n+t.size;let r=e.readUInt32LE(n+12),a=e.readUInt32LE(n+16),s=e.readUInt32LE(n+20),c=e.readUInt32LE(n+24),l=e.readUInt32LE(n+28),d=e.readUInt32LE(n+32),u=e.readUInt32LE(n+36);const f={Module:this.getAscii(r),Functions:[],OrdinalBase:a},h={};for(let t=0;t<c;t++){let t=e.readUInt32LE(d),o=e.readUInt16LE(u),r=e.readUInt32LE(l+4*o);d+=4,u+=2,h[o]=!0;let s=r>n&&r<i?this.getAscii(r):"0x"+(r+4294967296).toString(16).substr(1);f.Functions.push({Name:this.getAscii(t),EntryPoint:s,Ordinal:a+o})}for(let t=0;c<s;t++,c++){for(;h[t];)t++;let o=e.readUInt32LE(l+4*t),r=o>n&&o<i?this.getAscii(o):"0x"+(o+4294967296).toString(16).substr(1);h[t]=!0,f.Functions.splice(t,0,{Name:"",EntryPoint:r,Ordinal:a+t})}return t.data=f}getImport(){const e=this.imageData,t=this.directoryEntry[o.IMAGE_DIRECTORY_ENTRY_IMPORT];if(!(null==t?void 0:t.addr))return;if(t.data)return t.data;const n=t.addr;let i,r,a,s=e.readInt32LE(n+12),c=e.readInt32LE(n+16),l=4,d=n;this.isBit64?(l=8,r=BigInt(65535),a=BigInt("0x8000000000000000"),i=e.readBigUInt64LE.bind(e)):(r=65535,a=2147483648,i=e.readUInt32LE.bind(e));const u={};for(;c;){let t,n=u[this.getAscii(s)]=[];for(let e=0;t=i(c+e*l);e++)n.push(t&a?"Ordinal#"+(t&r):this.getAscii(Number(t)+2));d+=20,s=e.readUInt32LE(d+12),c=e.readUInt32LE(d+16)}return t.data=u}getResource(...e){const t=this.imageData,n=this.directoryEntry[o.IMAGE_DIRECTORY_ENTRY_RESOURCE];if(!(null==n?void 0:n.addr))return;const i=n.addr,r=[i],a={};if(1===e.length&&this.resource[e[0]])return this.resource[e[0]];for(let t of e)this.resource[t]||(a[t]=this.resource[t]=[]);!function e(n,o=0){var c,l,d,u;const f={NumberOfNamedEntries:t.readUInt16LE(n+12),NumberOfIdEntries:t.readUInt16LE(n+14)},h=[],p=f.NumberOfIdEntries+f.NumberOfNamedEntries;n+=16;for(let f=0;f<p;f++,n+=8){let f,p,m=t.readUInt32LE(n),g=t.readUInt32LE(n+4),y={name:m,id:65535&m,pad:4294901760&m,nameOffset:2147483647&m,offsetToData:g,dataIsDirectory:Boolean((2147483648&g)>>31),offsetToDirectory:2147483647&g};if(0!==o||a[y.id]){if(Boolean((2147483648&m)>>31)){const e=i+y.nameOffset,n=t.readUInt16LE(e);f=t.slice(e+2,2*n+e+2).toString("utf16le")}else p=m;if(y.dataIsDirectory){if(r.includes(i+y.offsetToDirectory))break;r.push(i+y.offsetToDirectory);let t=e(i+y.offsetToDirectory,o+1);if(void 0===t)break;h.push({struct:y,id:p,name:f,directory:t})}else{let e=i+y.offsetToDirectory,n={struct:{offsetToData:t.readUInt32LE(e),size:t.readUInt32LE(e+4),codePage:t.readUInt32LE(e+8),reserved:t.readUInt32LE(e+12)},lang:1023&y.name,subLang:y.name>>10};h.push({struct:y,id:p,name:f,data:n})}if(0===o&&16===y.id){const e=null!==(d=null===(l=null===(c=h[h.length-1].directory)||void 0===c?void 0:c.entries[0].directory)||void 0===l?void 0:l.entries)&&void 0!==d?d:[];for(const t of e){const e=null===(u=t.data)||void 0===u?void 0:u.struct;e&&s(a[16],e)}}}}return{struct:f,entries:h}}(i);for(let t of e)a[t]||(a[t]=this.resource[t]);return 1===e.length?a[e[0]]:a;function s(e,n){let i=0,o=0,r=n.offsetToData;const a=t.slice(r,r+n.size);f(o),o=c(2+i,r),a.readUInt32LE(o),a.readUInt32LE(o+4);const s=a.readUInt32LE(o+8),l=a.readUInt32LE(o+12),d=(a.readUInt32LE(o+16),a.readUInt32LE(o+20),a.readUInt32LE(o+24),a.readUInt32LE(o+28),a.readUInt32LE(o+32),a.readUInt32LE(o+36),a.readUInt32LE(o+40),a.readUInt32LE(o+44),a.readUInt32LE(o+48),{StringTable:[],Version:[s>>16,65535&s,l>>16,65535&l].join(".")});e.push(d),o=c(o+52,r);let u=f(o);if("StringFileInfo"===u.Key&&[0,1].includes(u.Type)&&0===u.ValueLength){let e=c(2+i,r);for(;;){const t=f(e),n={};for(d.StringTable.push(n),o=c(2+i,r);o<e+t.Length;){let a=o,s=f(o);o=c(2+i,r);let l=f(o,!1);o=0===s.Length?e+t.Length:c(a+s.Length,r),n[s.Key]=l.Key}if(o=c(t.Length+e,r),o===e||o>=u.Length)break;e=o}}function f(e,t=!0){let n={};return t&&(n={Length:a.readUInt16LE(e),ValueLength:a.readUInt16LE(e+2),Type:a.readUInt16LE(e+4)},e+=6),i=2*(a.indexOf(Buffer.alloc(2),e)+1>>1),{...n,Key:a.slice(e,i).toString("utf16le")}}}function c(e,t){return(e+t+3&4294967292)-(4294967292&t)}}}t.PEFile=a,t.getFileVersion=function(e){return new a(e).getResource(r.VERSION)},t.searchAndOpenPEFile=function(e,t){var n;let o,r,s="",c=[""];for(;;)try{if(o=new a(e),s&&"boolean"==typeof t&&o.isBit64!==t)throw Error();return o}catch(o){if(o instanceof Error||-4058===o.errno){if(!r){if(e.includes(":")||!(r=null===(n=process.env.Path)||void 0===n?void 0:n.split(";")))return;!1===t&&r.unshift("C:\\Windows\\SysWOW64\\"),s=e,s.toLowerCase().endsWith(".dll")||c.push(".dll")}let o;e:for(;void 0!==(o=r.pop());)for(let t of c)if(o&&(0,i.existsSync)(e=(o.endsWith("/")||o.endsWith("\\")?o:o+"\\")+s+t))break e;if(!o)return}}}},6487:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.codeActionProvider=void 0;const i=n(7147),o=n(2374),r=n(7994),a=n(3939);t.codeActionProvider=async function(e){let t,n=a.lexers[e.textDocument.uri.toLowerCase()],s=n.diagnostics,c=new RegExp(r.diagnostic.filenotexist().replace("{0}","(.+?)\\*(\\.\\w+)")),l="";for(const a of s)if(t=c.exec(a.message)){l=n.document.getText(a.range);let s=t[1],c=new RegExp(t[2]+"$","i"),d=[];for(const e of(0,i.readdirSync)(s))try{c.test(e)&&d.push(l.replace("*"+t[2],e))}catch(e){}let u={range:a.range,newText:d.join("\n")},f={title:r.codeaction.include(s+"*"+t[2]),edit:{changes:{}},kind:o.CodeActionKind.QuickFix};return f.edit.changes[e.textDocument.uri]=[u],[f]}}},4104:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colorProvider=t.colorPresentation=void 0;const i=n(3939);t.colorPresentation=async function(e){let t,n="RGB: ",o={range:e.range,newText:""},r=e.color,a=i.lexers[e.textDocument.uri.toLowerCase()].document.getText(e.range),s="";for(const e of[r.alpha,r.red,r.green,r.blue])s+=("00"+Math.round(255*e).toString(16)).substr(-2);return(t=a.match(/^(0x)?([\da-f]{6}([\da-f]{2})?)/i))?o.newText=(t[1]||"")+s.slice(-t[2].length):o.newText=s.substring(2),n+=o.newText,[{label:n,textEdit:o}]},t.colorProvider=async function(e){return i.lexers[e.textDocument.uri.toLowerCase()].colors()}},6129:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAuthor=t.generateComment=t.fixinclude=t.insertSnippet=t.executeCommands=t.noparammoveright=void 0;const i=n(1017),o=n(2374),r=n(6169),a=n(3939);async function s(e){return a.connection.sendRequest("ahk2.executeCommands",[e])}function c(e,t){a.connection.sendRequest("ahk2.insertSnippet",[e,t])}t.noparammoveright=!1,t.executeCommands=s,t.insertSnippet=c,t.fixinclude=async function(e,t){let n=a.lexers[t],r="",l=-1,d="";for(const t of n.libdirs.slice(1))if(e.startsWith(t+"\\")){r=".ahk"===(0,i.extname)(e)?`#Include <${(0,i.relative)(t,(0,a.restorePath)(e)).slice(0,-4)}>`:a.pathenv.mydocuments&&e.startsWith(a.pathenv.mydocuments+"\\autohotkey\\lib")?`#Include '%A_MyDocuments%\\AutoHotkey\\Lib\\${(0,i.basename)((0,a.restorePath)(e))}'`:`#Include '${(0,a.restorePath)(e)}'`;for(const e of n.includedir)l=e[0]+1}if(""===r){for(const t of n.includedir)e.startsWith(t[1]+"\\")?t[1].length>d.length&&(l=t[0]+1,d=t[1]):!d&&e.startsWith((0,i.resolve)(t[1],"..")+"\\")&&(l=t[0]+1,d=t[1]);d=d||n.scriptpath,r=d.charAt(0)!==e.charAt(0)?`#Include '${(0,a.restorePath)(e)}'`:`#Include '${(0,i.relative)(d,(0,a.restorePath)(e))}'`}if(-1===l)l=n.document.lineCount,r="\n\n"+r;else{let e=n.document.getText({start:{line:l-1,character:0},end:{line:l,character:0}}).match(/^\s+/);r=(e?e[0]:"")+r,l<n.document.lineCount&&(r+="\n")}let{pos:u}=await a.connection.sendRequest("ahk2.getpos"),f=n.document.getText(o.Range.create(u.line,u.character-1,u.line,u.character));u.line<l&&(r="\n"+r),await a.connection.workspace.applyEdit({changes:{[n.document.uri]:[o.TextEdit.insert({line:l,character:0},r)]}}),"("===f?s([{command:"editor.action.triggerParameterHints"}]):(l<=u.line&&u.line++,c("$0",o.Range.create(u,u)),"."===f&&s([{command:"editor.action.triggerSuggest"}]))},t.generateComment=async function(e){var t;0===e.length&&await s([{command:"undo",wait:!0},{command:"undo",wait:!0}]);let{uri:n,pos:i}=await a.connection.sendRequest("ahk2.getpos"),l=a.lexers[n=n.toLowerCase()],d=l.searchScopedNode(i),u=(null==d?void 0:d.children)||l.children;for(const e of u)if((e.kind===o.SymbolKind.Function||e.kind===o.SymbolKind.Method)&&e.selectionRange.start.line===i.line&&e.selectionRange.start.character<=i.character&&i.character<=e.selectionRange.end.character){d=e;break}if(d&&(d.kind===o.SymbolKind.Function||d.kind===o.SymbolKind.Method)){let e,n=d.range.start.line;if(e=l.document.getText({start:{line:n,character:0},end:{line:n+1,character:0}}).match(/^(\s*)((static|macro)\s*)?\S+\(/i)){let a,s,u,f=d,h=["/**"],p=0,m=e[1].length,g=null===(t=d.detail)||void 0===t?void 0:t.split("\n"),y={},b=[],_=[];if(g){let e=!1,t={line:-1,character:0},i={line:-1,character:0};for(let o=n-1;o>=0;o--){let n=l.document.getText({start:{line:o,character:0},end:{line:o+1,character:0}});if(e){if(u=n.match(/^\s*\/\*/)){t.line=o,t.character=u[0].length-2;break}}else{if(u=n.match(/^\s*;/)){t.line=i.line=o,t.character=u[0].length-1,i.character=n.length;break}if(!(u=n.match(/\*\/((\s+.*)?)$/)))break;i.line=o,i.character=n.length-u[1].length,e=!0}}i.line>=t.line&&t.line>-1&&(a={start:t,end:i}),g.map((e=>{(u=e.match(/^@(param|参数)\s+(\S+)([\s|:]\s*(.*))?$/i))?s=y[u[2].toLowerCase()]=[u[4]]:(u=e.match(/^@(returns|返回值)([\s|:]\s*(.*))?$/i))?(s=b,b.push(u[3])):s&&"@"!==e.charAt(0)?s.push(e):(s=void 0,_.push(e))}))}if(_.length?_.map((e=>h.push(" * "+e))):(h.push(" * $1"),p++),f.params.map((e=>{(s=y[e.name.toLowerCase()])?(h.push(` * @param ${e.name} ${s.shift()}`),s.map((e=>h.push(" * "+e)))):h.push(` * @param ${e.name} $${(++p).toString()}`)})),Object.keys(f.returntypes||{}).length)if(b.length)h.push(` * @returns ${b.shift()}`),b.map((e=>h.push(" * "+e)));else{let e,t=[],n={};for(const t in f.returntypes)(0,r.cleardetectcache)(),(0,r.detectExp)(l,t,o.Position.is(e=f.returntypes[t])?e:i).map((e=>n[e.replace(/^\s*[@#]/,"")]=!0));t=Object.keys(n),n.any&&t.length>1&&(delete n.any,t=Object.keys(n)),h.push(` * @returns \${${(++p).toString()+":"+(t.length?t.join(", "):"")}}`)}if(0===p)return;h.push(" */"),a||(a=o.Range.create(n,m,n,m),h.push("")),c(h.join("\n"),a)}}},t.generateAuthor=async function(){let e=["/************************************************************************"," * @description ${1:}"," * @file $TM_FILENAME"," * @author ${2:}"," * @date ${3:$CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE}"," * @version ${4:0.0.0}"," ***********************************************************************/","$0"];await s([{command:"undo",wait:!0},{command:"undo",wait:!0}]);let{uri:t,pos:n}=await a.connection.sendRequest("ahk2.getpos"),i=a.lexers[t=t.toLowerCase()],r=i.get_tokon(0),l=o.Range.create(0,0,0,0);r.type.endsWith("COMMENT")&&"TK_BLOCK_COMMENT"===r.type&&r.content.match(/@(version|版本)\b/i)||(0===i.document.positionAt(r.offset).line&&e.push(""),c(e.join("\n"),l))}},3939:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=t.set_Workfolder=t.set_locale=t.set_dirname=t.set_ahkpath=t.set_ahk_h=t.clearLibfuns=t.parseWorkspaceFolders=t.inWorkspaceFolders=t.getallahkfiles=t.loadahk2=t.initahk2cache=t.sendDiagnostics=t.getwebfile=t.getlocalefile=t.getlocalefilepath=t.restorePath=t.openFile=t.set_Connection=t.LibIncludeType=t.locale=t.getDllExport=t.winapis=t.extsettings=t.dllcalltpe=t.completionItemCache=t.pathenv=t.lexers=t.libdirs=t.hoverCache=t.symbolcache=t.libfuncs=t.ahkvars=t.inBrowser=t.isahk2_h=t.dirname=t.workspaceFolders=t.ahkpath_cur=t.connection=void 0;const r=n(6288),a=n(2880),s=n(6630),c=n(7147),l=n(1017),d=n(6169),u=n(7994);o(n(6169),t),o(n(6487),t),o(n(4104),t),o(n(6129),t),o(n(6810),t),o(n(3113),t),o(n(2793),t),o(n(9541),t),o(n(7994),t),o(n(6658),t),o(n(5932),t),o(n(9770),t),o(n(6001),t),o(n(5373),t),o(n(5116),t);const f=n(7994);function h(e){if(t.inBrowser){let t=m(e);return t?r.TextDocument.create(t.url,"ahk2",-10,t.text):void 0}{let n;if(n=(0,c.readFileSync)(e),255===n[0]&&254===n[1])n=n.toString("utf16le");else if(239===n[0]&&187===n[1]&&191===n[2])n=n.toString("utf8").substring(1);else{let i=Math.min(n.byteLength,256),o=0,r=0,a=0;for(;o<i;)if(r=n[o],r<128)o++;else{if(!(r>=192&&r<255))return void t.connection.window.showErrorMessage(f.diagnostic.invalidencoding(e));if(a=r<224?1:r<240?2:r<248?3:r<252?4:r<254?5:6,o+a>=i)break;for(++o;a;--a)if(128!=(192&n[o++]))return void t.connection.window.showErrorMessage(f.diagnostic.invalidencoding(e))}n=n.toString("utf8")}return r.TextDocument.create(s.URI.file(e).toString(),"ahk2",-10,n)}}function p(e){let n,i=e.match(/<>./);if(i){if((0,c.existsSync)(n=e.replace("<>",t.locale)))return n;if("zh-tw"===t.locale.toLowerCase()&&(0,c.existsSync)(n=e.replace("<>","zh-cn")))return n;if((0,c.existsSync)(n=e.replace(i[0],"")))return n}else if((0,c.existsSync)(e))return e}function m(e){let n,i=e.match(/<>./),o=[],r=new XMLHttpRequest;if(i?(o.push(e.replace("<>",t.locale)),"zh-tw"===t.locale.toLowerCase()&&o.unshift(e.replace("<>","zh-cn")),o.unshift(e.replace(i[0],""))):o.push(e),n=o.pop())return function e(t){return r.open("GET",t,!1),r.send(),200===r.status?{url:t,text:r.responseText}:(n=o.pop())?e(n):void 0}(n)}function g(e,t=3){let n=[];return(0,c.existsSync)(e)&&(0,c.statSync)(e).isDirectory()&&function e(i,o){(0,c.readdirSync)(i).map((r=>{let a=(0,l.resolve)(i,r);(0,c.statSync)(a).isDirectory()?o<t&&e(a,o+1):r.match(/\.(ahk2?|ah2)$/i)&&n.push(a.toLowerCase())}))}(e,0),n}async function y(e){return new Promise((t=>setTimeout(t,e)))}var b;t.ahkpath_cur="",t.workspaceFolders=[],t.dirname="",t.isahk2_h=!1,t.inBrowser=!1,t.ahkvars={},t.libfuncs={},t.symbolcache={},t.hoverCache=[{},{}],t.libdirs=[],t.lexers={},t.pathenv={},t.completionItemCache={sharp:[],method:[],other:[],constant:[],snippet:[]},t.dllcalltpe=[],t.extsettings={InterpreterPath:"C:\\Program Files\\AutoHotkey\\AutoHotkey32.exe",AutoLibInclude:0,CompleteFunctionParens:!1,diagnostics:{ParamsCheck:!0},SymbolFoldingFromOpenBrace:!1},t.winapis=[],t.getDllExport=(e,t=!1)=>[],t.locale="en-us",(b=t.LibIncludeType||(t.LibIncludeType={}))[b.Disabled=0]="Disabled",b[b.Local=1]="Local",b[b["User and Standard"]=2]="User and Standard",b[b.All=3]="All",t.set_Connection=function(e,n,i){t.connection=e,t.inBrowser=n,i&&(t.getDllExport=i)},t.openFile=h,t.restorePath=function(e){if(!(0,c.existsSync)(e))return e;let t=e.toUpperCase().split("\\"),n=1,i=t[0];for(;n<t.length;){for(const e of(0,c.readdirSync)(i+"\\"))if(e.toUpperCase()===t[n]){i+="\\"+e;break}n++}return i.toLowerCase()===e?i:e},t.getlocalefilepath=p,t.getlocalefile=function(e,t){let n=p(e);if(n)return(0,c.readFileSync)(n,t?{encoding:t}:void 0)},t.getwebfile=m,t.sendDiagnostics=function(){let e;for(const n in t.lexers)e=t.lexers[n],t.connection.sendDiagnostics({uri:e.document.uri,diagnostics:e.actived||e.relevance&&Object.keys(e.relevance).length?e.diagnostics:[]})},t.initahk2cache=function(){t.ahkvars={},t.dllcalltpe=["str","astr","wstr","int64","int","uint","short","ushort","char","uchar","float","double","ptr","uptr","HRESULT"],t.completionItemCache={sharp:[],method:[],other:[],constant:[],snippet:!t.inBrowser&&process.env.AHK2_LS_CONFIG?[]:[{label:"zs-Comment",detail:u.completionitem.comment(),kind:a.CompletionItemKind.Snippet,command:{title:"ahk2.generate.comment",command:"ahk2.generate.comment",arguments:[]}},{label:"zs-Author",detail:u.completionitem.author(),kind:a.CompletionItemKind.Snippet,command:{title:"ahk2.generate.author",command:"ahk2.generate.author"}}]}},t.loadahk2=async function(e="ahk2"){let n;const i={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"};let o,r,s="",u=a.Range.create(0,0,0,0);if(t.inBrowser){const n=t.dirname+`/syntaxes/<>/${e}`;let i=h(n+".d.ahk");if(i){let e=new d.Lexer(i);e.parseScript(!0),t.lexers[e.uri]=e}let o=m(n+".json");o&&f(JSON.parse(o.text))}else{const i=(0,l.resolve)(__dirname,`../../syntaxes/<>/${e}`);if(n=p(i+".d.ahk")){let e=new d.Lexer(h(n));e.parseScript(!0),t.lexers[e.uri]=e}if(!(n=p(i+".json")))return;f(JSON.parse((0,c.readFileSync)(n,{encoding:"utf8"})))}function f(e){for(const n in e)if("snippet"===n)for(r of e.snippet){const e=a.CompletionItem.create(r.prefix);e.kind=a.CompletionItemKind.Snippet,e.insertText=y(r.body),e.detail=r.description,e.insertTextFormat=a.InsertTextFormat.Snippet,t.completionItemCache.snippet.push(e)}else{let t=e[n];switch(n){case"keywords":o=a.CompletionItemKind.Keyword;break;case"functions":o=a.CompletionItemKind.Function;break;case"variables":o=a.CompletionItemKind.Variable;break;case"constants":o=a.CompletionItemKind.Constant;break;default:o=a.CompletionItemKind.Text}for(r of t)g()}}function g(){const e=a.CompletionItem.create(r.prefix.replace(".","")),n={contents:[]},c=r.prefix.toLowerCase();if(e.kind=o,o===a.CompletionItemKind.Keyword&&"#"===r.prefix.charAt(0)?(s="sharp",r.body=y(r.body).replace(/^#/,"")):s=o===a.CompletionItemKind.Constant?"constant":"other",o===a.CompletionItemKind.Function&&-1===r.body.indexOf("|}")&&-1!==r.body.indexOf("(")?(e.insertText=r.prefix+"($0)",e.command=i,e.detail=r.description):o===a.CompletionItemKind.Constant?(e.insertText="${1:"+r.prefix+" := }"+r.body+"$0",e.detail=r.body):(e.insertText=r.body.replace(/\$\{\d:\s*\[,[^\]\}]+\]\}/,(()=>(e.command=i,""))),e.detail=r.description),e.insertTextFormat=a.InsertTextFormat.Snippet,r.body=r.body.replace(/\$\{\d+((\|)|:)([^}]*)\2\}|\$\d/g,((...e)=>e[2]?e[3].replace(/,/g,"|"):e[3]||"")),e.documentation={kind:a.MarkupKind.Markdown,value:"```ahk2\n"+r.body+"\n```"},o!==a.CompletionItemKind.Function&&t.completionItemCache[s].push(e),o===a.CompletionItemKind.Constant||o===a.CompletionItemKind.Text)return;n.contents={kind:a.MarkupKind.Markdown,value:"```ahk2\n"+r.body+"\n```\n\n"+r.description};let l=o===a.CompletionItemKind.Function?0:1;if(t.hoverCache[l][c]||(t.hoverCache[l][c]=[]),!l){let e=d.FuncNode.create(r.prefix,a.SymbolKind.Function,u,u,r.body.replace(/^\w+[(\s]?|\)/g,"").split(",").map((e=>a.DocumentSymbol.create(e.replace(/[\[\]\s]/g,""),void 0,a.SymbolKind.Variable,u,u))));e.full=e.full.replace(/(['\w]*\|['\w]*)(\|['\w]*)+/,((...e)=>(r.body=r.body.replace(e[0],e[1]+"|..."),e[1]+"|..."))),e.detail=r.description,t.ahkvars[c]=e}r.description&&t.hoverCache[l][c].push(n)}function y(e){return"object"==typeof e?e.join("\n"):e}},t.getallahkfiles=g,t.inWorkspaceFolders=function(e){e=e.toLowerCase();for(let n of t.workspaceFolders)if(e.startsWith(n))return n;return""},t.parseWorkspaceFolders=async function(){let e;if(t.inBrowser){let n=await t.connection.sendRequest("ahk2.getWorkspaceFiles",[])||[];for(let i of n)if(!t.lexers[e=i.toLowerCase()]){let n=await t.connection.sendRequest("ahk2.getWorkspaceFileContent",[i]);if(n){let o=new d.Lexer(r.TextDocument.create(i,"ahk2",-10,n));o.parseScript(),t.lexers[e]=o,await y(100)}}}else for(let n of t.workspaceFolders){let i,o=s.URI.parse(n).fsPath;for(let n of g(o))if(e=s.URI.file(n).toString().toLowerCase(),!t.lexers[e]&&(i=h(n))){let n=new d.Lexer(i);n.parseScript(),t.lexers[e]=n,await y(100)}}},t.clearLibfuns=function(){t.libfuncs={}},t.set_ahk_h=function(e){t.isahk2_h=e},t.set_ahkpath=function(e){t.ahkpath_cur=e},t.set_dirname=function(e){t.dirname=e.replace(/[/\\]$/,"")},t.set_locale=function(e){e&&(t.locale=e)},t.set_Workfolder=function(e){t.workspaceFolders=e||[]},t.sleep=y},6810:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completionProvider=void 0;const i=n(7147),o=n(1017),r=n(2374),a=n(6630),s=n(6169),c=n(7994),l=n(3939);function d(e){let t=r.CompletionItem.create(e.name);switch(e.kind){case r.SymbolKind.Function:case r.SymbolKind.Method:t.kind=e.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Function,l.extsettings.CompleteFunctionParens?e.params.length?(t.command={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"},e.params[0].name.includes("|")?(t.insertText=t.label+"(${1|"+e.params[0].name.replace(/\|/g,",")+"|})",t.insertTextFormat=r.InsertTextFormat.Snippet):(t.insertText=t.label+"($0)",t.insertTextFormat=r.InsertTextFormat.Snippet)):t.insertText=t.label+"()":t.commitCharacters=["\t","("],t.detail=e.full,t.documentation=e.detail;break;case r.SymbolKind.Variable:case r.SymbolKind.TypeParameter:t.kind=r.CompletionItemKind.Variable,t.detail=e.detail;break;case r.SymbolKind.Class:t.kind=r.CompletionItemKind.Class,t.commitCharacters=[".","("],t.detail="class "+t.label,t.documentation=e.detail;break;case r.SymbolKind.Event:t.kind=r.CompletionItemKind.Event;break;case r.SymbolKind.Field:t.kind=r.CompletionItemKind.Field,t.label=t.insertText=t.label.replace(/:$/,"");break;case r.SymbolKind.Property:if(t.kind=r.CompletionItemKind.Property,t.detail=e.full||t.label,t.documentation=e.detail||"",e.children)for(const n of e.children)if(n.kind===r.SymbolKind.Function&&"get"===n.name.toLowerCase()&&n.params.length){t.insertTextFormat=r.InsertTextFormat.Snippet,t.insertText=t.label+"[$0]";break}break;default:t.kind=r.CompletionItemKind.Text}return t}t.completionProvider=async function(e,t){var n,u,f,h,p,m,g,y,b;if(t.isCancellationRequested||null===(null===(n=e.context)||void 0===n?void 0:n.triggerCharacter))return;const{position:_,textDocument:v}=e,T=[],R={},k={};let S,C,w,x=!0,E=null===(u=e.context)||void 0===u?void 0:u.triggerKind,O=v.uri.toLowerCase(),D=l.lexers[O],K=D.buildContext(_,!1),P="",A="",L="",N=!1,M=K.linetext,I=M.charAt(K.range.start.character-1),q=D.relevance,F={label:""},{line:j,character:W}=_,$=new RegExp(K.text.match(/[^\w]/)?K.text.replace(/(.)/g,"$1.*"):"("+K.text.replace(/(.)/g,"$1.*")+"|[^\\w])","i"),U=D.instrorcomm(_);if(1!==U){if(U){if(2===E)return;I=""}else for(let e=0;e<_.character;e++)if(A=M.charAt(e),P===A){if("`"===M.charAt(e-1))continue;P="",N=!1}else"%"===A?N=!N:""!==P||'"'!==A&&"'"!==A||0!==e&&!M.charAt(e-1).match(/[([%,\s]/)||(P=A);if(!N&&"."===I&&K.pre.match(/^\s*#(include|dllload)/i)&&(I="###"),C=M.match(/^\s*((class\s+(\w|[^\x00-\xff])+\s+)?(extends)|class)\s/i)){if("."===I)return C[3]&&(null===(f=(0,s.searchNode)(D,D.buildContext(_,!0).text.replace(/\.[^.]*$/,"").toLowerCase(),_,r.SymbolKind.Class))||void 0===f||f.map((e=>{Object.values((0,s.getClassMembers)(D,e.node,!0)).map((e=>{e.kind===r.SymbolKind.Class&&!R[L=e.name.toLowerCase()]&&$.test(L)&&(T.push(d(e)),R[L]=!0)}))}))),T;if(!C[3]&&!C[2])return F=r.CompletionItem.create("extends"),F.kind=r.CompletionItemKind.Keyword,[F];let e=[D.declaration];for(const t in q)l.lexers[t]&&e.push(l.lexers[t].declaration);e.map((e=>{for(const t in e)e[t].kind===r.SymbolKind.Class&&!R[t]&&$.test(t)&&(T.push(d(e[t])),R[t]=!0)}));for(const e in l.ahkvars)l.ahkvars[e].kind===r.SymbolKind.Class&&!R[e]&&$.test(e)&&(T.push(d(l.ahkvars[e])),R[e]=!0);return T}switch(I){case"#":return T.push(...l.completionItemCache.sharp),T.push(...l.completionItemCache.snippet),T;case".":let e=D.buildContext(_,!0);if(e.text.match(/\b\d+\.$/)||e.linetext.match(/(^|\s)\.$/))return;K.pre=e.text.slice(0,""===K.text&&K.pre.match(/\.$/)?-1:-K.text.length),K.text=e.text,K.kind=e.kind,K.linetext=e.linetext;let t=K.pre.replace(/('|").*?(?<!`)\1/,"''"),n=!0,u={},f=!0,v=[],P=!1,A=!1,I=!1,j={};if(t=K.pre.toLowerCase(),(0,s.cleardetectcache)(),(0,s.detectExpType)(D,t,_,j),void 0===j["#any"]){for(const e in j)if(n=!1,f=!e.match(/[@#][^.]+$/),j[e]){let t=j[e].node.kind;if(t===r.SymbolKind.Function||t===r.SymbolKind.Method){if(A)continue;A=!0,l.ahkvars.func&&(v.push(l.ahkvars.func),f=!1)}v.push(j[e].node)}else null===(h=(0,s.searchNode)(D,e,_,r.SymbolKind.Variable))||void 0===h||h.map((e=>{v.push(e.node)}));if(void 0!==j["#object"]){let e,n=(0,s.searchNode)(D,t,_,r.SymbolKind.Variable);n&&(e=n[0].node.property)&&e.map((e=>{u[L=e.toLowerCase()]||(T.push(u[L]=r.CompletionItem.create(e)),u[L].kind=r.CompletionItemKind.Property)}))}}(j=l.ahkvars.any)&&v.push(j);for(const e of v)switch(e.kind){case r.SymbolKind.Class:Object.values((0,s.getClassMembers)(D,e,f)).map((e=>{$.test(e.name)&&(e.kind===r.SymbolKind.Property||e.kind===r.SymbolKind.Class?u[L=e.name.toLowerCase()]?u[L].detail!==e.full&&(u[L].detail="(...) "+e.name,u[L].insertText=e.name):T.push(u[L]=d(e)):e.kind===r.SymbolKind.Method&&(e.name.match(/^__(get|set|call|new|delete)$/i)||(u[L=e.name.toLowerCase()]?u[L].detail!==e.full&&(u[L].detail="(...) "+e.name+"()",u[L].documentation=""):T.push(u[L]=d(e)))))}));break;case r.SymbolKind.Object:I=!0}if(!n&&(1!==E||K.text.match(/\..{0,2}$/)))return T;let W=[D.object];for(const e in q)W.push(l.lexers[e].object);for(const e of W){if(e===D.object){for(const t in e.property)if($.test(t))if(u[t])u[t].detail=u[t].label;else{let n=e.property[t];B(n)||T.push(u[t]=d(n))}}else for(const t in e.property)$.test(t)&&(u[t]?u[t].detail=u[t].label:T.push(u[t]=d(e.property[t])));for(const t in e.method)$.test(t)&&(u[t]?"object"==typeof u[t]&&(u[t].detail="(...) "+u[t].label):T.push(u[t]=d(e.method[t][0])))}for(const e in l.ahkvars){if(I&&"object"===e||A&&"func"===e||P&&"class"===e||"any"===e||!l.ahkvars[e].children)continue;let t=[];null===(p=l.ahkvars[e].children)||void 0===p||p.map((e=>{e.kind===r.SymbolKind.Class?t.push(...e.children):t.push(e)})),t.map((e=>{e.kind!==r.SymbolKind.Class&&$.test(L=e.name.toLowerCase())&&(u[L]?u[L].detail!==e.full&&(u[L].detail="(...) "+e.name,u[L].insertText=e.name,u[L].documentation=void 0):T.push(u[L]=d(e)))}))}return T;default:if(C=M.match(/^\s*#(include|(dllload))/i)){if(l.inBrowser)return;let e,t=M.replace(/^\s*#(include(again)?|dllload)\s+/i,"").replace(/\s*\*i\s+/i,""),n=[],s=!1,c="",d=M.substring(M.length-t.length,_.character),u="\\",f="",h=!!C[2];if(N)return l.completionItemCache.other.map((e=>{e.kind===r.CompletionItemKind.Variable&&y.test(e.label)&&T.push(e)})),T;if(d.match(/\s+;/))return;if(d.charAt(0).match(/['"<]/)){if(d.substring(1).match(/['">]/))return;if("<"===(c=d.charAt(0))){if(h)return;s=!0,n=D.libdirs}else h||(n=(C=D.includedir.get(_.line))?[C]:[D.scriptpath]);d=d.substring(1),c="<"===c?">":c,-1!==M.substring(_.character).indexOf(c)&&(c="")}else h||(n=(C=D.includedir.get(_.line))?[C]:[D.scriptpath]);for(d=d.replace(/[^\\/]*$/,"");e=d.match(/%a_(\w+)%/i);)if(l.pathenv[f=e[1].toLowerCase()])d=d.replace(e[0],l.pathenv[f]);else if("scriptdir"===f)d=d.replace(e[0],D.scriptdir);else{if("linefile"!==f)return;d=d.replace(e[0],a.URI.parse(D.uri).fsPath)}"/"===d.charAt(d.length-1)&&(u="/");let p=h?new RegExp(/\.(dll|ocx|cpl)$/i):s?new RegExp(/\.ahk$/i):new RegExp(/\.(ahk2?|ah2)$/i),m=t.replace(/['"<>]/g,"").replace(/^.*[\\/]/,"");if(m.includes("*"))return;let g,y=new RegExp((m.match(/[^\w]/)?m.replace(/(.)/g,"$1.*"):"("+m.replace(/(.)/g,"$1.*")+"|[^\\w])").replace(/\.\./,"\\.."),"i");h&&(n=[(C=D.dlldir.get(_.line))?C:D.scriptpath,"C:\\Windows\\System32"]),m.includes(".")&&(g=r.TextEdit.replace({start:{line:_.line,character:_.character-m.length},end:_},""));for(let e of n)if((0,i.existsSync)(e=(0,o.resolve)(e,d)+"\\")&&(0,i.statSync)(e).isDirectory()){for(let t of(0,i.readdirSync)(e))try{(0,i.statSync)(e+t).isDirectory()?y.test(t)&&(V(t,r.CompletionItemKind.Folder),F.command={title:"Trigger Suggest",command:"editor.action.triggerSuggest"},g?F.textEdit=Object.assign({},g,{newText:F.label+u}):F.insertText=F.label+u):p.test(t)&&y.test(s?t=t.replace(p,""):t)&&(V(t,r.CompletionItemKind.File),g?F.textEdit=Object.assign({},g,{newText:F.label+c}):F.insertText=F.label+c)}catch(e){}if(d.includes(":"))break}return T}if(C=M.match(/(?<!\.)\b(goto|continue|break)\b(?!\s*:)(\s+|\(\s*('|")?)/i)){let e=C[2].trim();if(S=D.searchScopedNode(_))null===(m=S.children)||void 0===m||m.map((e=>{e.kind===r.SymbolKind.Field&&$.test(e.name)&&T.push(d(e))}));else{D.children.map((e=>{e.kind===r.SymbolKind.Field&&$.test(e.name)&&T.push(d(e))}));for(const e in q)l.lexers[e].children.map((e=>{e.kind===r.SymbolKind.Field&&$.test(e.name)&&T.push(d(e))}))}if(""===e||C[3])return T;for(let e of T)e.insertText=`'${e.insertText}'`}else{if(U){let e=(0,s.getFuncCallInfo)(D,_);if(e)switch(e.name){case"add":if(0===e.index&&"."===M.charAt(e.pos.character-1)){let t=D.buildContext(e.pos,!0),n=(0,s.searchNode)(D,t.text,e.pos,r.SymbolKind.Method);if(n&&(null===(g=n[0].node.full)||void 0===g?void 0:g.match(/\(gui\)\s+add\(/i)))return["Text","Edit","UpDown","Picture","Button","Checkbox","Radio","DropDownList","ComboBox","ListBox","ListView","TreeView","Link","Hotkey","DateTime","MonthCal","Slider","Progress","GroupBox","Tab","Tab2","Tab3","StatusBar","ActiveX","Custom"].map(H)}break;case"dynacall":if(0!==e.index)break;case"dllcall":if(0===e.index){if(l.inBrowser)break;let t=D.document.offsetAt(e.pos),n=Object.values(D.tokens),o=n.findIndex((e=>e.offset===t));if(o>-1){for(o++;n[o]&&(n[o].type.endsWith("COMMENT")||"("===n[o].content);)o++;if(n[o]&&"TK_STRING"===n[o].type){let e=D.document.offsetAt(_);if(e>n[o].offset&&e<=n[o].offset+n[o].length){let t=n[o].content.substring(1,e-n[o].offset),a=[D],s={};for(let e in q)a.push(l.lexers[e]);if(T.splice(0),t.match(/[\\/]/)){let e={},n=!0;return L=t.replace(/[\\/][^\\/]*$/,"").replace(/\\/g,"/").toLowerCase(),L.match(/\.\w+$/)||(L+=".dll"),L.includes(":")?n=!1:L.includes("/")?L.startsWith("/")?e[D.scriptpath+L]=1:e[D.scriptpath+"/"+L]=1:a.map((t=>{t.dllpaths.map((t=>{t.endsWith(L)&&(e[t]=1,n&&t.includes("/")&&(n=!1))})),n&&(e[t.scriptpath+"/"+L]=1)})),(0,l.getDllExport)(Object.keys(e),!0).map((e=>V(e,r.CompletionItemKind.Function))),T}return a.map((e=>e.dllpaths.map((e=>{e=e.replace(/^.*[\\/]/,"").replace(/\.dll$/i,""),s[L=e.toLowerCase()]||(s[L]=!0,V(e+"\\",r.CompletionItemKind.File))})))),(0,i.readdirSync)("C:\\Windows\\System32").map((e=>{e.toLowerCase().endsWith(".dll")&&$.test(e=e.slice(0,-4))&&V(e+"\\",r.CompletionItemKind.File)})),l.winapis.map((e=>{$.test(e)&&V(e,r.CompletionItemKind.Function)})),T}}}}else if(e.index>0&&e.index%2==1){for(const e of["cdecl"].concat(l.dllcalltpe))V(e,r.CompletionItemKind.TypeParameter),F.commitCharacters=["*"];return T}break;case"comcall":if(e.index>1&&e.index%2==0){for(const e of["cdecl"].concat(l.dllcalltpe))V(e,r.CompletionItemKind.TypeParameter),F.commitCharacters=["*"];return T}break;case"numget":if(2===e.index||1===e.index){for(const e of l.dllcalltpe.filter((e=>!e.match(/str$/i))))V(e,r.CompletionItemKind.TypeParameter);return T}break;case"numput":if(e.index%2==0){for(const e of l.dllcalltpe.filter((e=>!e.match(/str$/i))))V(e,r.CompletionItemKind.TypeParameter);return T}break;case"objbindmethod":if(1===e.index){let e,t={};if(["new","delete","get","set","call"].map((e=>{t["__"+e]=!0})),C=K.pre.match(/objbindmethod\(\s*(([\w.]|[^\x00-\xff])+)\s*,/i)){let n={};if((0,s.cleardetectcache)(),(0,s.detectExpType)(D,C[1],_,n),void 0===n["#any"])for(const i in n)!1===n[i]?e=(0,s.searchNode)(D,i,_,r.SymbolKind.Class):n[i]&&(e=[n[i]]),null==e||e.map((e=>{Object.values((0,s.getClassMembers)(D,e.node,!i.match(/[@#][^.]+$/))).map((e=>{e.kind===r.SymbolKind.Method&&!t[C=e.name.toLowerCase()]&&$.test(C)&&(t[C]=!0,V(e.name,r.CompletionItemKind.Method))}))}))}if(!e){let e=[D.object.method];for(const t in q)e.push(l.lexers[t].object.method);for(const n of e)for(const e in n)!t[e]&&$.test(e)&&(t[e]=!0,V(n[e][0].name,r.CompletionItemKind.Method))}return T}break;case"processsetpriority":if(0===e.index)return["Low","BelowNormal","Normal","AboveNormal","High","Realtime"].map(H);break;case"thread":if(0===e.index)return["NoTimers","Priority","Interrupt"].map(H);break;case"settitlematchmode":if(0===e.index)return["Fast","Slow","RegEx"].map(H);break;case"setnumlockstate":case"setcapslockstate":case"setscrolllockstate":if(0===e.index)return["On","Off","AlwaysOn","AlwaysOff"].map(H);break;case"sendmode":if(0===e.index)return["Event","Input","InputThenPlay","Play"].map(H);break;case"blockinput":if(0===e.index)return["On","Off","Send","Mouse","SendAndMouse","Default","MouseMove","MouseMoveOff"].map(H);break;case"coordmode":if(0===e.index)return["ToolTip","Pixel","Mouse","Caret","Menu"].map(H);if(1===e.index)return["Screen","Window","Client"].map(H)}x&&l.completionItemCache.other.map((e=>{e.kind===r.CompletionItemKind.Text&&$.test(e.label)&&(R[e.label.toLowerCase()]=!0,T.push(e))}));for(const e in R)k[e]=!0;for(const e in D.texts)!k[e]&&$.test(e)&&(k[e]=!0,V(D.texts[e],r.CompletionItemKind.Text));for(const e in q)for(const t in C=l.lexers[e].texts)!k[t]&&$.test(t)&&(k[t]=!0,V(C[t],r.CompletionItemKind.Text));return T}x=!N}if(S=D.searchScopedNode(_))if(S.kind===r.SymbolKind.Class){let e=[],t=M.trim();if(t.match(/^\S*$/)){if(l.completionItemCache.other.map((t=>{var n;if(t.label.match(/\b(static|class)\b/))e.push(t);else if(t.label.match(/^__\w+/)){let i=Object.assign({},t);i.insertText=(null===(n=i.insertText)||void 0===n?void 0:n.replace("$0","$1"))+" {\n\t$0\n}",e.push(i)}})),_.line===S.range.end.line&&_.character>S.range.end.character)return;return e}if(t.match(/^(static\s+)?(\w|[^\x00-\xff])+(\(|$)/i))return l.completionItemCache.other.filter((e=>e.label.match(/^__\w+/))).map((e=>{var t;let n=Object.assign({},e);return n.insertText=(null===(t=n.insertText)||void 0===t?void 0:t.replace("$0","$1"))+" {\n\t$0\n}",n}))}else if(S.kind===r.SymbolKind.Property&&S.children)return[{label:"get",kind:r.CompletionItemKind.Function},{label:"set",kind:r.CompletionItemKind.Function}];for(const e in l.ahkvars)$.test(e)&&(R[e]=d(l.ahkvars[e]));Object.values(D.declaration).map((e=>{!$.test(L=e.name.toLowerCase())||B(e)||R[L]&&e.kind===r.SymbolKind.Variable||(R[L]=d(e))}));for(const e in q){w=q[e].path;for(const t in C=null===(y=l.lexers[e])||void 0===y?void 0:y.declaration)$.test(t)&&(!R[t]||R[t].kind===r.CompletionItemKind.Variable&&C[t].kind!==r.SymbolKind.Variable)&&(F=d(C[t]),F.detail=`${c.completionitem.include(w)}  `+(F.detail||""),R[t]=F)}S&&D.getScopeChildren(S).map((e=>{!$.test(L=e.name.toLowerCase())||R[L]&&e.kind===r.SymbolKind.Variable&&!e.returntypes||(R[L]=d(e))})),l.completionItemCache.other.map((e=>{$.test(e.label)&&(e.kind===r.CompletionItemKind.Text?S||N||T.push(e):e.kind===r.CompletionItemKind.Function?R[L=e.label.toLowerCase()]||(R[L]=e):T.push(e))}));let z=(0,l.inWorkspaceFolders)(D.document.uri)||D.scriptdir,G=0;if(l.extsettings.AutoLibInclude)for(const e in l.libfuncs)if((!q||!q[e])&&(w=a.URI.parse(e).fsPath,(l.extsettings.AutoLibInclude>1&&l.libfuncs[e].islib||1&l.extsettings.AutoLibInclude&&w.startsWith(z))&&(l.libfuncs[e].map((e=>{!R[L=e.name.toLowerCase()]&&$.test(L)&&(F=d(e),F.detail=`${c.completionitem.include(w)}  `+(F.detail||""),F.command={title:"ahk2.fix.include",command:"ahk2.fix.include",arguments:[w,O]},delete F.commitCharacters,R[L]=F,G++)})),G>300)))break;return null===(b=null==S?void 0:S.children)||void 0===b||b.map((e=>{R[L=e.name.toLowerCase()]||!$.test(L)||B(e)||(R[L]=d(e))})),x&&function(){if(T.push(...l.completionItemCache.snippet),1===E&&K.text.length>2&&K.text.match(/^[a-z]+_/i)){const e=l.completionItemCache.constant;for(const t of e)$.test(t.label)&&T.push(t)}}(),T.concat(Object.values(R))}}function V(e,t){T.push(F=r.CompletionItem.create(e)),F.kind=t}function B(e){return e.range.end.line===j&&e.range.start.character<=W&&W<=e.range.end.character}function H(e){const t=r.CompletionItem.create(e);return t.kind=r.CompletionItemKind.Text,t.command={title:"cursorRight",command:"cursorRight"},t}}},4780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.builtin_variable_h=t.builtin_variable=void 0,t.builtin_variable=["a_priorline","a_workfilename","true","false","a_ahkpath","a_ahkversion","a_allowmainwindow","a_appdata","a_appdatacommon","a_args","a_clipboard","a_computername","a_comspec","a_controldelay","a_coordmodecaret","a_coordmodemenu","a_coordmodemouse","a_coordmodepixel","a_coordmodetooltip","a_cursor","a_dd","a_ddd","a_dddd","a_defaultmousespeed","a_desktop","a_desktopcommon","a_detecthiddentext","a_detecthiddenwindows","a_endchar","a_eventinfo","a_fileencoding","a_hotkeyinterval","a_hotkeymodifiertimeout","a_hour","a_iconfile","a_iconhidden","a_iconnumber","a_icontip","a_index","a_initialworkingdir","a_is64bitos","a_isadmin","a_iscompiled","a_iscritical","a_ispaused","a_issuspended","a_keydelay","a_keydelayplay","a_keyduration","a_keydurationplay","a_language","a_lasterror","a_linefile","a_linenumber","a_listlines","a_loopfield","a_loopfileattrib","a_loopfiledir","a_loopfileext","a_loopfilefullpath","a_loopfilename","a_loopfilepath","a_loopfileshortname","a_loopfileshortpath","a_loopfilesize","a_loopfilesizekb","a_loopfilesizemb","a_loopfiletimeaccessed","a_loopfiletimecreated","a_loopfiletimemodified","a_loopreadline","a_loopregkey","a_loopregname","a_loopregtimemodified","a_loopregtype","a_maxhotkeysperinterval","a_mday","a_menumaskkey","a_min","a_mm","a_mmm","a_mmmm","a_mon","a_mousedelay","a_mousedelayplay","a_msec","a_mydocuments","a_now","a_nowutc","a_osversion","a_priorhotkey","a_priorkey","a_programfiles","a_programs","a_programscommon","a_ptrsize","a_regview","a_screendpi","a_screenheight","a_screenwidth","a_scriptdir","a_scriptfullpath","a_scripthwnd","a_scriptname","a_sec","a_sendlevel","a_sendmode","a_space","a_startmenu","a_startmenucommon","a_startup","a_startupcommon","a_storecapslockmode","a_tab","a_temp","a_thisfunc","a_thishotkey","a_tickcount","a_timeidle","a_timeidlekeyboard","a_timeidlemouse","a_timeidlephysical","a_timesincepriorhotkey","a_timesincethishotkey","a_titlematchmode","a_titlematchmodespeed","a_traymenu","a_username","a_wday","a_windelay","a_windir","a_workingdir","a_yday","a_year","a_yweek","a_yyyy"],t.builtin_variable_h=["a_ahkdir","a_dlldir","a_dllpath","a_globalstruct","a_isdll","a_mainthreadid","a_memorymodule","a_modulehandle","a_scriptstruct","a_threadid","a_zipcompressionlevel"]},3113:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defintionProvider=void 0;const i=n(2374),o=n(6169),r=n(3939),a=n(6630);t.defintionProvider=async function(e){var t,n;let s,c,l=e.textDocument.uri.toLowerCase(),d=r.lexers[l],u=d.buildContext(e.position),f=[];if(u){let h="",p=i.SymbolKind.Variable;if(u.pre.match(/^\s*#/i)){if((s=u.linetext.match(/^(\s*#include(again)?\s+)(<.+>|(['"]?)(\s*\*i\s+)?.+?\4)\s*(\s;.*)?$/i))&&s[3]){let e=u.range.start.line,n=s[3].trim();for(let o in d.include)if(d.include[o].raw===n){let n=i.Range.create(0,0,0,0);return r.lexers[o]&&(n=i.Range.create(0,0,r.lexers[o].document.lineCount,0)),l=(null===(t=r.lexers[o])||void 0===t?void 0:t.document.uri)||(r.inBrowser||!o.match(/^file:/)?o:a.URI.file((0,r.restorePath)(a.URI.parse(o).fsPath)).toString()),[i.LocationLink.create(l,n,n,i.Range.create(e,s[1].length,e,s[1].length+s[3].length))]}}return}if(h=u.text.toLowerCase(),p=u.kind,p===i.SymbolKind.Null)return;if(""===h||d.instrorcomm(e.position))return;if(void 0!==(c=(0,o.searchNode)(d,h,u.range.end,p))||p!=i.SymbolKind.Property&&p!==i.SymbolKind.Method){if(null===c)return}else{let t={};if(c=[],(0,o.cleardetectcache)(),(0,o.detectExpType)(d,h.replace(/\.[^.]+$/,(e=>(h=e.match(/^\.[^.]+$/)?e:"",""))),e.position,t),h&&void 0===t["#any"])for(const e in t)null===(n=(0,o.searchNode)(d,e+h,u.range.end,p))||void 0===n||n.map((e=>{(null==c?void 0:c.map((e=>e.node)).includes(e.node))||null==c||c.push(e)}));if(!(null==c?void 0:c.length)&&p===i.SymbolKind.Method){c=[];let e=[d];h.replace(/\.([^.]+)$/,((...t)=>{var n;h=t[1];for(const t in d.relevance)e.push(r.lexers[t]);for(const t of e)(null===(n=t.object.method[h])||void 0===n?void 0:n.length)&&(null==c||c.push(...t.object.method[h].map((e=>({node:e,uri:t.uri})))));return""}))}}if(c){let e="";if(c.map((t=>{(e=t.node.uri||t.uri)&&f.push(i.Location.create(r.lexers[e].document.uri,t.node.selectionRange))})),f.length)return f}}}},2793:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.typeFormatting=t.rangeFormatting=t.documentFormatting=void 0;const i=n(2374),o=n(6288),r=n(6169),a=n(3939),s={indent_size:"1",indent_char:"\t",max_preserve_newlines:"2",preserve_newlines:!0,keep_array_indentation:!0,break_chained_methods:!1,indent_scripts:"keep",brace_style:"collapse",space_before_conditional:!0,wrap_line_length:"0",space_after_anon_function:!0};async function c(e){let t=Object.assign({},s);e.options.insertSpaces?(t.indent_char=" ",t.indent_size=e.options.tabSize.toString()):t.indent_char="\t";let n=e.range,c=a.lexers[e.textDocument.uri.toLowerCase()],l=c.document,d=l.getText(n);if(c.instrorcomm(n.start)||c.instrorcomm(n.end))return;let u="";return n.start.character>0&&""===(u=l.getText(i.Range.create(n.start.line,0,n.start.line,n.start.character))).trim()&&(d=u+d,n.start.character=0),d=new r.Lexer(o.TextDocument.create("","ahk2",-10,d)).beautify(t),[{range:n,newText:d}]}t.documentFormatting=async function(e){let t=a.lexers[e.textDocument.uri.toLowerCase()],n=i.Range.create(0,0,t.document.lineCount,0),o=Object.assign({},s);return e.options.insertSpaces?(o.indent_char=" ",o.indent_size=e.options.tabSize.toString()):o.indent_char="\t",[{range:n,newText:t.beautify(o)}]},t.rangeFormatting=c,t.typeFormatting=async function(e){let t=a.lexers[e.textDocument.uri.toLowerCase()],n=e.position,o="",r=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t";if("{"===e.ch){if(new RegExp("^("+r+")+\\{").test(o=t.document.getText(i.Range.create(n.line,0,n.line,n.character)))){if(t.instrorcomm(n))return;let e=n.line,a=o.slice(0,-1),s=a.replace(r,""),c="",l=new RegExp("^"+a+"(?!"+r+")");for(;e>0&&l.test(c=t.document.getText({start:{line:e-1,character:0},end:{line:e,character:0}}))&&!c.match(/^\s*(\{|\}|(if|else|for|loop|while|try|catch|finally)\b|.*\{\s*(;.*)?$)/i);)e--;if(new RegExp("^"+s+"(\\}\\s*)?(if|else|for|loop|while|try|catch|finally)\\b","i").test(c)&&!c.match(/\{\s*(;.*)?$/))return[{newText:s+"{",range:i.Range.create(n.line,0,n.line,n.character)}]}}else if("}"===e.ch){if(""!==t.document.getText(i.Range.create(n.line,0,n.line,n.character-1)).trim())return;let o=t.searchScopedNode(n);if(o&&o.range.end.line===n.line&&o.range.start.line<n.line)return c({range:{start:{line:o.range.start.line,character:0},end:n},textDocument:e.textDocument,options:e.options})}}},9541:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hoverProvider=void 0;const i=n(2374),o=n(6169),r=n(3939);t.hoverProvider=async function(e,t){var n,a;if(t.isCancellationRequested)return;let s=e.textDocument.uri.toLowerCase(),c=r.lexers[s];if(!c||c.instrorcomm(e.position))return;let l,d=c.buildContext(e.position),u=[];if(d){let t,s,f=d.text.toLowerCase(),h=i.SymbolKind.Variable,p="";if(d.kind===i.SymbolKind.Null)return(l=r.hoverCache[1])&&l[f]?l[f][0]:void 0;if("#"===d.pre)return(l=r.hoverCache[1])&&(l=l[f="#"+f])?l[0]:void 0;if(h=d.kind,""===f)return;if(void 0!==(t=(0,o.searchNode)(c,f,d.range.end,h))||h!=i.SymbolKind.Property&&h!==i.SymbolKind.Method){if(null===t)return}else{let i={};if(t=[],(0,o.cleardetectcache)(),(0,o.detectExpType)(c,f.replace(/\.[^.]+$/,(e=>(f=e.match(/^\.[^.]+$/)?e:"",""))),e.position,i),f&&void 0===i["#any"])for(const e in i)null===(n=(0,o.searchNode)(c,e+f,d.range.end,h))||void 0===n||n.map((e=>{(null==t?void 0:t.map((e=>e.node)).includes(e.node))||null==t||t.push(e)}));(null==t?void 0:t.length)||(t=void 0)}if(!t)if(h===i.SymbolKind.Method);else if(r.ahkvars[f])t=[{node:r.ahkvars[f],uri:""}];else if(h===i.SymbolKind.Function&&(null===(a=c.tokens[c.document.offsetAt(d.range.start)])||void 0===a?void 0:a.semantic)){if((l=r.hoverCache[0])&&l[f])return l[f][0]}else if((l=r.hoverCache[1])&&l[f])return l[f][0];if(t&&(t.length>1?t.map((e=>{e.node.full&&u.push({kind:"ahk2",value:e.node.full})})):(s=t[0].node,p=t[0].uri,s.kind===i.SymbolKind.Function||s.kind===i.SymbolKind.Method||s.kind===i.SymbolKind.Property?s.full&&u.push({kind:"ahk2",value:s.full}):s.kind===i.SymbolKind.Class&&u.push({kind:"ahk2",value:"class "+(s.full||s.name)}),s.detail&&u.push({kind:"markdown",value:(0,o.formatMarkdowndetail)(s.detail)})),u.length))return{contents:{kind:"markdown",value:u.map((e=>"ahk2"===e.kind?"```ahk2\n"+e.value+"\n```":e.value)).join("\n\n")}}}}},7994:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadlocalize=t.setting=t.diagnostic=t.codeaction=t.completionitem=void 0;const i=n(1017),o=n(3939);let r={};function a(e,t){return(...n)=>n.length?function(e,...t){return e.replace(/\{(\d+)\}/g,((...e)=>{let n=parseInt(e[1]);return n<t.length?t[n]:" "}))}(s(e,t),...n):s(e,t)}function s(e,t){return r[e]||t}var c,l,d;(d=t.completionitem||(t.completionitem={})).author=a("completionitem.author","Add file infos about author, description, date, version."),d.comment=a("completionitem.generatecomment","Generate comment template of current function/method."),d.include=a("completionitem.include","Auto import from '{0}'"),d.prototype=a("completionitem.prototype","Retrieve or set the object on which all instances of the class are based."),d.thishotkey=a("completionitem.thishotkey","The hidden parameter to the hotkey function."),d.value=a("completionitem.value","Within the dynamic property 'set', 'Value' contains the value being assigned."),d._new=a("completionitem.new","export construct a new instance of the class."),d._this=a("completionitem.this","In the class, access other instance variables and methods of the class through 'this'."),d._super=a("completionitem.super","In the inherited class, 'super' can replace 'this' to access the superclass version of the method or property that is overridden in the derived class."),(t.codeaction||(t.codeaction={})).include=a("codeaction.include","Import '{0}'"),(l=t.diagnostic||(t.diagnostic={})).acceptparams=a("diagnostic.acceptparams","'{0}' accepts at most {1} parameter"),l.assignerr=a("diagnostic.assignerr","This {0} '{1}' cannot be used as an output variable"),l.classinfuncerr=a("diagnostic.classinfuncerr","Functions cannot contain classes"),l.classuseerr=a("diagnostic.classuseerr","This class cannot be used as an output variable"),l.conflictserr=a("diagnostic.conflictserr","This {0} '{2}' declaration conflicts with an existing {1}"),l.declarationerr=a("diagnostic.declarationerr","Unexpected declaration"),l.defaultvalmissing=a("diagnostic.defaultvalmissing","Parameter default required. Specifically: '{0}'"),l.deprecated=a("diagnostic.deprecated","Using '{0}' instead of '{1}'"),l.dupdeclaration=a("diagnostic.dupdeclaration","Duplicate declaration"),l.duplabel=a("diagnostic.duplabel","Duplicate label"),l.filenotexist=a("diagnostic.filenotexist","'{0}' not exist"),l.funcassignerr=a("diagnostic.funcassignerr","This Func cannot be assigned a value"),l.funccallerr=a("diagnostic.funccallerr","Function calls require a space or '(',  use comma only between parameters"),l.globalconflicts=a("diagnostic.globalconflicts","This global declaration conflicts with an existing {0}"),l.hotdeferr=a("diagnostic.hotdeferr","Hotkeys/hotstrings cannot be defined in functions/classes"),l.invaliddefinition=a("diagnostic.invaliddefinition","Invalid {0} definition"),l.invalidhotdef=a("diagnostic.invalidhotdef","Invalid hotkey definition"),l.invalidparam=a("diagnostic.invalidparam","Invalid parameter definition"),l.invalidprop=a("diagnostic.invalidprop","Invalid dynamic property"),l.invalidpropname=a("diagnostic.invalidpropname","Invalid property name in object literal"),l.invalidsymbolname=a("diagnostic.invalidsymbolname","Invalid symbol naming '{0}'"),l.missing=a("diagnostic.missing","Missing '{0}'"),l.missingparam=a("diagnostic.missingparam","Missing a required parameter"),l.objectliteralerr=a("diagnostic.objectliteralerr","Error in object literal"),l.pathinvalid=a("diagnostic.pathinvalid","Invalid file path"),l.paramcounterr=a("diagnostic.paramcounterr","Expected {0} parameters, but got {1}"),l.propdeclaraerr=a("diagnostic.propdeclaraerr","Not a valid method, class or property definition"),l.propemptyparams=a("diagnostic.propemptyparams","Empty [] not permitted"),l.propnotinit=a("diagnostic.propnotinit","Property declaration is not initialized"),l.reservedworderr=a("diagnostic.reservedworderr","The following reserved word '{0}' must not be used as a variable name"),l.typemaybenot=a("diagnostic.typemaybenot","Type maybe not '{0}'"),l.unexpected=a("diagnostic.unexpected","Unexpected '{0}'"),l.unknown=a("diagnostic.unknown","Unknown {0}"),l.invalidencoding=a("diagnostic.invalidencoding","'{0}' invalid file encoding"),l.unknownoperatoruse=a("diagnostic.unknownoperatoruse","Unknown operator use"),l.unknowntoken=a("diagnostic.unknowntoken","Unknown token '{0}'"),l.unsupportinclude=a("diagnostic.unsupportinclude","#Include in functions and classes cannot correctly deduce scope and code completion"),l.unsupportresinclude=a("diagnostic.unsupportresinclude","Parsing library files in resource is not supported"),(c=t.setting||(t.setting={})).ahkpatherr=a("setting.ahkpatherr","The AutoHotkey interpreter does not exist, re-specify in'Settings-AutoHotkey2.InterpreterPath'"),c.getenverr=a("setting.getenverr","Failed to get environment variables"),c.versionerr=a("setting.versionerr","The current AutoHotkey.exe is not the v2 version, and cannot get the correct syntax analysis, completion and other functions"),t.loadlocalize=function(){if(o.inBrowser){let e=(0,o.getwebfile)(o.dirname+"/package.nls.<>.json");e&&(r=JSON.parse(e.text))}else{let e=(0,o.getlocalefile)((0,i.resolve)(__dirname,"../../package.nls.<>.json"),"utf8");r=e?JSON.parse(e):{}}}},6658:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAllVar=t.findAllFromDoc=t.getAllReferences=t.referenceProvider=void 0;const i=n(2374),o=n(6169),r=n(3939);function a(e,t){let n=t.text.toLowerCase(),a={};if(!t.text)return;let c=(0,o.searchNode)(e,n,t.range.end,t.kind);if(!c||c.length>1)return;let{node:l,uri:d}=c[0];if(!d||l===r.ahkvars[n]||n.match(/^(this|super)$/)&&l.kind===i.SymbolKind.Class&&!l.name.match(/^(this|super)$/i))return;let u=l===e.declaration[n]?void 0:e.searchScopedNode(l.selectionRange.start);switch(l.kind){case i.SymbolKind.Field:if(u){let e=u.labels;e&&e[n]&&(a[r.lexers[d].document.uri]=e[n].map((e=>e.selectionRange)))}else{let t=e.labels;t[n]&&(a[e.document.uri]=t[n].map((e=>e.selectionRange)));for(const i in e.relevance)t=r.lexers[i].labels,t[n]&&(a[r.lexers[i].document.uri]=t[n].map((e=>e.selectionRange)))}break;case i.SymbolKind.Function:case i.SymbolKind.Variable:case i.SymbolKind.TypeParameter:case i.SymbolKind.Class:if(l.kind!==i.SymbolKind.Class||!l.full.includes(".")){u&&(u.kind!==i.SymbolKind.Class&&u.kind!==i.SymbolKind.Function&&u.kind!==i.SymbolKind.Method&&u.kind!==i.SymbolKind.Event||u.global&&u.global[n]&&(u=void 0));let t=s(e=r.lexers[d],n,i.SymbolKind.Variable,u);if(t.length&&(a[e.document.uri]=t),!u)for(const t in e.relevance){let e=s(r.lexers[t],n,i.SymbolKind.Variable,void 0);e.length&&(a[r.lexers[t].document.uri]=e)}break}default:if(l.kind===i.SymbolKind.Class||l.static){let t=n.split("."),o=s(e,t[0],i.SymbolKind.Variable),c={};t.splice(0,1),o.length&&(c[e.document.uri]=o);for(const t in e.relevance){let e=s(r.lexers[t],n,i.SymbolKind.Variable,void 0);e.length&&(c[r.lexers[t].document.uri]=e)}for(const e in c){let n=c[e],i=r.lexers[e.toLowerCase()],o=[];for(let e of n){let n,r=0,a=i.document.offsetAt(e.end);for(;r<t.length;){for(n=i.get_tokon(a);n&&n.type.endsWith("COMMENT");)n=i.get_tokon(n.offset+n.length);if(!n||"."!==n.content||!(n=i.get_tokon(n.offset+n.length))||"TK_WORD"!==n.type||n.content.toLowerCase()!==t[r])break;a=n.offset+n.length,r++}r===t.length&&n&&o.push({start:i.document.positionAt(n.offset),end:i.document.positionAt(n.offset+n.length)})}o.length&&(a[i.document.uri]=o)}let u=r.lexers[d].document.uri;a[u]?a[u].unshift(l.selectionRange):a[u]=[l.selectionRange];break}return}return Object.keys(a).length?a:void 0}function s(e,t,n,o){var r;let a=[];if(n===i.SymbolKind.Method||n===i.SymbolKind.Property);else{let n=o||e,s=!o,l=s;if(!l){let e=n.local,i=n.declaration;e&&e[t]||i&&i[t]||(l=void 0)}null===(r=n.children)||void 0===r||r.map((e=>{e.name.toLowerCase()===t&&a.push(e.selectionRange),e.children&&c(e,t,s,a,s||e.kind===i.SymbolKind.Function?l:void 0)}))}return a}function c(e,t,n=!1,r,a){var s,l,d;if(e.local&&e.local[t]){if(!n)return;a=!1}else if(e.assume===o.FuncScope.GLOBAL||e.global&&e.global[t]){if(!n)return;a=!0}a===n?null===(s=e.children)||void 0===s||s.map((e=>{e.name.toLowerCase()===t&&e.kind!==i.SymbolKind.Property&&e.kind!==i.SymbolKind.Method&&e.kind!==i.SymbolKind.Class&&r.push(e.selectionRange),e.children&&c(e,t,n,r,e.kind===i.SymbolKind.Function?a:n||void 0)})):(null===(l=e.children)||void 0===l||l.map((e=>{e.children&&c(e,t,n,r,!n&&void 0)})),n||null===(d=e.funccall)||void 0===d||d.map((e=>{e.kind===i.SymbolKind.Function&&e.name.toLowerCase()===t&&r.push(e.selectionRange)})))}t.referenceProvider=async function(e){let t=[],n=r.lexers[e.textDocument.uri.toLowerCase()],i=a(n,n.buildContext(e.position));for(const e in i)t.push(...i[e].map((t=>({uri:e,range:t}))));return t},t.getAllReferences=a,t.findAllFromDoc=s,t.findAllVar=c},5932:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renameProvider=t.prepareRename=void 0;const i=n(6658),o=n(3939);let r;t.prepareRename=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=t.buildContext(e.position);if(r=(0,i.getAllReferences)(t,n))return{range:n.range,placeholder:n.text.split(".").pop()||""}},t.renameProvider=async function(e){let t={changes:{}},n=e.newName;for(const e in r)t.changes[e]=r[e].map((e=>({range:e,newText:n})));return t}},9770:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runscript=void 0;const i=n(2081),o=n(3939),r=n(7147);t.runscript=function(e,t){let n=o.ahkpath_cur||o.extsettings.InterpreterPath;if((0,r.existsSync)(n)){const o=(0,i.spawnSync)(`"${n}" /CP65001 *`,[],{cwd:n.replace(/[\\/].+?$/,""),shell:!0,input:e});if(o)return!o.stdout||(t&&t(o.stdout.toString()),!0)}return!1}},6001:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.semanticTokensOnRange=t.semanticTokensOnDelta=t.semanticTokensOnFull=void 0;const i=n(2374),o=n(6169),r=n(3939),a=n(5116);let s,c=new Map;function l(e,t,n){var r;let l=t.semantic;switch(l.type){case o.SemanticTokenTypes.class:return s=a.globalsymbolcache[e],(null==s?void 0:s.kind)!==i.SymbolKind.Class&&(s=void 0),o.SemanticTokenTypes.class;case o.SemanticTokenTypes.method:case o.SemanticTokenTypes.property:if(s){let d,u=s.staticdeclaration[e],f=null==u?void 0:u.kind;if(!u){let t=(null!==(r=c.get(s))&&void 0!==r?r:(c.set(s,d=(0,o.getClassMembers)(n,s,!0)),d))[e];t&&(u=t,f=t.kind)}switch(f){case i.SymbolKind.Method:return l.modifier=(l.modifier||0)|1<<o.SemanticTokenModifiers.readonly|1<<o.SemanticTokenModifiers.static,t.callinfo&&(0,a.checkParams)(n,u,t.callinfo),l.type=o.SemanticTokenTypes.method;case i.SymbolKind.Class:return l.modifier=(l.modifier||0)|1<<o.SemanticTokenModifiers.readonly,s=s.staticdeclaration[e],t.callinfo&&(0,a.checkParams)(n,s,t.callinfo),l.type=o.SemanticTokenTypes.class;case i.SymbolKind.Property:let r=u.children;return 1===(null==r?void 0:r.length)&&"get"===r[0].name&&(l.modifier=(l.modifier||0)|1<<o.SemanticTokenModifiers.readonly|1<<o.SemanticTokenModifiers.static),l.type=o.SemanticTokenTypes.property}}default:return l.type}}t.semanticTokensOnFull=async function(e){let t=r.lexers[e.textDocument.uri.toLowerCase()],n=t.STB;n.previousResult(""),s=void 0,c.clear(),await(0,a.symbolProvider)({textDocument:e.textDocument});for(let e of Object.values(t.tokens))if(e.semantic){let i=e.pos||(e.pos=t.document.positionAt(e.offset)),r=e.semantic.type;(s&&(r===o.SemanticTokenTypes.method||r===o.SemanticTokenTypes.property)||r===o.SemanticTokenTypes.class)&&(r=l(e.content.toLowerCase(),e,t)),n.push(i.line,i.character,e.length,r,e.semantic.modifier||0)}else s&&"TK_DOT"!==e.type&&!e.type.endsWith("COMMENT")&&(s=void 0);return c.clear(),n.build()},t.semanticTokensOnDelta=async function(e){let t=r.lexers[e.textDocument.uri.toLowerCase()],n=t.STB;n.previousResult(""),s=void 0,c.clear(),await(0,a.symbolProvider)({textDocument:e.textDocument});for(let e of Object.values(t.tokens))if(e.semantic){let i=e.pos||(e.pos=t.document.positionAt(e.offset)),r=e.semantic.type;(s&&(r===o.SemanticTokenTypes.method||r===o.SemanticTokenTypes.property)||r===o.SemanticTokenTypes.class)&&(r=l(e.content.toLowerCase(),e,t)),n.push(i.line,i.character,e.length,r,e.semantic.modifier||0)}else s&&"TK_DOT"!==e.type&&!e.type.endsWith("COMMENT")&&(s=void 0);return c.clear(),n.buildEdits()},t.semanticTokensOnRange=async function(e){let t=r.lexers[e.textDocument.uri.toLowerCase()],n=t.STB,i=t.document.offsetAt(e.range.start),d=t.document.offsetAt(e.range.end);n.previousResult(""),s=void 0,c.clear(),await(0,a.symbolProvider)({textDocument:e.textDocument});for(let e of Object.values(t.tokens))if(!(e.offset<i)){if(e.offset>d)break;if(e.semantic){let i=e.pos||(e.pos=t.document.positionAt(e.offset)),r=e.semantic.type;(s&&(r===o.SemanticTokenTypes.method||r===o.SemanticTokenTypes.property)||r===o.SemanticTokenTypes.class)&&(r=l(e.content.toLowerCase(),e,t)),n.push(i.line,i.character,e.length,r,e.semantic.modifier||0)}else s&&"TK_DOT"!==e.type&&!e.type.endsWith("COMMENT")&&(s=void 0)}return c.clear(),n.build()}},5373:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signatureProvider=void 0;const i=n(2374),o=n(6169),r=n(3939);t.signatureProvider=async function(e,t){var n,a,s,c,l;if(t.isCancellationRequested)return;let d,u,f,h,p,m,g=e.textDocument.uri.toLowerCase(),y=r.lexers[g],b=i.SymbolKind.Function,_={activeSignature:0,signatures:[],activeParameter:0};if((u=(0,o.getFuncCallInfo)(y,e.position))&&!(u.index<0)){if(f=u.name,h=u.pos,p=u.index,h.character>0&&"."===y.document.getText(i.Range.create({line:h.line,character:h.character-1},h))&&(b=i.SymbolKind.Method),b===i.SymbolKind.Method||u.full){let t,r=u.full;if(""===r&&(t=y.buildContext(h),r=t.text.toLowerCase()),r.match(/^(((\w|[^\x00-\xff])+\.)+(\w|[^\x00-\xff])+)$/)){if(d=(0,o.searchNode)(y,r,h,i.SymbolKind.Method),!d){let i=r,a={};if(d=[],(0,o.cleardetectcache)(),(0,o.detectExpType)(y,i.replace(/\.[^.]+$/,(e=>(i=e.match(/^\.[^.]+$/)?e:"",""))),e.position,a),i&&void 0===a["#any"])for(const e in a)null===(n=(0,o.searchNode)(y,e+i,r?u.pos:t.range.end,b))||void 0===n||n.map((e=>{(null==d?void 0:d.map((e=>e.node)).includes(e.node))||null==d||d.push(e)}));d.length||(d=void 0)}}else{let t={};if(r=r.replace(/\.(\w|[^\x00-\xff])+$/,""),d=[],(0,o.cleardetectcache)(),(0,o.detectExpType)(y,r,e.position,t),void 0===t["#any"])for(const n in t)null===(a=(0,o.searchNode)(y,n+"."+f,e.position,i.SymbolKind.Method))||void 0===a||a.map((e=>{d.map((e=>e.node)).includes(e.node)||d.push(e)}));d.length||(d=void 0)}}else d=(0,o.searchNode)(y,f,h,b);do{m=d||[],d=[],m.map((e=>{var t,n;let a,s=e.node,c=s.kind;if(c===i.SymbolKind.Class){let n=(0,o.getClassMembers)(r.lexers[s.uri||e.uri]||y,s,!e.ref),i=e.ref?n.call:null!==(t=n.__new)&&void 0!==t?t:n.call;n.call&&!1!==n.call.def&&(i=n.call),i&&d.push({node:i,uri:""})}else if(c===i.SymbolKind.Function||c===i.SymbolKind.Method)d.push(e);else if(e.uri){if(c===i.SymbolKind.Property){let t=Object.keys(s.returntypes||{}).pop()||"";t&&((0,o.cleardetectcache)(),(0,o.detectExp)(r.lexers[e.uri],t,i.Position.is(s.returntypes[t])?s.returntypes[t]:h).map((e=>{var t;null===(t=(0,o.searchNode)(y,e,h,i.SymbolKind.Function))||void 0===t||t.map((e=>{(e.node.kind===i.SymbolKind.Function||e.node.kind===i.SymbolKind.Method||e.node.kind===i.SymbolKind.Class&&"Primitive"!==e.node.extends)&&d.push(e)}))})))}else{if(c!==i.SymbolKind.Variable)return;(0,o.cleardetectcache)(),(0,o.detectVariableType)(r.lexers[e.uri],e.node.name.toLowerCase(),e.uri===y.uri?h:void 0).map((e=>{var t;null===(t=(0,o.searchNode)(y,e,h,i.SymbolKind.Function))||void 0===t||t.map((e=>{(e.node.kind===i.SymbolKind.Function||e.node.kind===i.SymbolKind.Method||e.node.kind===i.SymbolKind.Class&&"Primitive"!==e.node.extends)&&d.push(e)}))}))}if(1===m.length&&!d.length&&s.detail&&(a=new RegExp("\\b"+s.name+"\\([^)]*\\)").exec(s.detail))){let e,t=[],r=i.Range.create(0,0,0,0);null===(n=a[0].match(/(?<=[(,]\s*)(\w|[^\x00-\xff])+/g))||void 0===n||n.map((e=>t.push({name:e}))),e=o.FuncNode.create(s.name,i.SymbolKind.Function,r,r,t),e.full=s.detail,d.push({node:e})}}}))}while(d.length>0&&d[0].node.kind!==i.SymbolKind.Function&&d[0].node.kind!==i.SymbolKind.Method&&d[0].node.kind!==i.SymbolKind.Class);if(!d||!d.length){if(b!==i.SymbolKind.Method)return;d=[];for(const e in r.ahkvars)null===(s=r.ahkvars[e].children)||void 0===s||s.map((e=>{e.kind!==i.SymbolKind.Method||e.name.toLowerCase()!==f||d.map((e=>e.node)).includes(e)||d.push({node:e,uri:""})}));null===(c=y.object.method[f])||void 0===c||c.map((e=>{null==d||d.push({node:e,uri:""})}));for(const e in y.relevance)null===(l=r.lexers[e].object.method[f])||void 0===l||l.map((e=>{null==d||d.push({node:e,uri:""})}));if(!(null==d?void 0:d.length))return}return null==d||d.map((e=>{const t=e.node;t.params&&_.signatures.push({label:t.full,parameters:t.params.map((e=>({label:e.name.trim().replace(/(['\w]*\|['\w]*)(\|['\w]*)+/,"$1|...")}))),documentation:t.detail?{kind:"markdown",value:(0,o.formatMarkdowndetail)(t.detail,p<t.params.length?t.params[p].name:void 0)}:void 0})})),_.activeParameter=p,_}}},5116:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.workspaceSymbolProvider=t.checkParams=t.symbolProvider=t.globalsymbolcache=void 0;const i=n(2374),o=n(6169),r=n(7994),a=n(3939),s=n(6630),c=n(6288);async function l(e){var n;let s=e.textDocument.uri.toLowerCase(),c=a.lexers[s];if(!c||!c.reflat&&a.symbolcache[s])return a.symbolcache[s];let l={},u=c.declaration;for(const e in a.ahkvars)l[e]=a.ahkvars[e];let f=c.relevance;for(const e in f){const t=null===(n=a.lexers[e])||void 0===n?void 0:n.declaration;for(let n in t)l[n]&&t[n].kind===i.SymbolKind.Variable||(l[n]=t[n],t[n].uri=e)}for(const e in u)l[e]&&l[e].kind!==i.SymbolKind.Variable&&(l[e]!==a.ahkvars[e]||u[e].kind===i.SymbolKind.Variable||l[e].kind!==i.SymbolKind.Function&&!1!==l[e].def)||(l[e]=u[e],u[e].uri=s);c.reflat=!1,t.globalsymbolcache=l;let h=c.document.uri;return a.symbolcache[s]=function e(t,n={},r=!1){var s,u;const f=[],h=[];let m;return n.isset=a.ahkvars.isset,null===(s=t.children)||void 0===s||s.map((e=>{var t;if(e.children&&h.push(e),e.name)if(e.kind===i.SymbolKind.Function||e.kind===i.SymbolKind.Variable||e.kind===i.SymbolKind.Class){let o=e.name.toLowerCase();n[o]?e.kind===i.SymbolKind.Variable?e!==n[o]&&(n[o].kind!==i.SymbolKind.TypeParameter||n[o].selectionRange.start.character!==n[o].selectionRange.end.character?p(e,n[o]===a.ahkvars[o],n[o].kind):(m=c.tokens[c.document.offsetAt(e.selectionRange.start)])&&m.semantic&&delete m.semantic):e!==n[o]?(f.push(e),n[o]=e,p(e,e===a.ahkvars[o])):e===l[o]&&(f.push(e),p(e,e===a.ahkvars[o])):e.kind===i.SymbolKind.Variable&&!e.def&&l[o]?(n[o]=l[o],e===l[o]&&f.push(e),p(e,l[o]===a.ahkvars[o],l[o].kind)):(n[o]=e,f.push(e),e.kind===i.SymbolKind.Class&&e.parent||p(e,a.ahkvars[o]&&l[o]===a.ahkvars[o],(null===(t=l[o])||void 0===t?void 0:t.kind)||e.kind))}else e.kind!==i.SymbolKind.TypeParameter&&(f.push(e),e.kind!==i.SymbolKind.Method&&e.kind!==i.SymbolKind.Property||!e.name.match(/^__(set|get|call|new|item|delete)$/i)||(m=c.tokens[c.document.offsetAt(e.selectionRange.start)])&&m.semantic&&delete m.semantic)})),null===(u=t.funccall)||void 0===u||u.map((e=>{e.kind===i.SymbolKind.Function&&d(c,n[e.name.toLowerCase()],e)})),h.map((t=>{var a,s,c;if(t.children){let d={},u=!1;if(t.kind===i.SymbolKind.Function||t.kind===i.SymbolKind.Method||t.kind===i.SymbolKind.Event){let e=t,h={},m="";for(const t in e.global)d[t]=e.global[t];null===(a=t.params)||void 0===a||a.map((e=>{d[m=e.name.toLowerCase()]=e,h[m]=!0,p(e,!1,i.SymbolKind.TypeParameter)}));for(const t in e.local)t&&!h[t]&&(d[t]=e.local[t],f.push(d[t]),p(d[t]));if(e.assume===o.FuncScope.GLOBAL||r)u=!0;else{u=!1;let o=t.parent,r=e.declaration;if(o){if(o.kind===i.SymbolKind.Property&&(null===(s=o.children)||void 0===s?void 0:s.length)&&(null===(c=o.parent)||void 0===c?void 0:c.kind)===i.SymbolKind.Class&&(o=o.parent),o.kind===i.SymbolKind.Class){let e=i.Range.create(0,0,0,0);d.this=i.DocumentSymbol.create("this",void 0,i.SymbolKind.TypeParameter,e,e),o.extends&&(d.super=i.DocumentSymbol.create("super",void 0,i.SymbolKind.TypeParameter,e,e))}if(o.kind===i.SymbolKind.Function||o.kind===i.SymbolKind.Method||o.kind===i.SymbolKind.Event)for(const e in n)d[e]||(d[e]=n[e])}for(const e in r)e&&(d[e]?r[e]!==d[e]?r[e].kind!==i.SymbolKind.Variable||d[e]===l[e]&&r[e].def?(d[e]=r[e],f.push(r[e]),p(r[e])):p(r[e],!1,d[e].kind):h[e]||p(r[e]):(d[e]=r[e],f.push(d[e]),p(r[e])))}}else if(t.kind===i.SymbolKind.Class){let e=i.Range.create(0,0,0,0);d.this=i.DocumentSymbol.create("this",void 0,i.SymbolKind.TypeParameter,e,e),t.extends&&(d.super=i.DocumentSymbol.create("super",void 0,i.SymbolKind.TypeParameter,e,e))}f.push(...e(t,d,u))}})),f}(c).map((e=>i.SymbolInformation.create(e.name,e.kind,e.children?e.range:e.selectionRange,h,e.kind===i.SymbolKind.Class&&e.extends?e.extends:void 0))),c.actived&&(function(e){var t;let n,s={},c={};if(e.d)return;Object.keys(e.labels).map((e=>c[e]=!0));for(const e in a.ahkvars){let t=a.ahkvars[e];s[e]=t,t.kind!==i.SymbolKind.Function&&"struct"!==t.name.toLowerCase()||(t.def=!1)}for(const t in e.relevance)if(n=a.lexers[t]){n.diagnostics.splice(n.diags),(0,o.checksamenameerr)(s,Object.values(n.declaration).filter((e=>e.kind!==i.SymbolKind.Variable)),n.diagnostics);for(const e in n.labels)n.labels[e][0].def&&(c[e]?n.diagnostics.push({message:r.diagnostic.duplabel(),range:n.labels[e][0].selectionRange,severity:1}):c[e]=!0)}let l=Object.values(e.declaration);(0,o.checksamenameerr)(s,l,e.diagnostics);for(const t in e.relevance)(n=a.lexers[t])&&(0,o.checksamenameerr)(s,Object.values(n.declaration).filter((e=>e.kind===i.SymbolKind.Variable)),n.diagnostics);l.map((t=>{var n;if(t.kind===i.SymbolKind.Class){let i=null===(n=t.extends)||void 0===n?void 0:n.toLowerCase();i===t.name.toLowerCase()?u(e,t,!1):i&&!d(i)&&u(e,t)}}));for(const o in e.relevance)if(n=a.lexers[o])for(const e of Object.values(n.declaration))if(e.kind===i.SymbolKind.Class){let i=null===(t=e.extends)||void 0===t?void 0:t.toLowerCase();i===e.name.toLowerCase()?u(n,e,!1):i&&!d(i)&&u(n,e)}function d(e){let t,n=e.toLowerCase().split("."),o=n.length;for(let e=0;e<o;e++)if(t=t?t.staticdeclaration[n[e]]:s[n[e]],!t||t.kind!==i.SymbolKind.Class||!1===t.def)return!1;return!0}function u(e,t,n=!0){let o,a=e.document.offsetAt(t.selectionRange.end)+1;for(o=e.get_tokon(a),"extends"===o.content.toLowerCase()&&(o=e.get_tokon(a=o.offset+o.length));"TK_WORD"!==o.type;)o=e.get_tokon(a=o.offset+o.length);a=o.offset;let s={start:e.document.positionAt(a),end:e.document.positionAt(a+t.extends.length)};e.diagnostics.push({message:n?r.diagnostic.unknown("class '"+t.extends)+"'":r.diagnostic.unexpected(t.extends),range:s,severity:i.DiagnosticSeverity.Error})}}(c),setTimeout(a.sendDiagnostics,200)),a.symbolcache[s];function p(e,t=!1,n){let r,a,s;switch(n||e.kind){case i.SymbolKind.TypeParameter:if(0===e.range.start.line&&0===e.range.start.character)return;s=o.SemanticTokenTypes.parameter;break;case i.SymbolKind.Variable:s=o.SemanticTokenTypes.variable;break;case i.SymbolKind.Class:s=o.SemanticTokenTypes.class;break;case i.SymbolKind.Function:s=o.SemanticTokenTypes.function}void 0!==s&&(r=c.tokens[c.document.offsetAt(e.selectionRange.start)])&&(void 0===(a=r.semantic)?r.semantic=a={type:s}:void 0!==n&&(a.type=s),s<3&&(a.modifier=(a.modifier||0)|1<<o.SemanticTokenModifiers.readonly|(t?1<<o.SemanticTokenModifiers.defaultLibrary:0)))}}function d(e,t,n){var s,c,l;let d=n.paraminfo;if(a.extsettings.diagnostics.ParamsCheck&&d){if(t&&t.kind===i.SymbolKind.Class){let n=t;if(!(t=null!==(s=n.staticdeclaration.call)&&void 0!==s?s:n.declaration.__new)&&n.extends){let i=(0,o.getClassMembers)(e,n,!0);t=i.call&&!1!==i.call.def?i.call:null!==(c=i.__new)&&void 0!==c?c:i.call}}if(t&&(t.kind===i.SymbolKind.Function||t.kind===i.SymbolKind.Method)){let i=t.params.length,o=!1,a=d.count,s={};if(t.full.includes("*")&&(o=!0,i>0&&t.params[i-1].arr&&i--),o){for(;i>0&&void 0!==t.params[i-1].defaultVal;)--i;for(let e=0;e<i;++e)null===t.params[e].defaultVal&&--i;a<i&&!d.unknown&&e.diagnostics.push({message:r.diagnostic.paramcounterr(i+"+",a),range:n.range,severity:1}),d.miss.map((o=>{var a;s[o]=!0,o<i&&void 0===t.params[o].defaultVal&&e.addDiagnostic(r.diagnostic.missingparam(),null!==(a=d.comma[o])&&void 0!==a?a:e.document.offsetAt(n.range.end),1)}))}else{let o=i,c=d.miss.length,u=0;for(;i>0&&void 0!==t.params[i-1].defaultVal;)--i;for(let e=0;e<i;++e)null===t.params[e].defaultVal&&--i;for(;c>0;)(u=d.miss[c-1])>=o?u+1===a&&--a:void 0===t.params[u].defaultVal&&e.addDiagnostic(r.diagnostic.missingparam(),null!==(l=d.comma[u])&&void 0!==l?l:e.document.offsetAt(n.range.end),1),s[u]=!0,--c;(a<i&&!d.unknown||a>o)&&e.diagnostics.push({message:r.diagnostic.paramcounterr(i===o?o:i+"-"+o,a),range:n.range,severity:1})}t.hasref&&t.params.map(((t,i)=>{if(i<a&&t.ref&&!s[i]){let t,o;t=0===i?n.offset+n.name.length+1:d.comma[i-1]+1,"&"!==(o=e.get_tokon(t)).content&&e.addDiagnostic(r.diagnostic.typemaybenot("VarRef"),o.offset,o.length,2)}}))}}}t.globalsymbolcache={},t.symbolProvider=l,t.checkParams=d,t.workspaceSymbolProvider=async function(e){let t=[],n=0,i=e.query;if(!i||!i.match(/^(\w|[^\x00-\x7f])+$/))return t;let r=new RegExp(i.replace(/(?<=[^A-Z])([A-Z])/g,".*$1"),"i");for(let e in a.lexers)if(await d(e))return t;if(a.inBrowser){let e=await a.connection.sendRequest("ahk2.getWorkspaceFiles",[])||[];for(let n of e){let e,i=n.toLowerCase();if(!a.lexers[i]){let r=await a.connection.sendRequest("ahk2.getWorkspaceFileContent",[n]);if(e=new o.Lexer(c.TextDocument.create(n,"ahk2",-10,r)),e.parseScript(),a.lexers[i]=e,await d(i))return t}}}else{let e,n,i;for(let r of a.workspaceFolders){r=s.URI.parse(r).fsPath;for(let c of(0,a.getallahkfiles)(r))if(e=s.URI.file(c).toString().toLowerCase(),!a.lexers[e]&&(i=(0,a.openFile)(c))&&(n=new o.Lexer(i),n.parseScript(),a.lexers[e]=n,await d(e)))return t}}return t;async function d(e){for(let i of await l({textDocument:{uri:e}}))if(r.test(i.name)&&(t.push(i),++n>=1e3))return!0;return!1}}},5748:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.ProgressType=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.RAL=void 0,t.CancellationStrategy=void 0;const i=n(5285);Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const o=n(8159);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const r=n(345);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return r.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return r.Emitter}});const a=n(7770);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const s=n(4806);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return s.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return s.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return s.ReadableStreamMessageReader}});const c=n(9248);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const l=n(6336);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return l.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return l.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return l.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return l.createMessageConnection}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return l.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return l.Trace}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return l.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return l.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return l.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return l.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return l.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return l.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return l.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return l.CancellationStrategy}});const d=n(8094);t.RAL=d.default},7770:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(8094),o=n(8472),r=n(345);var a;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||o.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(a=t.CancellationToken||(t.CancellationToken={}));const s=Object.freeze((function(e,t){const n=i.default().timer.setTimeout(e.bind(t),0);return{dispose(){i.default().timer.clearTimeout(n)}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?s:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=a.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=a.None}}},6336:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.NullLogger=t.ProgressType=void 0;const i=n(8094),o=n(8472),r=n(5285),a=n(5164),s=n(345),c=n(7770);var l,d,u,f,h,p,m,g,y,b,_,v,T;!function(e){e.type=new r.NotificationType("$/cancelRequest")}(l||(l={})),function(e){e.type=new r.NotificationType("$/progress")}(d||(d={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return o.func(e)}}(u||(u={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(f=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!o.string(t))return e.Off;switch(t=t.toLowerCase()){default:return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(f=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(h=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new r.NotificationType("$/setTrace")}(p=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new r.NotificationType("$/logTrace")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(g=t.ConnectionErrors||(t.ConnectionErrors={}));class R extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,R.prototype)}}t.ConnectionError=R,function(e){e.is=function(e){const t=e;return t&&o.func(t.cancelUndispatched)}}(y=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){const t=e;return t&&o.func(t.createCancellationTokenSource)}}(b=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){e.sendNotification(l.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&o.func(t.sendCancellation)&&o.func(t.cleanup)}}(_=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:b.Message,sender:_.Message}),e.is=function(e){const t=e;return t&&b.is(t.receiver)&&_.is(t.sender)}}(v=t.CancellationStrategy||(t.CancellationStrategy={})),(t.ConnectionOptions||(t.ConnectionOptions={})).is=function(e){const t=e;return t&&(v.is(t.cancellationStrategy)||y.is(t.connectionStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(T||(T={})),t.createMessageConnection=function(e,n,y,b){const _=void 0!==y?y:t.NullLogger;let k=0,S=0,C=0;const w="2.0";let x;const E=Object.create(null);let O;const D=Object.create(null),K=new Map;let P,A,L=new a.LinkedMap,N=Object.create(null),M=Object.create(null),I=f.Off,q=h.Text,F=T.New;const j=new s.Emitter,W=new s.Emitter,$=new s.Emitter,U=new s.Emitter,V=new s.Emitter,B=b&&b.cancellationStrategy?b.cancellationStrategy:v.Message;function H(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function z(e){}function G(){return F===T.Listening}function Y(){return F===T.Closed}function X(){return F===T.Disposed}function Q(){F!==T.New&&F!==T.Listening||(F=T.Closed,W.fire(void 0))}function J(){P||0===L.size||(P=i.default().timer.setImmediate((()=>{P=void 0,function(){if(0===L.size)return;const e=L.shift();try{r.isRequestMessage(e)?function(e){if(X())return;function t(t,i,o){const a={jsonrpc:w,id:e.id};t instanceof r.ResponseError?a.error=t.toJson():a.result=void 0===t?null:t,ee(a,i,o),n.write(a)}function i(t,i,o){const r={jsonrpc:w,id:e.id,error:t.toJson()};ee(r,i,o),n.write(r)}!function(e){if(I!==f.Off&&A)if(q===h.Text){let t;I===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),A.log(`Received request '${e.method} - (${e.id})'.`,t)}else te("receive-request",e)}(e);const a=E[e.method];let s,c;a&&(s=a.type,c=a.handler);const l=Date.now();if(c||x){const a=String(e.id),d=B.receiver.createCancellationTokenSource(a);M[a]=d;try{let u;if(c)if(void 0===e.params){if(void 0!==s&&0!==s.numberOfParams)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines ${s.numberOfParams} params but recevied none.`),e.method,l);u=c(d.token)}else if(Array.isArray(e.params)){if(void 0!==s&&s.parameterStructures===r.ParameterStructures.byName)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,l);u=c(...e.params,d.token)}else{if(void 0!==s&&s.parameterStructures===r.ParameterStructures.byPosition)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,l);u=c(e.params,d.token)}else x&&(u=x(e.method,e.params,d.token));const f=u;u?f.then?f.then((n=>{delete M[a],t(n,e.method,l)}),(t=>{delete M[a],t instanceof r.ResponseError?i(t,e.method,l):t&&o.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(delete M[a],t(u,e.method,l)):(delete M[a],function(t,i,o){void 0===t&&(t=null);const r={jsonrpc:w,id:e.id,result:t};ee(r,i,o),n.write(r)}(u,e.method,l))}catch(n){delete M[a],n instanceof r.ResponseError?t(n,e.method,l):n&&o.string(n.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):r.isNotificationMessage(e)?function(e){if(X())return;let t,n;if(e.method===l.type.method)n=e=>{const t=e.id,n=M[String(t)];n&&n.cancel()};else{const i=D[e.method];i&&(n=i.handler,t=i.type)}if(n||O)try{!function(e){if(I!==f.Off&&A&&e.method!==m.type.method)if(q===h.Text){let t;I===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),A.log(`Received notification '${e.method}'.`,t)}else te("receive-notification",e)}(e),n?void 0===e.params?(void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==r.ParameterStructures.byName&&_.error(`Notification ${e.method} defines ${t.numberOfParams} params but recevied none.`),n()):Array.isArray(e.params)?(void 0!==t&&(t.parameterStructures===r.ParameterStructures.byName&&_.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&_.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${e.params.length} argumennts`)),n(...e.params)):(void 0!==t&&t.parameterStructures===r.ParameterStructures.byPosition&&_.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params)):O&&O(e.method,e.params)}catch(t){t.message?_.error(`Notification handler '${e.method}' failed with message: ${t.message}`):_.error(`Notification handler '${e.method}' failed unexpectedly.`)}else $.fire(e)}(e):r.isResponseMessage(e)?function(e){if(!X())if(null===e.id)e.error?_.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):_.error("Received response message without id. No further error information provided.");else{const t=String(e.id),n=N[t];if(function(e,t){if(I!==f.Off&&A)if(q===h.Text){let n;if(I===f.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";A.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else A.log(`Received response ${e.id} without active response promise.`,n)}else te("receive-response",e)}(e,n),n){delete N[t];try{if(e.error){const t=e.error;n.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?_.error(`Response handler '${n.method}' failed with message: ${e.message}`):_.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void _.error("Received empty message.");_.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(o.string(t.id)||o.number(t.id)){const e=String(t.id),n=N[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{J()}}()})))}e.onClose(Q),e.onError((function(e){j.fire([e,void 0,void 0])})),n.onClose(Q),n.onError((function(e){j.fire(e)}));const Z=e=>{try{if(r.isNotificationMessage(e)&&e.method===l.type.method){const t=H(e.params.id),i=L.get(t);if(r.isRequestMessage(i)){const o=null==b?void 0:b.connectionStrategy,r=o&&o.cancelUndispatched?o.cancelUndispatched(i,z):void 0;if(r&&(void 0!==r.error||void 0!==r.result))return L.delete(t),r.id=i.id,ee(r,e.method,Date.now()),void n.write(r)}}!function(e,t){var n;r.isRequestMessage(t)?e.set(H(t.id),t):r.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++C).toString():"res-"+n.toString(),t):e.set("not-"+(++S).toString(),t)}(L,e)}finally{J()}};function ee(e,t,n){if(I!==f.Off&&A)if(q===h.Text){let i;I===f.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),A.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else te("send-response",e)}function te(e,t){if(!A||I===f.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};A.log(n)}function ne(){if(Y())throw new R(g.Closed,"Connection is closed.");if(X())throw new R(g.Disposed,"Connection is disposed.")}function ie(e){return void 0===e?null:e}function oe(e){return null===e?void 0:e}function re(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function ae(e,t){switch(e){case r.ParameterStructures.auto:return re(t)?oe(t):[ie(t)];case r.ParameterStructures.byName:if(!re(t))throw new Error("Recevied parameters by name but param is not an object literal.");return oe(t);case r.ParameterStructures.byPosition:return[ie(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function se(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=ae(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(ie(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const ce={sendNotification:(e,...t)=>{let i,a;if(ne(),o.string(e)){i=e;const n=t[0];let o=0,s=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(o=1,s=n);let c=t.length;const l=c-o;switch(l){case 0:a=void 0;break;case 1:a=ae(s,t[o]);break;default:if(s===r.ParameterStructures.byName)throw new Error(`Recevied ${l} parameters for 'by Name' notification parameter structure.`);a=t.slice(o,c).map((e=>ie(e)))}}else{const n=t;i=e.method,a=se(e,n)}const s={jsonrpc:w,method:i,params:a};!function(e){if(I!==f.Off&&A)if(q===h.Text){let t;I===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),A.log(`Sending notification '${e.method}'.`,t)}else te("send-notification",e)}(s),n.write(s)},onNotification:(e,t)=>{let n;return ne(),o.func(e)?O=e:t&&(o.string(e)?(n=e,D[e]={type:void 0,handler:t}):(n=e.method,D[e.method]={type:e,handler:t})),{dispose:()=>{void 0!==n?delete D[n]:O=void 0}}},onProgress:(e,t,n)=>{if(K.has(t))throw new Error(`Progress handler for token ${t} already registered`);return K.set(t,n),{dispose:()=>{K.delete(t)}}},sendProgress:(e,t,n)=>{ce.sendNotification(d.type,{token:t,value:n})},onUnhandledProgress:U.event,sendRequest:(e,...t)=>{let i,a,s;if(ne(),function(){if(!G())throw new Error("Call listen() first.")}(),o.string(e)){i=e;const n=t[0],o=t[t.length-1];let l=0,d=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(l=1,d=n);let u=t.length;c.CancellationToken.is(o)&&(u-=1,s=o);const f=u-l;switch(f){case 0:a=void 0;break;case 1:a=ae(d,t[l]);break;default:if(d===r.ParameterStructures.byName)throw new Error(`Recevied ${f} parameters for 'by Name' request parameter structure.`);a=t.slice(l,u).map((e=>ie(e)))}}else{const n=t;i=e.method,a=se(e,n);const o=e.numberOfParams;s=c.CancellationToken.is(n[o])?n[o]:void 0}const l=k++;let d;return s&&(d=s.onCancellationRequested((()=>{B.sender.sendCancellation(ce,l)}))),new Promise(((e,t)=>{const o={jsonrpc:w,id:l,method:i,params:a};let s={method:i,timerStart:Date.now(),resolve:t=>{e(t),B.sender.cleanup(l),null==d||d.dispose()},reject:e=>{t(e),B.sender.cleanup(l),null==d||d.dispose()}};!function(e){if(I!==f.Off&&A)if(q===h.Text){let t;I===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),A.log(`Sending request '${e.method} - (${e.id})'.`,t)}else te("send-request",e)}(o);try{n.write(o)}catch(e){s.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),s=null}s&&(N[String(l)]=s)}))},onRequest:(e,t)=>{ne();let n=null;return u.is(e)?(n=void 0,x=e):o.string(e)?(n=null,void 0!==t&&(n=e,E[e]={handler:t,type:void 0})):void 0!==t&&(n=e.method,E[e.method]={type:e,handler:t}),{dispose:()=>{null!==n&&(void 0!==n?delete E[n]:x=void 0)}}},trace:(e,t,n)=>{let i=!1,r=h.Text;void 0!==n&&(o.boolean(n)?i=n:(i=n.sendNotification||!1,r=n.traceFormat||h.Text)),I=e,q=r,A=I===f.Off?void 0:t,!i||Y()||X()||ce.sendNotification(p.type,{value:f.toString(e)})},onError:j.event,onClose:W.event,onUnhandledNotification:$.event,onDispose:V.event,end:()=>{n.end()},dispose:()=>{if(X())return;F=T.Disposed,V.fire(void 0);const t=new Error("Connection got disposed.");Object.keys(N).forEach((e=>{N[e].reject(t)})),N=Object.create(null),M=Object.create(null),L=new a.LinkedMap,o.func(n.dispose)&&n.dispose(),o.func(e.dispose)&&e.dispose()},listen:()=>{ne(),function(){if(G())throw new R(g.AlreadyListening,"Connection is already listening")}(),F=T.Listening,e.listen(Z)},inspect:()=>{i.default().console.log("inspect")}};return ce.onNotification(m.type,(e=>{I!==f.Off&&A&&A.log(e.message,I===f.Verbose?e.verbose:void 0)})),ce.onNotification(d.type,(e=>{const t=K.get(e.token);t?t(e.value):U.fire(e)})),ce}},8159:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}}},345:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const i=n(8094);!function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class o{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,a=n.length;r<a;r++)try{t.push(n[r].apply(o[r],e))}catch(e){i.default().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new o),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=r,r._noop=function(){}},8472:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))}},5164:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=t.Touch||(t.Touch={}));class i{constructor(){this[Symbol.toStringTag]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let o=this._map.get(e);if(o)o.value=t,i!==n.None&&this.touch(o,i);else{switch(o={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(o);break;case n.First:this.addItemFirst(o);break;case n.Last:default:this.addItemLast(o)}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.key,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.value,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:[n.key,n.value],done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=i,t.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},5506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(0===this._chunks.length)return;let e=0,t=0,n=0,i=0;e:for(;t<this._chunks.length;){const o=this._chunks[t];for(n=0;n<o.length;){switch(o[n]){case 13:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case 10:switch(e){case 1:e=2;break;case 3:e=4,n++;break e;default:e=0}break;default:e=0}n++}i+=o.byteLength,t++}if(4!==e)return;const o=this._read(i+n),r=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return r;for(let e=0;e<a.length-2;e++){const t=a[e],n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const i=t.substr(0,n),o=t.substr(n+1).trim();r.set(i,o)}return r}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const o=i.slice(0,e);t.set(o,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}},4806:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const i=n(8094),o=n(8472),r=n(345);var a;(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&o.func(t.listen)&&o.func(t.dispose)&&o.func(t.onError)&&o.func(t.onClose)&&o.func(t.onPartialMessage)};class s{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=s,function(e){e.fromOptions=function(e){var t;let n,o;const r=new Map;let a;const s=new Map;if(void 0===e||"string"==typeof e)n=null!=e?e:"utf-8";else{if(n=null!==(t=e.charset)&&void 0!==t?t:"utf-8",void 0!==e.contentDecoder&&(o=e.contentDecoder,r.set(o.name,o)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)r.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(a=e.contentTypeDecoder,s.set(a.name,a)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===a&&(a=i.default().applicationJson.decoder,s.set(a.name,a)),{charset:n,contentDecoder:o,contentDecoders:r,contentTypeDecoder:a,contentTypeDecoders:s}}}(a||(a={})),t.ReadableStreamMessageReader=class extends s{constructor(e,t){super(),this.readable=e,this.options=a.fromOptions(t),this.buffer=i.default().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders();if(!e)return;const t=e.get("Content-Length");if(!t)throw new Error("Header must provide a Content-Length property.");const n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();let t;this.clearPartialMessageTimer(),this.nextMessageLength=-1,t=void 0!==this.options.contentDecoder?this.options.contentDecoder.decode(e):Promise.resolve(e),t.then((e=>{this.options.contentTypeDecoder.decode(e,this.options).then((e=>{this.callback(e)}),(e=>{this.fireError(e)}))}),(e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(i.default().timer.clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=i.default().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},9248:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const i=n(8094),o=n(8472),r=n(6791),a=n(345);var s;(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&o.func(t.dispose)&&o.func(t.onClose)&&o.func(t.onError)&&o.func(t.write)};class c{constructor(){this.errorEmitter=new a.Emitter,this.closeEmitter=new a.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=c,function(e){e.fromOptions=function(e){var t,n;return void 0===e||"string"==typeof e?{charset:null!=e?e:"utf-8",contentTypeEncoder:i.default().applicationJson.encoder}:{charset:null!==(t=e.charset)&&void 0!==t?t:"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:null!==(n=e.contentTypeEncoder)&&void 0!==n?n:i.default().applicationJson.encoder}}}(s||(s={})),t.WriteableStreamMessageWriter=class extends c{constructor(e,t){super(),this.writable=e,this.options=s.fromOptions(t),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},5285:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isResponseMessage=t.isNotificationMessage=t.isRequestMessage=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const i=n(8472);var o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=e.jsonrpcReservedErrorRangeStart,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=e.jsonrpcReservedErrorRangeEnd}(o=t.ErrorCodes||(t.ErrorCodes={}));class r extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:o.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=r;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class s{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=s,t.RequestType0=class extends s{constructor(e){super(e,0)}},t.RequestType=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends s{constructor(e){super(e,2)}},t.RequestType3=class extends s{constructor(e){super(e,3)}},t.RequestType4=class extends s{constructor(e){super(e,4)}},t.RequestType5=class extends s{constructor(e){super(e,5)}},t.RequestType6=class extends s{constructor(e){super(e,6)}},t.RequestType7=class extends s{constructor(e){super(e,7)}},t.RequestType8=class extends s{constructor(e){super(e,8)}},t.RequestType9=class extends s{constructor(e){super(e,9)}},t.NotificationType=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends s{constructor(e){super(e,0)}},t.NotificationType1=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends s{constructor(e){super(e,2)}},t.NotificationType3=class extends s{constructor(e){super(e,3)}},t.NotificationType4=class extends s{constructor(e){super(e,4)}},t.NotificationType5=class extends s{constructor(e){super(e,5)}},t.NotificationType6=class extends s{constructor(e){super(e,6)}},t.NotificationType7=class extends s{constructor(e){super(e,7)}},t.NotificationType8=class extends s{constructor(e){super(e,8)}},t.NotificationType9=class extends s{constructor(e){super(e,9)}},t.isRequestMessage=function(e){const t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},t.isNotificationMessage=function(e){const t=e;return t&&i.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}},8094:(e,t)=>{let n;function i(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(i||(i={})),t.default=i},6791:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(8094);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&i.default().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},1694:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const r=n(3590);r.default.install();const a=n(5748),s=n(1017),c=n(2037),l=n(6113),d=n(1808);o(n(5748),t);class u extends a.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){return this.process.on("message",e),a.Disposable.create((()=>this.process.off("message",e)))}}t.IPCMessageReader=u;class f extends a.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){try{return"function"==typeof this.process.send&&this.process.send(e,void 0,void 0,(t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0})),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.IPCMessageWriter=f;class h extends a.ReadableStreamMessageReader{constructor(e,t="utf-8"){super(r.default().stream.asReadableStream(e),t)}}t.SocketMessageReader=h;class p extends a.WriteableStreamMessageWriter{constructor(e,t){super(r.default().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=p;class m extends a.ReadableStreamMessageReader{constructor(e,t){super(r.default().stream.asReadableStream(e),t)}}t.StreamMessageReader=m;class g extends a.WriteableStreamMessageWriter{constructor(e,t){super(r.default().stream.asWritableStream(e),t)}}t.StreamMessageWriter=g;const y=process.env.XDG_RUNTIME_DIR,b=new Map([["linux",107],["darwin",103]]);t.generateRandomPipeName=function(){const e=l.randomBytes(21).toString("hex");if("win32"===process.platform)return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;t=y?s.join(y,`vscode-ipc-${e}.sock`):s.join(c.tmpdir(),`vscode-${e}.sock`);const n=b.get(process.platform);return void 0!==n&&t.length>=n&&r.default().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t},t.createClientPipeTransport=function(e,t="utf-8"){let n;const i=new Promise(((e,t)=>{n=e}));return new Promise(((o,r)=>{let a=d.createServer((e=>{a.close(),n([new h(e,t),new p(e,t)])}));a.on("error",r),a.listen(e,(()=>{a.removeListener("error",r),o({onConnected:()=>i})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const n=d.createConnection(e);return[new h(n,t),new p(n,t)]},t.createClientSocketTransport=function(e,t="utf-8"){let n;const i=new Promise(((e,t)=>{n=e}));return new Promise(((o,r)=>{const a=d.createServer((e=>{a.close(),n([new h(e,t),new p(e,t)])}));a.on("error",r),a.listen(e,"127.0.0.1",(()=>{a.removeListener("error",r),o({onConnected:()=>i})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const n=d.createConnection(e,"127.0.0.1");return[new h(n,t),new p(n,t)]},t.createMessageConnection=function(e,t,n,i){n||(n=a.NullLogger);const o=function(e){const t=e;return void 0!==t.read&&void 0!==t.addListener}(e)?new m(e):e,r=function(e){const t=e;return void 0!==t.write&&void 0!==t.addListener}(t)?new g(t):t;return a.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),a.createMessageConnection(o,r,n,i)}},3590:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(8094),o=n(3837),r=n(8159),a=n(5506);class s extends a.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return s.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new o.TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}}s.emptyBuffer=Buffer.allocUnsafe(0);class c{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),r.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),r.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),r.Disposable.create((()=>this.stream.off("end",e)))}onData(e){return this.stream.on("data",e),r.Disposable.create((()=>this.stream.off("data",e)))}}class l{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),r.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),r.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),r.Disposable.create((()=>this.stream.off("end",e)))}write(e,t){return new Promise(((n,i)=>{const o=e=>{null==e?n():i(e)};"string"==typeof e?this.stream.write(e,t,o):this.stream.write(e,o)}))}end(){this.stream.end()}}const d=Object.freeze({messageBuffer:Object.freeze({create:e=>new s(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(e){return Promise.reject(e)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new o.TextDecoder(t.charset).decode(e)))}catch(e){return Promise.reject(e)}}})}),stream:Object.freeze({asReadableStream:e=>new c(e),asWritableStream:e=>new l(e)}),console,timer:Object.freeze({setTimeout:(e,t,...n)=>setTimeout(e,t,...n),clearTimeout(e){clearTimeout(e)},setImmediate:(e,...t)=>setImmediate(e,...t),clearImmediate(e){clearImmediate(e)}})});function u(){return d}!function(e){e.install=function(){i.default.install(d)}}(u||(u={})),t.default=u},2659:(e,t,n)=>{e.exports=n(1694)},559:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,o(n(1694),t),o(n(2880),t),o(n(4742),t),o(n(7304),t);var r,a=n(7558);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return a.createProtocolConnection}}),(r=t.LSPErrorCodes||(t.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800},7558:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(1694);t.createProtocolConnection=function(e,t,n,o){return i.ConnectionStrategy.is(o)&&(o={connectionStrategy:o}),i.createMessageConnection(e,t,n,o)}},4742:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=void 0;const i=n(1694);t.RegistrationType=class{constructor(e){this.method=e}};class o extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=o;class r extends i.RequestType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolRequestType=r;class a extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a;class s extends i.NotificationType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolNotificationType=s},2565:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const i=n(4742);var o,r,a;(a=t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",a.type=new i.ProtocolRequestType(a.method),(r=t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",r.type=new i.ProtocolRequestType(r.method),(o=t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",o.type=new i.ProtocolRequestType(o.method)},5509:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const i=n(4742);var o;(o=t.DocumentColorRequest||(t.DocumentColorRequest={})).method="textDocument/documentColor",o.type=new i.ProtocolRequestType(o.method),(t.ColorPresentationRequest||(t.ColorPresentationRequest={})).type=new i.ProtocolRequestType("textDocument/colorPresentation")},7296:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const i=n(4742);(t.ConfigurationRequest||(t.ConfigurationRequest={})).type=new i.ProtocolRequestType("workspace/configuration")},9137:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const i=n(4742);var o;(o=t.DeclarationRequest||(t.DeclarationRequest={})).method="textDocument/declaration",o.type=new i.ProtocolRequestType(o.method)},2235:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const i=n(4742);var o,r,a,s,c,l,d;(d=t.FileOperationPatternKind||(t.FileOperationPatternKind={})).file="file",d.folder="folder",(l=t.WillCreateFilesRequest||(t.WillCreateFilesRequest={})).method="workspace/willCreateFiles",l.type=new i.ProtocolRequestType(l.method),(c=t.DidCreateFilesNotification||(t.DidCreateFilesNotification={})).method="workspace/didCreateFiles",c.type=new i.ProtocolNotificationType(c.method),(s=t.WillRenameFilesRequest||(t.WillRenameFilesRequest={})).method="workspace/willRenameFiles",s.type=new i.ProtocolRequestType(s.method),(a=t.DidRenameFilesNotification||(t.DidRenameFilesNotification={})).method="workspace/didRenameFiles",a.type=new i.ProtocolNotificationType(a.method),(r=t.DidDeleteFilesNotification||(t.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",r.type=new i.ProtocolNotificationType(r.method),(o=t.WillDeleteFilesRequest||(t.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",o.type=new i.ProtocolRequestType(o.method)},5171:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRequest=t.FoldingRangeKind=void 0;const i=n(4742);var o,r;(r=t.FoldingRangeKind||(t.FoldingRangeKind={})).Comment="comment",r.Imports="imports",r.Region="region",(o=t.FoldingRangeRequest||(t.FoldingRangeRequest={})).method="textDocument/foldingRange",o.type=new i.ProtocolRequestType(o.method)},2441:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const i=n(4742);var o;(o=t.ImplementationRequest||(t.ImplementationRequest={})).method="textDocument/implementation",o.type=new i.ProtocolRequestType(o.method)},7304:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeError=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.DocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=void 0;const i=n(9348),o=n(4742),r=n(2441);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return r.ImplementationRequest}});const a=n(8685);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return a.TypeDefinitionRequest}});const s=n(1343);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const c=n(7296);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return c.ConfigurationRequest}});const l=n(5509);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return l.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return l.ColorPresentationRequest}});const d=n(5171);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}});const u=n(9137);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return u.DeclarationRequest}});const f=n(2964);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return f.SelectionRangeRequest}});const h=n(7450);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const p=n(2565);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return p.CallHierarchyPrepareRequest}});const m=n(5402);Object.defineProperty(t,"SemanticTokenTypes",{enumerable:!0,get:function(){return m.SemanticTokenTypes}}),Object.defineProperty(t,"SemanticTokenModifiers",{enumerable:!0,get:function(){return m.SemanticTokenModifiers}}),Object.defineProperty(t,"SemanticTokens",{enumerable:!0,get:function(){return m.SemanticTokens}}),Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return m.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return m.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return m.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return m.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return m.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return m.SemanticTokensRegistrationType}});const g=n(903);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const y=n(7323);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const b=n(2235);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return b.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return b.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return b.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return b.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return b.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return b.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return b.WillDeleteFilesRequest}});const _=n(9219);var v,T,R,k,S,C,w,x,E,O,D,K,P,A,L,N,M,I,q,F,j,W,$,U,V,B,H,z,G,Y,X,Q,J,Z,ee,te,ne,ie,oe,re;Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return _.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return _.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return _.MonikerRequest}}),function(e){e.is=function(e){const t=e;return i.string(t.language)||i.string(t.scheme)||i.string(t.pattern)}}(v=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!i.string(t)&&!v.is(t))return!1;return!0}}(T=t.DocumentSelector||(t.DocumentSelector={})),(t.RegistrationRequest||(t.RegistrationRequest={})).type=new o.ProtocolRequestType("client/registerCapability"),(t.UnregistrationRequest||(t.UnregistrationRequest={})).type=new o.ProtocolRequestType("client/unregisterCapability"),(re=t.ResourceOperationKind||(t.ResourceOperationKind={})).Create="create",re.Rename="rename",re.Delete="delete",(oe=t.FailureHandlingKind||(t.FailureHandlingKind={})).Abort="abort",oe.Transactional="transactional",oe.TextOnlyTransactional="textOnlyTransactional",oe.Undo="undo",(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})).hasId=function(e){const t=e;return t&&i.string(t.id)&&t.id.length>0},(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})).is=function(e){const t=e;return t&&(null===t.documentSelector||T.is(t.documentSelector))},(ie=t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})).is=function(e){const t=e;return i.objectLiteral(t)&&(void 0===t.workDoneProgress||i.boolean(t.workDoneProgress))},ie.hasWorkDoneProgress=function(e){const t=e;return t&&i.boolean(t.workDoneProgress)},(t.InitializeRequest||(t.InitializeRequest={})).type=new o.ProtocolRequestType("initialize"),(t.InitializeError||(t.InitializeError={})).unknownProtocolVersion=1,(t.InitializedNotification||(t.InitializedNotification={})).type=new o.ProtocolNotificationType("initialized"),(t.ShutdownRequest||(t.ShutdownRequest={})).type=new o.ProtocolRequestType0("shutdown"),(t.ExitNotification||(t.ExitNotification={})).type=new o.ProtocolNotificationType0("exit"),(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})).type=new o.ProtocolNotificationType("workspace/didChangeConfiguration"),(ne=t.MessageType||(t.MessageType={})).Error=1,ne.Warning=2,ne.Info=3,ne.Log=4,(t.ShowMessageNotification||(t.ShowMessageNotification={})).type=new o.ProtocolNotificationType("window/showMessage"),(t.ShowMessageRequest||(t.ShowMessageRequest={})).type=new o.ProtocolRequestType("window/showMessageRequest"),(t.LogMessageNotification||(t.LogMessageNotification={})).type=new o.ProtocolNotificationType("window/logMessage"),(t.TelemetryEventNotification||(t.TelemetryEventNotification={})).type=new o.ProtocolNotificationType("telemetry/event"),(te=t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})).None=0,te.Full=1,te.Incremental=2,(ee=t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",ee.type=new o.ProtocolNotificationType(ee.method),(Z=t.TextDocumentContentChangeEvent||(t.TextDocumentContentChangeEvent={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},Z.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(J=t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})).method="textDocument/didChange",J.type=new o.ProtocolNotificationType(J.method),(Q=t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})).method="textDocument/didClose",Q.type=new o.ProtocolNotificationType(Q.method),(X=t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})).method="textDocument/didSave",X.type=new o.ProtocolNotificationType(X.method),(Y=t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})).Manual=1,Y.AfterDelay=2,Y.FocusOut=3,(G=t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})).method="textDocument/willSave",G.type=new o.ProtocolNotificationType(G.method),(z=t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",z.type=new o.ProtocolRequestType(z.method),(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})).type=new o.ProtocolNotificationType("workspace/didChangeWatchedFiles"),(H=t.FileChangeType||(t.FileChangeType={})).Created=1,H.Changed=2,H.Deleted=3,(B=t.WatchKind||(t.WatchKind={})).Create=1,B.Change=2,B.Delete=4,(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})).type=new o.ProtocolNotificationType("textDocument/publishDiagnostics"),(V=t.CompletionTriggerKind||(t.CompletionTriggerKind={})).Invoked=1,V.TriggerCharacter=2,V.TriggerForIncompleteCompletions=3,(U=t.CompletionRequest||(t.CompletionRequest={})).method="textDocument/completion",U.type=new o.ProtocolRequestType(U.method),($=t.CompletionResolveRequest||(t.CompletionResolveRequest={})).method="completionItem/resolve",$.type=new o.ProtocolRequestType($.method),(W=t.HoverRequest||(t.HoverRequest={})).method="textDocument/hover",W.type=new o.ProtocolRequestType(W.method),(j=t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})).Invoked=1,j.TriggerCharacter=2,j.ContentChange=3,(F=t.SignatureHelpRequest||(t.SignatureHelpRequest={})).method="textDocument/signatureHelp",F.type=new o.ProtocolRequestType(F.method),(q=t.DefinitionRequest||(t.DefinitionRequest={})).method="textDocument/definition",q.type=new o.ProtocolRequestType(q.method),(I=t.ReferencesRequest||(t.ReferencesRequest={})).method="textDocument/references",I.type=new o.ProtocolRequestType(I.method),(M=t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})).method="textDocument/documentHighlight",M.type=new o.ProtocolRequestType(M.method),(N=t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})).method="textDocument/documentSymbol",N.type=new o.ProtocolRequestType(N.method),(L=t.CodeActionRequest||(t.CodeActionRequest={})).method="textDocument/codeAction",L.type=new o.ProtocolRequestType(L.method),(A=t.CodeActionResolveRequest||(t.CodeActionResolveRequest={})).method="codeAction/resolve",A.type=new o.ProtocolRequestType(A.method),(P=t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})).method="workspace/symbol",P.type=new o.ProtocolRequestType(P.method),(K=t.CodeLensRequest||(t.CodeLensRequest={})).method="textDocument/codeLens",K.type=new o.ProtocolRequestType(K.method),(D=t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})).method="codeLens/resolve",D.type=new o.ProtocolRequestType(D.method),(O=t.CodeLensRefreshRequest||(t.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",O.type=new o.ProtocolRequestType0(O.method),(E=t.DocumentLinkRequest||(t.DocumentLinkRequest={})).method="textDocument/documentLink",E.type=new o.ProtocolRequestType(E.method),(x=t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})).method="documentLink/resolve",x.type=new o.ProtocolRequestType(x.method),(w=t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})).method="textDocument/formatting",w.type=new o.ProtocolRequestType(w.method),(C=t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",C.type=new o.ProtocolRequestType(C.method),(S=t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",S.type=new o.ProtocolRequestType(S.method),(t.PrepareSupportDefaultBehavior||(t.PrepareSupportDefaultBehavior={})).Identifier=1,(k=t.RenameRequest||(t.RenameRequest={})).method="textDocument/rename",k.type=new o.ProtocolRequestType(k.method),(R=t.PrepareRenameRequest||(t.PrepareRenameRequest={})).method="textDocument/prepareRename",R.type=new o.ProtocolRequestType(R.method),(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})).type=new o.ProtocolRequestType("workspace/executeCommand"),(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={})).type=new o.ProtocolRequestType("workspace/applyEdit")},7323:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const i=n(4742);var o;(o=t.LinkedEditingRangeRequest||(t.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",o.type=new i.ProtocolRequestType(o.method)},9219:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const i=n(4742);var o,r,a;(a=t.UniquenessLevel||(t.UniquenessLevel={})).document="document",a.project="project",a.group="group",a.scheme="scheme",a.global="global",(r=t.MonikerKind||(t.MonikerKind={})).import="import",r.export="export",r.local="local",(o=t.MonikerRequest||(t.MonikerRequest={})).method="textDocument/moniker",o.type=new i.ProtocolRequestType(o.method)},7450:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const i=n(1694),o=n(4742);var r;(r=t.WorkDoneProgress||(t.WorkDoneProgress={})).type=new i.ProgressType,r.is=function(e){return e===r.type},(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})).type=new o.ProtocolRequestType("window/workDoneProgress/create"),(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={})).type=new o.ProtocolNotificationType("window/workDoneProgress/cancel")},2964:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const i=n(4742);var o;(o=t.SelectionRangeRequest||(t.SelectionRangeRequest={})).method="textDocument/selectionRange",o.type=new i.ProtocolRequestType(o.method)},5402:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=void 0;const i=n(4742);var o,r,a,s,c,l,d;(d=t.SemanticTokenTypes||(t.SemanticTokenTypes={})).namespace="namespace",d.type="type",d.class="class",d.enum="enum",d.interface="interface",d.struct="struct",d.typeParameter="typeParameter",d.parameter="parameter",d.variable="variable",d.property="property",d.enumMember="enumMember",d.event="event",d.function="function",d.method="method",d.macro="macro",d.keyword="keyword",d.modifier="modifier",d.comment="comment",d.string="string",d.number="number",d.regexp="regexp",d.operator="operator",(l=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})).declaration="declaration",l.definition="definition",l.readonly="readonly",l.static="static",l.deprecated="deprecated",l.abstract="abstract",l.async="async",l.modification="modification",l.documentation="documentation",l.defaultLibrary="defaultLibrary",(t.SemanticTokens||(t.SemanticTokens={})).is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])},(t.TokenFormat||(t.TokenFormat={})).Relative="relative",(c=t.SemanticTokensRegistrationType||(t.SemanticTokensRegistrationType={})).method="textDocument/semanticTokens",c.type=new i.RegistrationType(c.method),(s=t.SemanticTokensRequest||(t.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",s.type=new i.ProtocolRequestType(s.method),(a=t.SemanticTokensDeltaRequest||(t.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",a.type=new i.ProtocolRequestType(a.method),(r=t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",r.type=new i.ProtocolRequestType(r.method),(o=t.SemanticTokensRefreshRequest||(t.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",o.type=new i.ProtocolRequestType0(o.method)},903:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const i=n(4742);var o;(o=t.ShowDocumentRequest||(t.ShowDocumentRequest={})).method="window/showDocument",o.type=new i.ProtocolRequestType(o.method)},8685:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const i=n(4742);var o;(o=t.TypeDefinitionRequest||(t.TypeDefinitionRequest={})).method="textDocument/typeDefinition",o.type=new i.ProtocolRequestType(o.method)},1343:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const i=n(4742);(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})).type=new i.ProtocolRequestType0("workspace/workspaceFolders"),(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={})).type=new i.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")},9348:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},7745:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const r=n(2659);o(n(2659),t),o(n(559),t),t.createProtocolConnection=function(e,t,n,i){return r.createMessageConnection(e,t,n,i)}},4057:(e,t,n)=>{e.exports=n(7745)},6288:(e,t,n)=>{n.r(t),n.d(t,{TextDocument:()=>i});var i,o=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(t,n){for(var i=0,o=t;i<o.length;i++){var r=o[i];if(e.isIncremental(r)){var c=s(r.range),l=this.offsetAt(c.start),d=this.offsetAt(c.end);this._content=this._content.substring(0,l)+r.text+this._content.substring(d,this._content.length);var u=Math.max(c.start.line,0),f=Math.max(c.end.line,0),h=this._lineOffsets,p=a(r.text,!1,l);if(f-u===p.length)for(var m=0,g=p.length;m<g;m++)h[m+u+1]=p[m];else p.length<1e4?h.splice.apply(h,[u+1,f-u].concat(p)):this._lineOffsets=h=h.slice(0,u+1).concat(p,h.slice(f+1));var y=r.text.length-(d-l);if(0!==y)for(m=u+1+p.length,g=h.length;m<g;m++)h[m]=h[m]+y}else{if(!e.isFull(r))throw new Error("Unknown change event received");this._content=r.text,this._lineOffsets=void 0}}this._version=n},e.prototype.getLineOffsets=function(){return void 0===this._lineOffsets&&(this._lineOffsets=a(this._content,!0)),this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return{line:0,character:e};for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var r=n-1;return{line:r,character:e-t[r]}},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e.isIncremental=function(e){var t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){var t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},e}();function r(e,t){if(e.length<=1)return e;var n=e.length/2|0,i=e.slice(0,n),o=e.slice(n);r(i,t),r(o,t);for(var a=0,s=0,c=0;a<i.length&&s<o.length;){var l=t(i[a],o[s]);e[c++]=l<=0?i[a++]:o[s++]}for(;a<i.length;)e[c++]=i[a++];for(;s<o.length;)e[c++]=o[s++];return e}function a(e,t,n){void 0===n&&(n=0);for(var i=t?[n]:[],o=0;o<e.length;o++){var r=e.charCodeAt(o);13!==r&&10!==r||(13===r&&o+1<e.length&&10===e.charCodeAt(o+1)&&o++,i.push(n+o+1))}return i}function s(e){var t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function c(e){var t=s(e.range);return t!==e.range?{newText:e.newText,range:t}:e}!function(e){e.create=function(e,t,n,i){return new o(e,t,n,i)},e.update=function(e,t,n){if(e instanceof o)return e.update(t,n),e;throw new Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){for(var n=e.getText(),i=0,o=[],a=0,s=r(t.map(c),(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n}));a<s.length;a++){var l=s[a],d=e.offsetAt(l.range.start);if(d<i)throw new Error("Overlapping edit");d>i&&o.push(n.substring(i,d)),l.newText.length&&o.push(l.newText),i=e.offsetAt(l.range.end)}return o.push(n.substr(i)),o.join("")}}(i||(i={}))},2880:(e,t,n)=>{var i,o,r,a,s,c,l,d,u,f,h,p,m,g,y,b,_,v,T,R,k,S,C,w,x,E;n.r(t),n.d(t,{integer:()=>i,uinteger:()=>o,Position:()=>r,Range:()=>a,Location:()=>s,LocationLink:()=>c,Color:()=>l,ColorInformation:()=>d,ColorPresentation:()=>u,FoldingRangeKind:()=>f,FoldingRange:()=>h,DiagnosticRelatedInformation:()=>p,DiagnosticSeverity:()=>m,DiagnosticTag:()=>g,CodeDescription:()=>y,Diagnostic:()=>b,Command:()=>_,TextEdit:()=>v,ChangeAnnotation:()=>T,ChangeAnnotationIdentifier:()=>R,AnnotatedTextEdit:()=>k,TextDocumentEdit:()=>S,CreateFile:()=>C,RenameFile:()=>w,DeleteFile:()=>x,WorkspaceEdit:()=>E,WorkspaceChange:()=>se,TextDocumentIdentifier:()=>O,VersionedTextDocumentIdentifier:()=>D,OptionalVersionedTextDocumentIdentifier:()=>K,TextDocumentItem:()=>P,MarkupKind:()=>A,MarkupContent:()=>L,CompletionItemKind:()=>N,InsertTextFormat:()=>M,CompletionItemTag:()=>I,InsertReplaceEdit:()=>q,InsertTextMode:()=>F,CompletionItem:()=>j,CompletionList:()=>W,MarkedString:()=>$,Hover:()=>U,ParameterInformation:()=>V,SignatureInformation:()=>B,DocumentHighlightKind:()=>H,DocumentHighlight:()=>z,SymbolKind:()=>G,SymbolTag:()=>Y,SymbolInformation:()=>X,DocumentSymbol:()=>Q,CodeActionKind:()=>J,CodeActionContext:()=>Z,CodeAction:()=>ee,CodeLens:()=>te,FormattingOptions:()=>ne,DocumentLink:()=>ie,SelectionRange:()=>oe,EOL:()=>le,TextDocument:()=>ce}),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647}(i||(i={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647}(o||(o={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=o.MAX_VALUE),t===Number.MAX_VALUE&&(t=o.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return de.objectLiteral(t)&&de.uinteger(t.line)&&de.uinteger(t.character)}}(r||(r={})),function(e){e.create=function(e,t,n,i){if(de.uinteger(e)&&de.uinteger(t)&&de.uinteger(n)&&de.uinteger(i))return{start:r.create(e,t),end:r.create(n,i)};if(r.is(e)&&r.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+i+"]")},e.is=function(e){var t=e;return de.objectLiteral(t)&&r.is(t.start)&&r.is(t.end)}}(a||(a={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return de.defined(t)&&a.is(t.range)&&(de.string(t.uri)||de.undefined(t.uri))}}(s||(s={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return de.defined(t)&&a.is(t.targetRange)&&de.string(t.targetUri)&&(a.is(t.targetSelectionRange)||de.undefined(t.targetSelectionRange))&&(a.is(t.originSelectionRange)||de.undefined(t.originSelectionRange))}}(c||(c={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return de.numberRange(t.red,0,1)&&de.numberRange(t.green,0,1)&&de.numberRange(t.blue,0,1)&&de.numberRange(t.alpha,0,1)}}(l||(l={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return a.is(t.range)&&l.is(t.color)}}(d||(d={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return de.string(t.label)&&(de.undefined(t.textEdit)||v.is(t))&&(de.undefined(t.additionalTextEdits)||de.typedArray(t.additionalTextEdits,v.is))}}(u||(u={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(f||(f={})),function(e){e.create=function(e,t,n,i,o){var r={startLine:e,endLine:t};return de.defined(n)&&(r.startCharacter=n),de.defined(i)&&(r.endCharacter=i),de.defined(o)&&(r.kind=o),r},e.is=function(e){var t=e;return de.uinteger(t.startLine)&&de.uinteger(t.startLine)&&(de.undefined(t.startCharacter)||de.uinteger(t.startCharacter))&&(de.undefined(t.endCharacter)||de.uinteger(t.endCharacter))&&(de.undefined(t.kind)||de.string(t.kind))}}(h||(h={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return de.defined(t)&&s.is(t.location)&&de.string(t.message)}}(p||(p={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(m||(m={})),function(e){e.Unnecessary=1,e.Deprecated=2}(g||(g={})),function(e){e.is=function(e){var t=e;return null!=t&&de.string(t.href)}}(y||(y={})),function(e){e.create=function(e,t,n,i,o,r){var a={range:e,message:t};return de.defined(n)&&(a.severity=n),de.defined(i)&&(a.code=i),de.defined(o)&&(a.source=o),de.defined(r)&&(a.relatedInformation=r),a},e.is=function(e){var t,n=e;return de.defined(n)&&a.is(n.range)&&de.string(n.message)&&(de.number(n.severity)||de.undefined(n.severity))&&(de.integer(n.code)||de.string(n.code)||de.undefined(n.code))&&(de.undefined(n.codeDescription)||de.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(de.string(n.source)||de.undefined(n.source))&&(de.undefined(n.relatedInformation)||de.typedArray(n.relatedInformation,p.is))}}(b||(b={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={title:e,command:t};return de.defined(n)&&n.length>0&&(o.arguments=n),o},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.title)&&de.string(t.command)}}(_||(_={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return de.objectLiteral(t)&&de.string(t.newText)&&a.is(t.range)}}(v||(v={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return void 0!==t&&de.objectLiteral(t)&&de.string(t.label)&&(de.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(de.string(t.description)||void 0===t.description)}}(T||(T={})),function(e){e.is=function(e){return"string"==typeof e}}(R||(R={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return v.is(t)&&(T.is(t.annotationId)||R.is(t.annotationId))}}(k||(k={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return de.defined(t)&&K.is(t.textDocument)&&Array.isArray(t.edits)}}(S||(S={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&de.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||de.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||de.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||R.is(t.annotationId))}}(C||(C={})),function(e){e.create=function(e,t,n,i){var o={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(o.options=n),void 0!==i&&(o.annotationId=i),o},e.is=function(e){var t=e;return t&&"rename"===t.kind&&de.string(t.oldUri)&&de.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||de.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||de.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||R.is(t.annotationId))}}(w||(w={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&de.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||de.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||de.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||R.is(t.annotationId))}}(x||(x={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return de.string(e.kind)?C.is(e)||w.is(e)||x.is(e):S.is(e)})))}}(E||(E={}));var O,D,K,P,A,L,N,M,I,q,F,j,W,$,U,V,B,H,z,G,Y,X,Q,J,Z,ee,te,ne,ie,oe,re=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,o;if(void 0===n?i=v.insert(e,t):R.is(n)?(o=n,i=k.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=k.insert(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.replace=function(e,t,n){var i,o;if(void 0===n?i=v.replace(e,t):R.is(n)?(o=n,i=k.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=k.replace(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=v.del(e):R.is(t)?(i=t,n=k.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=k.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),ae=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(R.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id "+n+" is already in use.");if(void 0===t)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),se=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new ae(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(S.is(e)){var n=new re(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new re(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(K.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:o=[]};this._workspaceEdit.documentChanges.push(n),i=new re(o,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var o=[];this._workspaceEdit.changes[e]=o,i=new re(o),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new ae,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(T.is(t)||R.is(t)?i=t:n=t,void 0===i?o=C.create(e,n):(r=R.is(i)?i:this._changeAnnotations.manage(i),o=C.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var o,r,a;if(T.is(n)||R.is(n)?o=n:i=n,void 0===o?r=w.create(e,t,i):(a=R.is(o)?o:this._changeAnnotations.manage(o),r=w.create(e,t,i,a)),this._workspaceEdit.documentChanges.push(r),void 0!==a)return a},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(T.is(t)||R.is(t)?i=t:n=t,void 0===i?o=x.create(e,n):(r=R.is(i)?i:this._changeAnnotations.manage(i),o=x.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)}}(O||(O={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)&&de.integer(t.version)}}(D||(D={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)&&(null===t.version||de.integer(t.version))}}(K||(K={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)&&de.string(t.languageId)&&de.integer(t.version)&&de.string(t.text)}}(P||(P={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(A||(A={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(A||(A={})),function(e){e.is=function(e){var t=e;return de.objectLiteral(e)&&A.is(t.kind)&&de.string(t.value)}}(L||(L={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(N||(N={})),function(e){e.PlainText=1,e.Snippet=2}(M||(M={})),function(e){e.Deprecated=1}(I||(I={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&de.string(t.newText)&&a.is(t.insert)&&a.is(t.replace)}}(q||(q={})),function(e){e.asIs=1,e.adjustIndentation=2}(F||(F={})),function(e){e.create=function(e){return{label:e}}}(j||(j={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(W||(W={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return de.string(t)||de.objectLiteral(t)&&de.string(t.language)&&de.string(t.value)}}($||($={})),function(e){e.is=function(e){var t=e;return!!t&&de.objectLiteral(t)&&(L.is(t.contents)||$.is(t.contents)||de.typedArray(t.contents,$.is))&&(void 0===e.range||a.is(e.range))}}(U||(U={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(V||(V={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={label:e};return de.defined(t)&&(o.documentation=t),de.defined(n)?o.parameters=n:o.parameters=[],o}}(B||(B={})),function(e){e.Text=1,e.Read=2,e.Write=3}(H||(H={})),function(e){e.create=function(e,t){var n={range:e};return de.number(t)&&(n.kind=t),n}}(z||(z={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(G||(G={})),function(e){e.Deprecated=1}(Y||(Y={})),function(e){e.create=function(e,t,n,i,o){var r={name:e,kind:t,location:{uri:i,range:n}};return o&&(r.containerName=o),r}}(X||(X={})),function(e){e.create=function(e,t,n,i,o,r){var a={name:e,detail:t,kind:n,range:i,selectionRange:o};return void 0!==r&&(a.children=r),a},e.is=function(e){var t=e;return t&&de.string(t.name)&&de.number(t.kind)&&a.is(t.range)&&a.is(t.selectionRange)&&(void 0===t.detail||de.string(t.detail))&&(void 0===t.deprecated||de.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(Q||(Q={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(J||(J={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return de.defined(t)&&de.typedArray(t.diagnostics,b.is)&&(void 0===t.only||de.typedArray(t.only,de.string))}}(Z||(Z={})),function(e){e.create=function(e,t,n){var i={title:e},o=!0;return"string"==typeof t?(o=!1,i.kind=t):_.is(t)?i.command=t:i.edit=t,o&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&de.string(t.title)&&(void 0===t.diagnostics||de.typedArray(t.diagnostics,b.is))&&(void 0===t.kind||de.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||_.is(t.command))&&(void 0===t.isPreferred||de.boolean(t.isPreferred))&&(void 0===t.edit||E.is(t.edit))}}(ee||(ee={})),function(e){e.create=function(e,t){var n={range:e};return de.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return de.defined(t)&&a.is(t.range)&&(de.undefined(t.command)||_.is(t.command))}}(te||(te={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return de.defined(t)&&de.uinteger(t.tabSize)&&de.boolean(t.insertSpaces)}}(ne||(ne={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return de.defined(t)&&a.is(t.range)&&(de.undefined(t.target)||de.string(t.target))}}(ie||(ie={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&a.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(oe||(oe={}));var ce,le=["\n","\r\n","\r"];!function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,o=e.slice(0,i),r=e.slice(i);t(o,n),t(r,n);for(var a=0,s=0,c=0;a<o.length&&s<r.length;){var l=n(o[a],r[s]);e[c++]=l<=0?o[a++]:r[s++]}for(;a<o.length;)e[c++]=o[a++];for(;s<r.length;)e[c++]=r[s++];return e}e.create=function(e,t,n,i){return new ue(e,t,n,i)},e.is=function(e){var t=e;return!!(de.defined(t)&&de.string(t.uri)&&(de.undefined(t.languageId)||de.string(t.languageId))&&de.uinteger(t.lineCount)&&de.func(t.getText)&&de.func(t.positionAt)&&de.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),o=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=i.length,a=o.length-1;a>=0;a--){var s=o[a],c=e.offsetAt(s.range.start),l=e.offsetAt(s.range.end);if(!(l<=r))throw new Error("Overlapping edit");i=i.substring(0,c)+s.newText+i.substring(l,i.length),r=c}return i}}(ce||(ce={}));var de,ue=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var o=t.charAt(i);n="\r"===o||"\n"===o,"\r"===o&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return r.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var a=n-1;return r.create(a,e-t[a])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(de||(de={}))},9936:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.SemanticTokensBuilder=void 0;const r=n(7255);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}}),o(n(7745),t),o(n(6717),t),(t.ProposedFeatures||(t.ProposedFeatures={})).all={__brand:"features"}},4225:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const i=n(7745);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>{this.connection.onRequest(i.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))},onIncomingCalls:e=>{const t=i.CallHierarchyIncomingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=i.CallHierarchyOutgoingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},3606:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const i=n(7745),o=n(6960);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?o.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(i.ConfigurationRequest.type,t).then((t=>Array.isArray(e)?t:t[0]))}}},7695:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const i=n(7745);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){this.connection.onNotification(i.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){this.connection.onNotification(i.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){this.connection.onNotification(i.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(i.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(i.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(i.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},7129:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const i=n(7745);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){this.connection.onRequest(i.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const i=n(7745);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=i.MonikerRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},3787:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const i=n(7745),o=n(7867);class r{constructor(e,t){this._connection=e,this._token=t,r.Instances.set(this._token,this)}begin(e,t,n,o){let r={kind:"begin",title:e,percentage:t,message:n,cancellable:o};this._connection.sendProgress(i.WorkDoneProgress.type,this._token,r)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(i.WorkDoneProgress.type,this._token,n)}done(){r.Instances.delete(this._token),this._connection.sendProgress(i.WorkDoneProgress.type,this._token,{kind:"end"})}}r.Instances=new Map;class a extends r{constructor(e,t){super(e,t),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class s{constructor(){}begin(){}report(){}done(){}}class c extends s{constructor(){super(),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var l;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new s;const n=t.workDoneToken;return delete t.workDoneToken,new r(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){var t;!0===(null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.workDoneProgress)&&(this._progressSupported=!0,this.connection.onNotification(i.WorkDoneProgressCancelNotification.type,(e=>{let t=r.Instances.get(e.token);(t instanceof a||t instanceof c)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new s:new r(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=o.generateUuid();return this.connection.sendRequest(i.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new a(this.connection,e)))}return Promise.resolve(new c)}},function(e){e.type=new i.ProgressType}(l||(l={}));class d{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(l.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new d(e,n)}},7255:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensFeature=void 0;const i=n(7745);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{on:e=>{const t=i.SemanticTokensRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=i.SemanticTokensDeltaRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=i.SemanticTokensRangeRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}},t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,i,o){let r=e,a=t;this._dataLen>0&&(r-=this._prevLine,0===r&&(a-=this._prevChar)),this._data[this._dataLen++]=r,this._data[this._dataLen++]=a,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){if(void 0!==this._prevData){const e=this._prevData.length,t=this._data.length;let n=0;for(;n<t&&n<e&&this._prevData[n]===this._data[n];)n++;if(n<t&&n<e){let i=0;for(;i<t&&i<e&&this._prevData[e-1-i]===this._data[t-1-i];)i++;const o=this._data.slice(n,t-i);return{resultId:this.id,edits:[{start:n,deleteCount:e-i-n,data:o}]}}return n<t?{resultId:this.id,edits:[{start:n,deleteCount:0,data:this._data.slice(n)}]}:n<e?{resultId:this.id,edits:[{start:n,deleteCount:e-n}]}:{resultId:this.id,edits:[]}}return this.build()}}},6717:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=t.TextDocuments=void 0;const i=n(7745),o=n(6960),r=n(7867),a=n(3787),s=n(3606),c=n(518),l=n(4225),d=n(7255),u=n(9283),f=n(7695),h=n(7129),p=n(8535);function m(e){if(null!==e)return e}t.TextDocuments=class{constructor(e){this._documents=Object.create(null),this._configuration=e,this._onDidChangeContent=new i.Emitter,this._onDidOpen=new i.Emitter,this._onDidClose=new i.Emitter,this._onDidSave=new i.Emitter,this._onWillSave=new i.Emitter}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidOpen(){return this._onDidOpen.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._documents[e]}all(){return Object.keys(this._documents).map((e=>this._documents[e]))}keys(){return Object.keys(this._documents)}listen(e){e.__textDocumentSync=i.TextDocumentSyncKind.Full,e.onDidOpenTextDocument((e=>{let t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._documents[t.uri]=n;let i=Object.freeze({document:n});this._onDidOpen.fire(i),this._onDidChangeContent.fire(i)})),e.onDidChangeTextDocument((e=>{let t=e.textDocument,n=e.contentChanges;if(0===n.length)return;let i=this._documents[t.uri];const{version:o}=t;if(null==o)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);i=this._configuration.update(i,n,o),this._documents[t.uri]=i,this._onDidChangeContent.fire(Object.freeze({document:i}))})),e.onDidCloseTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&(delete this._documents[e.textDocument.uri],this._onDidClose.fire(Object.freeze({document:t})))})),e.onWillSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))})),e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._documents[e.textDocument.uri];return n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]})),e.onDidSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onDidSave.fire(Object.freeze({document:t}))}))}},t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class g{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(i.MessageType.Error,e)}warn(e){this.send(i.MessageType.Warning,e)}info(e){this.send(i.MessageType.Info,e)}log(e){this.send(i.MessageType.Log,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(i.LogMessageNotification.type,{type:e,message:t})}}const y=u.ShowDocumentFeature(a.ProgressFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:i.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(m)}showWarningMessage(e,...t){let n={type:i.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(m)}showInformationMessage(e,...t){let n={type:i.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(m)}}));(t.BulkRegistration||(t.BulkRegistration={})).create=function(){return new b};class b{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=o.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const i=r.generateUuid();this._registrations.push({id:i,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}(t.BulkUnregistration||(t.BulkUnregistration={})).create=function(){return new _(void 0,[])};class _{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(i.UnregistrationRequest.type,t).then(void 0,(e=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=o.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let r={unregisterations:[n]};return this._connection.sendRequest(i.UnregistrationRequest.type,r).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class v{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof b?this.registerMany(e):e instanceof _?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const a=o.string(t)?t:t.method,s=r.generateUuid();let c={registrations:[{id:s,method:a,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(i.RegistrationRequest.type,c).then((t=>(e.add({id:s,method:a}),e)),(e=>(this.connection.console.info(`Registering request handler for ${a} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=o.string(e)?e:e.method,a=r.generateUuid();let s={registrations:[{id:a,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(i.RegistrationRequest.type,s).then((e=>i.Disposable.create((()=>{this.unregisterSingle(a,n)}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(i.UnregistrationRequest.type,n).then(void 0,(t=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(i.RegistrationRequest.type,t).then((()=>new _(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const T=f.FileOperationsFeature(c.WorkspaceFoldersFeature(s.ConfigurationFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(i.ApplyWorkspaceEditRequest.type,t)}})));class R{constructor(){this._trace=i.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==i.Trace.Off&&this.connection.sendNotification(i.LogTraceNotification.type,{message:e,verbose:this._trace===i.Trace.Verbose?t:void 0})}}class k{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(i.TelemetryEventNotification.type,e)}}class S{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return a.attachWorkDone(this.connection,e)}attachPartialResultProgress(e,t){return a.attachPartialResult(this.connection,t)}}t._LanguagesImpl=S;const C=p.MonikerFeature(h.LinkedEditingRangeFeature(d.SemanticTokensFeature(l.CallHierarchyFeature(S))));function w(e,t){return function(n){return t(e(n))}}function x(e,t){return function(n){return t(e(n))}}function E(e,t){return function(n){return t(e(n))}}function O(e,t){return function(n){return t(e(n))}}function D(e,t){return function(n){return t(e(n))}}function K(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=w,t.combineTelemetryFeatures=x,t.combineTracerFeatures=E,t.combineClientFeatures=O,t.combineWindowFeatures=D,t.combineWorkspaceFeatures=K,t.combineLanguagesFeatures=function(e,t){return function(n){return t(e(n))}},t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,w),tracer:n(e.tracer,t.tracer,E),telemetry:n(e.telemetry,t.telemetry,x),client:n(e.client,t.client,O),window:n(e.window,t.window,D),workspace:n(e.workspace,t.workspace,K)}},t.createConnection=function(e,t,n){const r=n&&n.console?new(n.console(g)):new g,s=e(r);r.rawAttach(s);const c=n&&n.tracer?new(n.tracer(R)):new R,l=n&&n.telemetry?new(n.telemetry(k)):new k,d=n&&n.client?new(n.client(v)):new v,u=n&&n.window?new(n.window(y)):new y,f=n&&n.workspace?new(n.workspace(T)):new T,h=n&&n.languages?new(n.languages(C)):new C,p=[r,c,l,d,u,f,h];function m(e){return e instanceof Promise?e:o.thenable(e)?new Promise(((t,n)=>{e.then((e=>t(e)),(e=>n(e)))})):Promise.resolve(e)}let b,_,S,w={listen:()=>s.listen(),sendRequest:(e,...t)=>s.sendRequest(o.string(e)?e:e.method,...t),onRequest:(e,t)=>s.onRequest(e,t),sendNotification:(e,t)=>{const n=o.string(e)?e:e.method;1===arguments.length?s.sendNotification(n):s.sendNotification(n,t)},onNotification:(e,t)=>s.onNotification(e,t),onProgress:s.onProgress,sendProgress:s.sendProgress,onInitialize:e=>_=e,onInitialized:e=>s.onNotification(i.InitializedNotification.type,e),onShutdown:e=>b=e,onExit:e=>S=e,get console(){return r},get telemetry(){return l},get tracer(){return c},get client(){return d},get window(){return u},get workspace(){return f},get languages(){return h},onDidChangeConfiguration:e=>s.onNotification(i.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>s.onNotification(i.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>s.onNotification(i.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>s.onNotification(i.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>s.onNotification(i.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>s.onNotification(i.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>s.onRequest(i.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>s.onNotification(i.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>s.sendNotification(i.PublishDiagnosticsNotification.type,e),onHover:e=>s.onRequest(i.HoverRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onCompletion:e=>s.onRequest(i.CompletionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCompletionResolve:e=>s.onRequest(i.CompletionResolveRequest.type,e),onSignatureHelp:e=>s.onRequest(i.SignatureHelpRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onDeclaration:e=>s.onRequest(i.DeclarationRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDefinition:e=>s.onRequest(i.DefinitionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onTypeDefinition:e=>s.onRequest(i.TypeDefinitionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onImplementation:e=>s.onRequest(i.ImplementationRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onReferences:e=>s.onRequest(i.ReferencesRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDocumentHighlight:e=>s.onRequest(i.DocumentHighlightRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDocumentSymbol:e=>s.onRequest(i.DocumentSymbolRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onWorkspaceSymbol:e=>s.onRequest(i.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCodeAction:e=>s.onRequest(i.CodeActionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCodeActionResolve:e=>s.onRequest(i.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>s.onRequest(i.CodeLensRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCodeLensResolve:e=>s.onRequest(i.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>s.onRequest(i.DocumentFormattingRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onDocumentRangeFormatting:e=>s.onRequest(i.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onDocumentOnTypeFormatting:e=>s.onRequest(i.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>s.onRequest(i.RenameRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onPrepareRename:e=>s.onRequest(i.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>s.onRequest(i.DocumentLinkRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDocumentLinkResolve:e=>s.onRequest(i.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>s.onRequest(i.DocumentColorRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onColorPresentation:e=>s.onRequest(i.ColorPresentationRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onFoldingRanges:e=>s.onRequest(i.FoldingRangeRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onSelectionRanges:e=>s.onRequest(i.SelectionRangeRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onExecuteCommand:e=>s.onRequest(i.ExecuteCommandRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),dispose:()=>s.dispose()};for(let e of p)e.attach(w);return s.onRequest(i.InitializeRequest.type,(e=>{t.initialize(e),o.string(e.trace)&&(c.trace=i.Trace.fromString(e.trace));for(let t of p)t.initialize(e.capabilities);if(_)return m(_(e,(new i.CancellationTokenSource).token,a.attachWorkDone(s,e),void 0)).then((e=>{if(e instanceof i.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=o.number(w.__textDocumentSync)?w.__textDocumentSync:i.TextDocumentSyncKind.None:o.number(n.textDocumentSync)||o.number(n.textDocumentSync.change)||(n.textDocumentSync.change=o.number(w.__textDocumentSync)?w.__textDocumentSync:i.TextDocumentSyncKind.None);for(let e of p)e.fillServerCapabilities(n);return t}));{let e={capabilities:{textDocumentSync:i.TextDocumentSyncKind.None}};for(let t of p)t.fillServerCapabilities(e.capabilities);return e}})),s.onRequest(i.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,b?b((new i.CancellationTokenSource).token):void 0))),s.onNotification(i.ExitNotification.type,(()=>{try{S&&S()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),s.onNotification(i.SetTraceNotification.type,(e=>{c.trace=i.Trace.fromString(e.value)})),w}},9283:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const i=n(7745);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(i.ShowDocumentRequest.type,e)}}},6960:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function o(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=i,t.array=o,t.stringArray=function(e){return o(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&i(e.then)}},7867:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class i extends n{constructor(){super([i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-","4",i._randomHex(),i._randomHex(),i._randomHex(),"-",i._oneOf(i._timeHighBits),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return i._oneOf(i._chars)}}function o(){return new i}i._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],i._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=o;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return r.test(e)}t.isUUID=a,t.parse=function(e){if(!a(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return o().asHex()}},518:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const i=n(7745);t.WorkspaceFoldersFeature=e=>class extends e{initialize(e){let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new i.Emitter,this.connection.onNotification(i.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}getWorkspaceFolders(){return this.connection.sendRequest(i.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._unregistration||(this._unregistration=this.connection.client.register(i.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},1507:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveModulePath=t.FileSystem=t.resolveGlobalYarnPath=t.resolveGlobalNodePath=t.resolve=t.uriToFilePath=void 0;const i=n(7310),o=n(1017),r=n(7147),a=n(2081);function s(){return"win32"===process.platform}function c(e,t,n,i){const s=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise(((c,l)=>{let d=process.env,u=Object.create(null);Object.keys(d).forEach((e=>u[e]=d[e])),t&&r.existsSync(t)&&(u.NODE_PATH?u.NODE_PATH=t+o.delimiter+u.NODE_PATH:u.NODE_PATH=t,i&&i(`NODE_PATH value is: ${u.NODE_PATH}`)),u.ELECTRON_RUN_AS_NODE="1";try{let t=a.fork("",[],{cwd:n,env:u,execArgv:["-e",s]});if(void 0===t.pid)return void l(new Error(`Starting process to resolve node module  ${e} failed`));t.on("error",(e=>{l(e)})),t.on("message",(n=>{"r"===n.c&&(t.send({c:"e"}),n.s?c(n.r):l(new Error(`Failed to resolve module: ${e}`)))}));let i={c:"rs",a:e};t.send(i)}catch(e){l(e)}}))}function l(e){let t="npm";const n=Object.create(null);Object.keys(process.env).forEach((e=>n[e]=process.env[e])),n.NO_UPDATE_NOTIFIER="true";const i={encoding:"utf8",env:n};s()&&(t="npm.cmd",i.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let n=a.spawnSync(t,["config","get","prefix"],i).stdout;if(!n)return void(e&&e("'npm config get prefix' didn't return a value."));let c=n.trim();return e&&e(`'npm config get prefix' value is: ${c}`),c.length>0?s()?o.join(c,"node_modules"):o.join(c,"lib","node_modules"):void 0}catch(e){return}finally{process.removeListener("SIGPIPE",r)}}var d;t.uriToFilePath=function(e){let t=i.parse(e);if("file:"!==t.protocol||!t.path)return;let n=t.path.split("/");for(var r=0,a=n.length;r<a;r++)n[r]=decodeURIComponent(n[r]);if("win32"===process.platform&&n.length>1){let e=n[0],t=n[1];0===e.length&&t.length>1&&":"===t[1]&&n.shift()}return o.normalize(n.join("/"))},t.resolve=c,t.resolveGlobalNodePath=l,t.resolveGlobalYarnPath=function(e){let t="yarn",n={encoding:"utf8"};s()&&(t="yarn.cmd",n.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let r=a.spawnSync(t,["global","dir","--json"],n),s=r.stdout;if(!s)return void(e&&(e("'yarn global dir' didn't return a value."),r.stderr&&e(r.stderr)));let c=s.trim().split(/\r?\n/);for(let e of c)try{let t=JSON.parse(e);if("log"===t.type)return o.join(t.data,"node_modules")}catch(e){}return}catch(e){return}finally{process.removeListener("SIGPIPE",i)}},function(e){let t;function n(){return void 0!==t||(t=!("win32"===process.platform||r.existsSync(__filename.toUpperCase())&&r.existsSync(__filename.toLowerCase()))),t}e.isCaseSensitive=n,e.isParent=function(e,t){return n()?0===o.normalize(t).indexOf(o.normalize(e)):0===o.normalize(t).toLowerCase().indexOf(o.normalize(e).toLowerCase())}}(d=t.FileSystem||(t.FileSystem={})),t.resolveModulePath=function(e,t,n,i){return n?(o.isAbsolute(n)||(n=o.join(e,n)),c(t,n,n,i).then((e=>d.isParent(n,e)?e:Promise.reject(new Error(`Failed to load ${t} from node path location.`)))).then(void 0,(n=>c(t,l(i),e,i)))):c(t,l(i),e,i)}},2374:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const r=n(6960),a=n(6717),s=n(1507),c=n(4057);var l;o(n(4057),t),o(n(9936),t),(l=t.Files||(t.Files={})).uriToFilePath=s.uriToFilePath,l.resolveGlobalNodePath=s.resolveGlobalNodePath,l.resolveGlobalYarnPath=s.resolveGlobalYarnPath,l.resolve=s.resolve,l.resolveModulePath=s.resolveModulePath;let d,u=!1;!function(){const e="--clientProcessId";function t(e){try{let t=parseInt(e);isNaN(t)||(d=setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(u?0:1)}}),3e3))}catch(e){}}for(let n=2;n<process.argv.length;n++){let i=process.argv[n];if(i===e&&n+1<process.argv.length)return void t(process.argv[n+1]);{let n=i.split("=");n[0]===e&&t(n[1])}}}();const f={initialize:e=>{const t=e.processId;r.number(t)&&void 0===d&&setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(u?0:1)}}),3e3)},get shutdownReceived(){return u},set shutdownReceived(e){u=e},exit:e=>{process.exit(e)}};t.createConnection=function(e,t,n,i){let o,s,l,d;return void 0!==e&&"features"===e.__brand&&(o=e,e=t,t=n,n=i),c.ConnectionStrategy.is(e)||c.ConnectionOptions.is(e)?d=e:(s=e,l=t,d=n),function(e,t,n,i){if(!e&&!t&&process.argv.length>2){let n,i,r=process.argv.slice(2);for(let a=0;a<r.length;a++){let s=r[a];if("--node-ipc"===s){e=new c.IPCMessageReader(process),t=new c.IPCMessageWriter(process);break}if("--stdio"===s){e=process.stdin,t=process.stdout;break}if("--socket"===s){n=parseInt(r[a+1]);break}if("--pipe"===s){i=r[a+1];break}var o=s.split("=");if("--socket"===o[0]){n=parseInt(o[1]);break}if("--pipe"===o[0]){i=o[1];break}}if(n){let i=c.createServerSocketTransport(n);e=i[0],t=i[1]}else if(i){let n=c.createServerPipeTransport(i);e=n[0],t=n[1]}}var s="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+s);if(!t)throw new Error("Connection output stream is not set. "+s);if(r.func(e.read)&&r.func(e.on)){let t=e;t.on("end",(()=>{process.exit(u?0:1)})),t.on("close",(()=>{process.exit(u?0:1)}))}return a.createConnection((i=>c.createProtocolConnection(e,t,i,n)),f,i)}(s,l,d,o)}},433:(e,t,n)=>{e.exports=n(2374)},6630:(e,t,n)=>{var i;n.r(t),n.d(t,{URI:()=>o,Utils:()=>r}),i=(()=>{var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",o=0,r=-1,a=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(r===s-1||1===a);else if(r!==s-1&&2===a){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",o=0):o=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),r=s,a=0;continue}}else if(2===i.length||1===i.length){i="",o=0,r=s,a=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(r+1,s):i=e.slice(r+1,s),o=s-r-1;r=s,a=0}else 46===n&&-1!==a?++a:a=-1}return i}var i={resolve:function(){for(var e,i="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var a;r>=0?a=arguments[r]:(void 0===e&&(e=process.cwd()),a=e),t(a),0!==a.length&&(i=a+"/"+i,o=47===a.charCodeAt(0))}return i=n(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&o&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var o=arguments[n];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var r=e.length,a=r-o,s=1;s<n.length&&47===n.charCodeAt(s);++s);for(var c=n.length-s,l=a<c?a:c,d=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(47===n.charCodeAt(s+u))return n.slice(s+u+1);if(0===u)return n.slice(s+u)}else a>l&&(47===e.charCodeAt(o+u)?d=u:0===u&&(d=0));break}var f=e.charCodeAt(o+u);if(f!==n.charCodeAt(s+u))break;47===f&&(d=u)}var h="";for(u=o+d+1;u<=r;++u)u!==r&&47!==e.charCodeAt(u)||(0===h.length?h+="..":h+="/..");return h.length>0?h+n.slice(s+d):(s+=d,47===n.charCodeAt(s)&&++s,n.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,o=-1,r=!0,a=e.length-1;a>=1;--a)if(47===(n=e.charCodeAt(a))){if(!r){o=a;break}}else r=!1;return-1===o?i?"/":".":i&&1===o?"//":e.slice(0,o)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,o=0,r=-1,a=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var s=n.length-1,c=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!a){o=i+1;break}}else-1===c&&(a=!1,c=i+1),s>=0&&(l===n.charCodeAt(s)?-1==--s&&(r=i):(s=-1,r=c))}return o===r?r=c:-1===r&&(r=e.length),e.slice(o,r)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!a){o=i+1;break}}else-1===r&&(a=!1,r=i+1);return-1===r?"":e.slice(o,r)},extname:function(e){t(e);for(var n=-1,i=0,o=-1,r=!0,a=0,s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(47!==c)-1===o&&(r=!1,o=s+1),46===c?-1===n?n=s:1!==a&&(a=1):-1!==n&&(a=-1);else if(!r){i=s+1;break}}return-1===n||-1===o||0===a||1===a&&n===o-1&&n===i+1?"":e.slice(n,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,o=e.charCodeAt(0),r=47===o;r?(n.root="/",i=1):i=0;for(var a=-1,s=0,c=-1,l=!0,d=e.length-1,u=0;d>=i;--d)if(47!==(o=e.charCodeAt(d)))-1===c&&(l=!1,c=d+1),46===o?-1===a?a=d:1!==u&&(u=1):-1!==a&&(u=-1);else if(!l){s=d+1;break}return-1===a||-1===c||0===u||1===u&&a===c-1&&a===s+1?-1!==c&&(n.base=n.name=0===s&&r?e.slice(1,c):e.slice(s,c)):(0===s&&r?(n.name=e.slice(1,a),n.base=e.slice(1,c)):(n.name=e.slice(s,a),n.base=e.slice(s,c)),n.ext=e.slice(a,c)),s>0?n.dir=e.slice(0,s-1):r&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},447:(e,t,n)=>{var i;if(n.r(t),n.d(t,{URI:()=>p,Utils:()=>C}),"object"==typeof process)i="win32"===process.platform;else if("object"==typeof navigator){var o=navigator.userAgent;i=o.indexOf("Windows")>=0}var r,a,s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=/^\w[\w\d+.-]*$/,l=/^\//,d=/^\/\//,u="",f="/",h=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,p=function(){function e(e,t,n,i,o,r){void 0===r&&(r=!1),"object"==typeof e?(this.scheme=e.scheme||u,this.authority=e.authority||u,this.path=e.path||u,this.query=e.query||u,this.fragment=e.fragment||u):(this.scheme=function(e,t){return e||t?e:"file"}(e,r),this.authority=t||u,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==f&&(t=f+t):t=f}return t}(this.scheme,n||u),this.query=i||u,this.fragment=o||u,function(e,t){if(!e.scheme&&t)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'+e.authority+'", path: "'+e.path+'", query: "'+e.query+'", fragment: "'+e.fragment+'"}');if(e.scheme&&!c.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!l.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(d.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this,r))}return e.isUri=function(t){return t instanceof e||!!t&&"string"==typeof t.authority&&"string"==typeof t.fragment&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.scheme&&"function"==typeof t.fsPath&&"function"==typeof t.with&&"function"==typeof t.toString},Object.defineProperty(e.prototype,"fsPath",{get:function(){return v(this,!1)},enumerable:!1,configurable:!0}),e.prototype.with=function(e){if(!e)return this;var t=e.scheme,n=e.authority,i=e.path,o=e.query,r=e.fragment;return void 0===t?t=this.scheme:null===t&&(t=u),void 0===n?n=this.authority:null===n&&(n=u),void 0===i?i=this.path:null===i&&(i=u),void 0===o?o=this.query:null===o&&(o=u),void 0===r?r=this.fragment:null===r&&(r=u),t===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&r===this.fragment?this:new g(t,n,i,o,r)},e.parse=function(e,t){void 0===t&&(t=!1);var n=h.exec(e);return n?new g(n[2]||u,S(n[4]||u),S(n[5]||u),S(n[7]||u),S(n[9]||u),t):new g(u,u,u,u,u)},e.file=function(e){var t=u;if(i&&(e=e.replace(/\\/g,f)),e[0]===f&&e[1]===f){var n=e.indexOf(f,2);-1===n?(t=e.substring(2),e=f):(t=e.substring(2,n),e=e.substring(n)||f)}return new g("file",t,e,u,u)},e.from=function(e){return new g(e.scheme,e.authority,e.path,e.query,e.fragment)},e.prototype.toString=function(e){return void 0===e&&(e=!1),T(this,e)},e.prototype.toJSON=function(){return this},e.revive=function(t){if(t){if(t instanceof e)return t;var n=new g(t);return n._formatted=t.external,n._fsPath=t._sep===m?t.fsPath:null,n}return t},e}(),m=i?1:void 0,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._formatted=null,t._fsPath=null,t}return s(t,e),Object.defineProperty(t.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=v(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(e){return void 0===e&&(e=!1),e?T(this,!0):(this._formatted||(this._formatted=T(this,!1)),this._formatted)},t.prototype.toJSON=function(){var e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=m),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e},t}(p),y=((a={})[58]="%3A",a[47]="%2F",a[63]="%3F",a[35]="%23",a[91]="%5B",a[93]="%5D",a[64]="%40",a[33]="%21",a[36]="%24",a[38]="%26",a[39]="%27",a[40]="%28",a[41]="%29",a[42]="%2A",a[43]="%2B",a[44]="%2C",a[59]="%3B",a[61]="%3D",a[32]="%20",a);function b(e,t){for(var n=void 0,i=-1,o=0;o<e.length;o++){var r=e.charCodeAt(o);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||45===r||46===r||95===r||126===r||t&&47===r)-1!==i&&(n+=encodeURIComponent(e.substring(i,o)),i=-1),void 0!==n&&(n+=e.charAt(o));else{void 0===n&&(n=e.substr(0,o));var a=y[r];void 0!==a?(-1!==i&&(n+=encodeURIComponent(e.substring(i,o)),i=-1),n+=a):-1===i&&(i=o)}}return-1!==i&&(n+=encodeURIComponent(e.substring(i))),void 0!==n?n:e}function _(e){for(var t=void 0,n=0;n<e.length;n++){var i=e.charCodeAt(n);35===i||63===i?(void 0===t&&(t=e.substr(0,n)),t+=y[i]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function v(e,t){var n;return n=e.authority&&e.path.length>1&&"file"===e.scheme?"//"+e.authority+e.path:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,i&&(n=n.replace(/\//g,"\\")),n}function T(e,t){var n=t?_:b,i="",o=e.scheme,r=e.authority,a=e.path,s=e.query,c=e.fragment;if(o&&(i+=o,i+=":"),(r||"file"===o)&&(i+=f,i+=f),r){var l=r.indexOf("@");if(-1!==l){var d=r.substr(0,l);r=r.substr(l+1),-1===(l=d.indexOf(":"))?i+=n(d,!1):(i+=n(d.substr(0,l),!1),i+=":",i+=n(d.substr(l+1),!1)),i+="@"}-1===(l=(r=r.toLowerCase()).indexOf(":"))?i+=n(r,!1):(i+=n(r.substr(0,l),!1),i+=r.substr(l))}if(a){if(a.length>=3&&47===a.charCodeAt(0)&&58===a.charCodeAt(2))(u=a.charCodeAt(1))>=65&&u<=90&&(a="/"+String.fromCharCode(u+32)+":"+a.substr(3));else if(a.length>=2&&58===a.charCodeAt(1)){var u;(u=a.charCodeAt(0))>=65&&u<=90&&(a=String.fromCharCode(u+32)+":"+a.substr(2))}i+=n(a,!0)}return s&&(i+="?",i+=n(s,!1)),c&&(i+="#",i+=t?c:b(c,!1)),i}function R(e){try{return decodeURIComponent(e)}catch(t){return e.length>3?e.substr(0,3)+R(e.substr(3)):e}}var k=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function S(e){return e.match(k)?e.replace(k,(function(e){return R(e)})):e}var C,w=n(470),x=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},E=w.posix||w;!function(e){e.joinPath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.with({path:E.join.apply(E,x([e.path],t))})},e.resolvePath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=e.path||"/";return e.with({path:E.resolve.apply(E,x([i],t))})},e.dirname=function(e){var t=E.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)?e:e.with({path:t})},e.basename=function(e){return E.basename(e.path)},e.extname=function(e){return E.extname(e.path)}}(C||(C={}))}},t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(447)})();const{URI:o,Utils:r}=i},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},1808:e=>{e.exports=require("net")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},7282:e=>{e.exports=require("process")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0});const t=n(7147),o=n(6630),r=n(1017),a=n(6288),s=n(433),c=n(3939),l=n(701);let d,u=new s.TextDocuments(a.TextDocument),f=!1,h=!1,p=!1,m=!1,g=0;async function y(e){let t,n=e.uri;(t=c.lexers[n=n.toLowerCase()])&&(t.initlibdirs(),t.diagnostics.length&&t.parseScript()),R(n),c.libfuncs[n]&&(c.libfuncs[n].length=0,c.libfuncs[n].push(...Object.values(t.declaration).filter((e=>e.kind===s.SymbolKind.Class||e.kind===s.SymbolKind.Function))))}async function b(e=!1,n=!1){if(!e){let e=await d.workspace.getConfiguration("AutoHotkey2");if(!e&&process.env.AHK2_LS_CONFIG&&(e=JSON.parse(process.env.AHK2_LS_CONFIG)),e&&Object.assign(c.extsettings,e),!c.extsettings.InterpreterPath&&!c.ahkpath_cur)return!1;"string"==typeof c.extsettings.AutoLibInclude?c.extsettings.AutoLibInclude=c.LibIncludeType[c.extsettings.AutoLibInclude]:"boolean"==typeof c.extsettings.AutoLibInclude&&(c.extsettings.AutoLibInclude=c.extsettings.AutoLibInclude?3:0)}let i=(0,c.runscript)('\n\t#NoTrayIcon\n\t#Warn All, Off\n\ts := "", _H := false, Append := SubStr(A_AhkVersion, 1, 3) = "2.0" ? "FileAppend" : "FileAppend2"\n\tfor _, p in [A_MyDocuments,A_Desktop,A_AhkPath,A_ProgramFiles,A_Programs,A_AhkVersion]\n\t\ts .= p "|"\n\ttry _H := !!A_ThreadID\n\t%Append%(s _H "`n", "*", "UTF-8")\n\tFileAppend2(text, file) {\n\t\tencode := "UTF-8"\n\t\tFileAppend %text%, %file%, %encode%\n\t}\n\t',(e=>{var o,r;if(!(e=e.trim()))return d.window.showErrorMessage(c.setting.getenverr()),void(i=!1);let a=e.split("|"),s=["mydocuments","desktop","ahkpath","programfiles","programs","version","h"],l="";for(let e in a)c.pathenv[s[e]]=a[e].toLowerCase();if(g=1,(null===(o=c.pathenv.version)||void 0===o?void 0:o.match(/^1\./))&&d.window.showErrorMessage(c.setting.versionerr()),n||(c.libdirs.length=0,(0,t.existsSync)(l=c.pathenv.mydocuments+"\\autohotkey\\lib")&&c.libdirs.push(l.toLowerCase()),(0,t.existsSync)(l=(c.ahkpath_cur||c.pathenv.ahkpath).replace(/[^\\/]+$/,"lib"))&&c.libdirs.push(l.toLowerCase())),c.pathenv.h=(null!==(r=c.pathenv.h)&&void 0!==r?r:"0").slice(0,1),"1"===c.pathenv.h?(c.isahk2_h||((0,c.set_ahk_h)(!0),n=!1),f||(f=!0,(0,c.loadahk2)("ahk2_h"))):(c.isahk2_h&&((0,c.set_ahk_h)(!1),n=!1),f&&(f=!1,(0,c.initahk2cache)(),(0,c.loadahk2)())),!n){for(const e in c.lexers){let t=c.lexers[e];t.d||(t.initlibdirs(),(Object.keys(t.include).length||t.diagnostics.length)&&(t.parseScript(),(0,c.parseinclude)(t.include),t.relevance=(0,c.getincludetable)(t.uri).list))}(0,c.sendDiagnostics)(),(0,c.clearLibfuns)(),c.extsettings.AutoLibInclude>1&&_()}}));if(i){if(!c.pathenv.ahkpath)return g<3&&setTimeout((()=>{g++,b(!0)}),1e3),!1}else d.window.showErrorMessage(c.setting.ahkpatherr());return i}async function _(){for(let e of c.libdirs)for(let t of(0,c.getallahkfiles)(e)){let e,n,i=o.URI.file(t).toString().toLowerCase();if(!c.libfuncs[i]){if(!(e=c.lexers[i])){if(!(n=(0,c.openFile)(t)))continue;e=new c.Lexer(n),e.parseScript()}c.libfuncs[i]=Object.values(e.declaration).filter((e=>e.kind===s.SymbolKind.Class||e.kind===s.SymbolKind.Function)),Object.defineProperty(c.libfuncs[i],"islib",{value:v(t,...c.libdirs),enumerable:!1}),await(0,c.sleep)(50)}}}function v(e,...t){let n=(0,r.basename)(e),i=0,o=n.endsWith(".ahk");for(const r of t){if(e.startsWith(r+"\\")){if(o)for(let e=i-1;e>=0;e--)if(c.libfuncs[t[e]+"\\"+n])return!1;return!0}i++}return!1}async function T(e,t){let n=(0,r.resolve)(e,"..").toLowerCase()===(0,r.resolve)(t,"..").toLowerCase();if(!n){let t=o.URI.file((0,r.resolve)(e,"../lib")).toString().toLowerCase();for(const e in c.libfuncs)e.startsWith(t)&&delete c.libfuncs[e]}await b(!0,n)&&u.all().forEach(y)}async function R(e){let t=c.lexers[e];c.libfuncs[e]||(c.libfuncs[e]=[],Object.defineProperty(c.libfuncs[e],"islib",{value:v(o.URI.parse(e).toString(),...c.libdirs),enumerable:!1})),setTimeout((async()=>{let n="",i=!1;(n=(0,c.inWorkspaceFolders)(t.document.uri))?(n=o.URI.parse(n).fsPath,i=!0):n=t.scriptdir+"\\lib";for(let t of(0,c.getallahkfiles)(n)){let n,r,a=o.URI.file(t).toString().toLowerCase();if(a!==e&&!c.libfuncs[a]){if(c.libfuncs[a]=[],Object.defineProperty(c.libfuncs[a],"islib",{value:v(t,...c.libdirs),enumerable:!1}),!(n=c.lexers[a])){if(!(r=(0,c.openFile)(t)))continue;n=new c.Lexer(r),n.parseScript(),i&&(c.lexers[a]=n)}c.libfuncs[a].push(...Object.values(n.declaration).filter((e=>e.kind===s.SymbolKind.Class||e.kind===s.SymbolKind.Function))),await(0,c.sleep)(50)}}}),500)}function k(e,t=!1){var n;let i={};for(let o of e){let e=(0,l.searchAndOpenPEFile)(o);if(e&&(null===(n=e.getExport())||void 0===n||n.Functions.map((e=>i[e.Name]=!0)),t))break}return delete i[""],Object.keys(i)}d=(0,s.createConnection)(s.ProposedFeatures.all),(0,c.set_Connection)(d,!1,k),(0,c.set_dirname)(__dirname),(0,c.set_locale)(JSON.parse(process.env.VSCODE_NLS_CONFIG||process.env.AHK2_LS_CONFIG||"{}").locale),d.onInitialize((e=>{var t;let n=e.capabilities;e.locale&&(0,c.set_locale)(e.locale),(0,c.set_Workfolder)(null===(t=e.workspaceFolders)||void 0===t?void 0:t.map((e=>e.uri.toLowerCase()+"/"))),h=!(!n.workspace||!n.workspace.configuration),p=!(!n.workspace||!n.workspace.workspaceFolders),m=!!(n.textDocument&&n.textDocument.publishDiagnostics&&n.textDocument.publishDiagnostics.relatedInformation);const i={serverInfo:{name:"ahk2-language-server"},capabilities:{textDocumentSync:{openClose:!0,change:s.TextDocumentSyncKind.Incremental},completionProvider:{resolveProvider:!1,triggerCharacters:[".","#"]},signatureHelpProvider:{triggerCharacters:["(",","]},documentSymbolProvider:!0,definitionProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:"}",moreTriggerCharacter:["{"]},executeCommandProvider:{commands:["ahk2.fix.include","ahk2.generate.comment","ahk2.generate.author","ahk2.resetinterpreterpath"]},hoverProvider:!0,foldingRangeProvider:!0,colorProvider:!0,codeActionProvider:!0,renameProvider:{prepareProvider:!0},referencesProvider:{workDoneProgress:!0},semanticTokensProvider:{legend:{tokenTypes:["class","function","method","parameter","variable","property","keyword","string","number","event","modifier"],tokenModifiers:["definition","readonly","static","deprecated","modification","documentation","defaultLibrary"]},full:{delta:!0},range:!0},workspaceSymbolProvider:!0}};return p&&(i.capabilities.workspace={workspaceFolders:{supported:!0}}),i})),d.onInitialized((async()=>{h&&d.client.register(s.DidChangeConfigurationNotification.type,void 0),p&&d.workspace.onDidChangeWorkspaceFolders((e=>{let t=e.removed.map((e=>e.uri.toLowerCase()+"/"))||[];(0,c.set_Workfolder)(c.workspaceFolders.filter((e=>!t.includes(e)))),e.added.map((e=>c.workspaceFolders.push(e.uri.toLowerCase()+"/"))),(0,c.parseWorkspaceFolders)()})),c.winapis.push(...k(["user32","kernel32","comctl32","gdi32"].map((e=>`C:\\Windows\\System32\\${e}.dll`)))),await b(),(0,c.parseWorkspaceFolders)()})),d.onDidChangeConfiguration((async e=>{if(h){let e=await d.workspace.getConfiguration("AutoHotkey2");if(!e)return void d.window.showWarningMessage("Failed to obtain the configuration");let t={InterpreterPath:!1,AutoLibInclude:!1},n=c.extsettings.InterpreterPath;"string"==typeof e.AutoLibInclude?e.AutoLibInclude=c.LibIncludeType[e.AutoLibInclude]:"boolean"==typeof e.AutoLibInclude&&(e.AutoLibInclude=e.AutoLibInclude?3:0);for(let n in c.extsettings)c.extsettings[n]!==e[n]&&(t[n]=!0);Object.assign(c.extsettings,e),t.InterpreterPath&&!c.ahkpath_cur?T(n,c.extsettings.InterpreterPath):t.AutoLibInclude&&(c.extsettings.AutoLibInclude>1&&_(),1&c.extsettings.AutoLibInclude&&u.all().forEach((async e=>R(e.uri.toLowerCase()))))}})),u.onDidOpen((async e=>{var t;let n=e.document.uri.toLowerCase(),i=new c.Lexer(e.document),o=null===(t=c.lexers[n])||void 0===t?void 0:t.d;c.lexers[n]=i,i.actived=!0,i.d=null!=o?o:i.d,1&c.extsettings.AutoLibInclude&&R(n)})),u.onDidClose((async e=>{let t=e.document.uri.toLowerCase();if(!c.lexers[t]||c.lexers[t].d&&!t.includes("?"))return;c.lexers[t].actived=!1;for(let e in c.lexers)if(c.lexers[e].actived)for(let n in c.lexers[e].relevance)if(n===t)return;d.sendDiagnostics({uri:c.lexers[t].document.uri,diagnostics:[]}),delete c.lexers[t];let n=[];for(let e in c.lexers)if(!c.lexers[e].actived&&(!c.lexers[e].d||e.includes("?"))){let t=!0;for(let n in c.lexers[e].relevance)if(c.lexers[n]&&c.lexers[n].actived){t=!1;break}t&&n.push(e)}for(let e of n)d.sendDiagnostics({uri:c.lexers[e].document.uri,diagnostics:[]}),delete c.lexers[e]})),u.onDidChangeContent((async e=>{var t;let n=e.document.uri.toLowerCase(),i=c.lexers[n],o=i.include,r=!1;i.isparsed=!1,i.parseScript(),c.libfuncs[n]&&(c.libfuncs[n].length=0,c.libfuncs[n].push(...Object.values(i.declaration).filter((e=>e.kind===s.SymbolKind.Class||e.kind===s.SymbolKind.Function))));for(const e in i.include)o[e]||(o[e]=i.include[e],r=!0);if(!r&&Object.keys(o).length===Object.keys(i.include).length)return i.relevance||(i.relevance=(0,c.getincludetable)(n).list),void(0,c.sendDiagnostics)();(0,c.parseinclude)(i.include),i.relevance=(0,c.getincludetable)(n).list,function(){for(const e in o)c.lexers[e]&&(c.lexers[e].relevance=(0,c.getincludetable)(e).list)}();for(const e in o)!i.include[e]&&(null===(t=c.lexers[e])||void 0===t?void 0:t.diagnostics.length)&&c.lexers[e].parseScript();(0,c.sendDiagnostics)()})),d.onDidChangeWatchedFiles((e=>{})),d.onCodeAction(c.codeActionProvider),d.onCompletion(c.completionProvider),d.onColorPresentation(c.colorPresentation),d.onDocumentColor(c.colorProvider),d.onDefinition(c.defintionProvider),d.onDocumentFormatting(c.documentFormatting),d.onDocumentRangeFormatting(c.rangeFormatting),d.onDocumentOnTypeFormatting(c.typeFormatting),d.onDocumentSymbol(c.symbolProvider),d.onFoldingRanges((async e=>c.lexers[e.textDocument.uri.toLowerCase()].foldingranges)),d.onHover(c.hoverProvider),d.onPrepareRename(c.prepareRename),d.onReferences(c.referenceProvider),d.onRenameRequest(c.renameProvider),d.onSignatureHelp(c.signatureProvider),d.onExecuteCommand((async function(e){let t=e.arguments||[];switch(e.command){case"ahk2.fix.include":(0,c.fixinclude)(t[0],t[1]);break;case"ahk2.generate.comment":(0,c.generateComment)(t);break;case"ahk2.generate.author":(0,c.generateAuthor)();break;case"ahk2.resetinterpreterpath":!async function(e){let t=c.ahkpath_cur||c.extsettings.InterpreterPath;e.toLowerCase()!==t.toLowerCase()&&((0,c.set_ahkpath)(e),T(t,e||c.extsettings.InterpreterPath))}(t[0])}})),d.onWorkspaceSymbol(c.workspaceSymbolProvider),d.languages.semanticTokens.on(c.semanticTokensOnFull),d.languages.semanticTokens.onDelta(c.semanticTokensOnDelta),d.languages.semanticTokens.onRange(c.semanticTokensOnRange),d.onRequest("ahk2.getAHKversion",(function(e){return e.map((e=>{var t,n;try{let i=new l.PEFile(e).getResource(l.RESOURCE_TYPE.VERSION)[0].StringTable[0];if(null===(t=i.ProductName)||void 0===t?void 0:t.toLowerCase().startsWith("autohotkey"))return i.ProductName+" "+(i.ProductVersion||"")+((null===(n=i.FileDescription)||void 0===n?void 0:n.replace(/^.*?(\d+-bit).*$/i," $1"))||"")}catch(e){}return""}))})),d.onRequest("ahk2.getVersionInfo",(e=>{let t=c.lexers[e.toLowerCase()];if(t){let n=t.get_tokon(0);if(("TK_BLOCK_COMMENT"===n.type||""===n.type)&&n.content.match(/^\s*[;*]?\s*@(date|version)\b/im))return{uri:e,content:n.content,range:{start:t.document.positionAt(n.offset),end:t.document.positionAt(n.offset+n.length)}}}return null})),u.listen(d),d.listen(),(0,c.loadlocalize)(),(0,c.initahk2cache)(),(0,c.loadahk2)()})();var o=exports;for(var r in i)o[r]=i[r];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();